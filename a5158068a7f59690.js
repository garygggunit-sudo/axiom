;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="30f2bc1e-5180-b4fc-83c8-b6233eb929a3")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,649347,(e,t,r)=>{!function(i,n){"use strict";var o={encode:function(e){var t,r=new ArrayBuffer(256),i=new DataView(r),n=0;function o(e){for(var o=r.byteLength,s=n+e;o<s;)o*=2;if(o!==r.byteLength){var a=i;i=new DataView(r=new ArrayBuffer(o));for(var l=n+3>>2,u=0;u<l;++u)i.setUint32(4*u,a.getUint32(4*u))}return t=e,i}function s(e){o(1).setUint8(n,e),n+=t}function a(e){for(var r=o(e.length),i=0;i<e.length;++i)r.setUint8(n+i,e[i]);n+=t}function l(e,r){var i,a;r<24?s(e<<5|r):r<256?(s(e<<5|24),s(r)):(r<65536?(s(e<<5|25),o(2).setUint16(n,r)):r<0x100000000?(s(e<<5|26),o(4).setUint32(n,r)):(s(e<<5|27),i=r%0x100000000,(a=o(8)).setUint32(n,(r-i)/0x100000000),a.setUint32(n+4,i)),n+=t)}if(!function e(r){if(!1===r)return s(244);if(!0===r)return s(245);if(null===r)return s(246);if(void 0===r)return s(247);switch(typeof r){case"number":if(Math.floor(r)===r){if(0<=r&&r<=0x20000000000000)return l(0,r);if(-0x20000000000000<=r&&r<0)return l(1,-(r+1))}return s(251),void(o(8).setFloat64(n,r),n+=t);case"string":var i,u,c=[];for(i=0;i<r.length;++i){var f=r.charCodeAt(i);f<128?c.push(f):(f<2048?c.push(192|f>>6):(f<55296?c.push(224|f>>12):(f=((1023&f)<<10|1023&r.charCodeAt(++i))+65536,c.push(240|f>>18),c.push(128|f>>12&63)),c.push(128|f>>6&63)),c.push(128|63&f))}return l(3,c.length),a(c);default:if(Array.isArray(r))for(l(4,u=r.length),i=0;i<u;++i)e(r[i]);else if(r instanceof Uint8Array)l(2,r.length),a(r);else{var h=Object.keys(r);for(l(5,u=h.length),i=0;i<u;++i){var p=h[i];e(p),e(r[p])}}}}(e),"slice"in r)return r.slice(0,n);for(var u=new ArrayBuffer(n),c=new DataView(u),f=0;f<n;++f)c.setUint8(f,i.getUint8(f));return u},decode:function(e,t,r){var i=new DataView(e),n=0;function o(t){var r;return r=new Uint8Array(e,n,t),n+=t,r}function s(){var e;return e=i.getUint8(n),n+=1,e}function a(){var e;return e=i.getUint16(n),n+=2,e}function l(){var e;return e=i.getUint32(n),n+=4,e}function u(){return 255===i.getUint8(n)&&(n+=1,!0)}function c(e){if(e<24)return e;if(24===e)return s();if(25===e)return a();if(26===e)return l();if(27===e)return 0x100000000*l()+l();if(31===e)return -1;throw"Invalid length encoding"}function f(e){var t=s();if(255===t)return -1;var r=c(31&t);if(r<0||t>>5!==e)throw"Invalid indefinite length element";return r}function h(e,t){for(var r=0;r<t;++r){var i=s();128&i&&(i<224?(i=(31&i)<<6|63&s(),t-=1):i<240?(i=(15&i)<<12|(63&s())<<6|63&s(),t-=2):(i=(15&i)<<18|(63&s())<<12|(63&s())<<6|63&s(),t-=3)),i<65536?e.push(i):(i-=65536,e.push(55296|i>>10),e.push(56320|1023&i))}}"function"!=typeof t&&(t=function(e){return e}),"function"!=typeof r&&(r=function(){});var p=function e(){var l,p,d,y,g,v=s(),m=v>>5,b=31&v;if(7===m)switch(b){case 25:var w=new DataView(new ArrayBuffer(4)),A=a(),S=31744&A,B=1023&A;if(31744===S)S=261120;else if(0!==S)S+=114688;else if(0!==B)return 5960464477539063e-23*B;return w.setUint32(0,(32768&A)<<16|S<<13|B<<13),w.getFloat32(0);case 26:return l=i.getFloat32(n),n+=4,l;case 27:return p=i.getFloat64(n),n+=8,p}if((y=c(b))<0&&(m<2||6<m))throw"Invalid length";switch(m){case 0:return y;case 1:return -1-y;case 2:if(y<0){for(var x=[],E=0;(y=f(m))>=0;)E+=y,x.push(o(y));var k=new Uint8Array(E),C=0;for(d=0;d<x.length;++d)k.set(x[d],C),C+=x[d].length;return k}return o(y);case 3:var O=[];if(y<0)for(;(y=f(m))>=0;)h(O,y);else h(O,y);return String.fromCharCode.apply(null,O);case 4:if(y<0)for(g=[];!u();)g.push(e());else for(d=0,g=Array(y);d<y;++d)g[d]=e();return g;case 5:var I={};for(d=0;d<y||y<0&&!u();++d)I[e()]=e();return I;case 6:return t(e(),y);case 7:switch(y){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return r(y)}}}();if(n!==e.byteLength)throw"Remaining bytes";return p}};"function"==typeof define&&define.amd?((i,n="function"!=typeof i?i:i(e.r,r,t))=>void 0!==n&&e.v(n))(o):t.exports?t.exports=o:i.CBOR||(i.CBOR=o)}(e.e)},964495,(e,t,r)=>{var i,n;n=i||(i={}),function(t){var r="object"==typeof globalThis?globalThis:e.g,i=o(n);function o(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==r.Reflect&&(i=o(r.Reflect,i)),t(i,r),void 0===r.Reflect&&(r.Reflect=n)}(function(e,t){var r,i=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,l=({__proto__:[]})instanceof Array,u=!a&&!l,c={create:a?function(){return D(Object.create(null))}:l?function(){return D({__proto__:null})}:function(){return D({})},has:u?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},f=Object.getPrototypeOf(Function),h="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function i(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(i.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),i.prototype.has=function(e){return this._find(e,!1)>=0},i.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},i.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},i.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,N(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},i.prototype.keys=function(){return new r(this._keys,this._values,n)},i.prototype.values=function(){return new r(this._keys,this._values,o)},i.prototype.entries=function(){return new r(this._keys,this._values,a)},i.prototype["@@iterator"]=function(){return this.entries()},i.prototype[s]=function(){return this.entries()},i.prototype._find=function(e,t){if(!N(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(N(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},i;function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}(),p="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}(),d="function"==typeof WeakMap?WeakMap:function(){var e=c.create(),t=n();function r(){this._key=n()}return r.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},r.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},r.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},r.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},r.prototype.clear=function(){this._key=n()},r;function n(){var t;do t="@@WeakMap@@"+function(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(16);return"u">typeof crypto?crypto.getRandomValues(t):"u">typeof msCrypto?msCrypto.getRandomValues(t):s(t,16),t}return s(Array(16),16)}(0);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var i=e[r];(4===r||6===r||8===r)&&(t+="-"),i<16&&(t+="0"),t+=i.toString(16).toLowerCase()}return t}();while(c.has(e,t))return e[t]=!0,t}function o(e,r){if(!i.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:c.create()})}return e[t]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}}(),y=n?Symbol.for("@reflect-metadata:registry"):void 0,g=(!B(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&(r=t.Reflect[y]),B(r)&&(r=function(){B(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(r=(e=t.Reflect).defineMetadata,i=e.hasOwnMetadata,n=e.getOwnMetadata,o=e.getOwnMetadataKeys,s=e.deleteMetadata,a=new d,l={isProviderFor:function(e,t){var r=a.get(e);return!!(!B(r)&&r.has(t))||!!o(e,t).length&&(B(r)&&(r=new p,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:s});var e,r,i,n,o,s,a,l,u,c,f,g=new d,v={registerProvider:function(e){if(!Object.isExtensible(v))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===e:break;case B(u):u=e;break;case u===e:break;case B(c):c=e;break;case c===e:break;default:void 0===f&&(f=new p),f.add(e)}},getProvider:m,setProvider:function(e,t,r){if(!function(e){if(B(e))throw TypeError();return u===e||c===e||!B(f)&&f.has(e)}(r))throw Error("Metadata provider not registered.");var i=m(e,t);if(i!==r){if(!B(i))return!1;var n=g.get(e);B(n)&&(n=new h,g.set(e,n)),n.set(t,r)}return!0}};return v;function m(e,t){var r,i=g.get(e);return B(i)||(r=i.get(t)),B(r)&&(r=function(e,t){if(!B(u)){if(u.isProviderFor(e,t))return u;if(!B(c)){if(c.isProviderFor(e,t))return u;if(!B(f))for(var r=U(f);;){var i=j(r);if(!i)return;var n=i.value;if(n.isProviderFor(e,t))return P(r),n}}}if(!B(l)&&l.isProviderFor(e,t))return l}(e,t),B(r)||(B(i)&&(i=new h,g.set(e,i)),i.set(t,r))),r}}()),!B(y)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),v=function(e){var t=new d,r={isProviderFor:function(e,r){var i=t.get(e);return!B(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,n){i(r,n,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var n=i(t,r,!1);return!B(n)&&!!n.has(e)},OrdinaryGetOwnMetadata:function(e,t,r){var n=i(t,r,!1);if(!B(n))return n.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],n=i(e,t,!1);if(B(n))return r;for(var o=U(n.keys()),s=0;;){var a=j(o);if(!a)return r.length=s,r;var l=a.value;try{r[s]=l}catch(e){try{P(o)}finally{throw e}}s++}},OrdinaryDeleteMetadata:function(e,r,n){var o=i(r,n,!1);if(B(o)||!o.delete(e))return!1;if(0===o.size){var s=t.get(r);B(s)||(s.delete(n),0===s.size&&t.delete(s))}return!0}};return g.registerProvider(r),r;function i(i,n,o){var s=t.get(i),a=!1;if(B(s)){if(!o)return;s=new h,t.set(i,s),a=!0}var l=s.get(n);if(B(l)){if(!o)return;if(l=new h,s.set(n,l),!e.setProvider(i,n,r))throw s.delete(n),a&&t.delete(i),Error("Wrong provider for target.")}return l}}(g);function m(e,t,r){var i=H(t,r,!1);return!B(i)&&!!i.OrdinaryHasOwnMetadata(e,t,r)}function b(e,t,r){var i=H(t,r,!1);if(!B(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function w(e,t,r,i){H(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function A(e,t){var r=H(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function S(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function B(e){return void 0===e}function x(e){return null===e}function E(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,r,i){if(B(r)){if(!C(e)||!I(t))throw TypeError();for(var n=e,o=t,s=n.length-1;s>=0;--s){var a=(0,n[s])(o);if(!B(a)&&!x(a)){if(!I(a))throw TypeError();o=a}}return o}if(!C(e)||!E(t)||!E(i)&&!B(i)&&!x(i))throw TypeError();return x(i)&&(i=void 0),function(e,t,r,i){for(var n=e.length-1;n>=0;--n){var o=(0,e[n])(t,r,i);if(!B(o)&&!x(o)){if(!E(o))throw TypeError();i=o}}return i}(e,t,r=k(r),i)}),e("metadata",function(e,t){return function(r,i){if(!E(r)||!B(i)&&!function(e){switch(S(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();w(e,t,r,i)}}),e("defineMetadata",function(e,t,r,i){if(!E(r))throw TypeError();return B(i)||(i=k(i)),w(e,t,r,i)}),e("hasMetadata",function(e,t,r){if(!E(t))throw TypeError();return B(r)||(r=k(r)),function e(t,r,i){if(m(t,r,i))return!0;var n=R(r);return!x(n)&&e(t,n,i)}(e,t,r)}),e("hasOwnMetadata",function(e,t,r){if(!E(t))throw TypeError();return B(r)||(r=k(r)),m(e,t,r)}),e("getMetadata",function(e,t,r){if(!E(t))throw TypeError();return B(r)||(r=k(r)),function e(t,r,i){if(m(t,r,i))return b(t,r,i);var n=R(r);if(!x(n))return e(t,n,i)}(e,t,r)}),e("getOwnMetadata",function(e,t,r){if(!E(t))throw TypeError();return B(r)||(r=k(r)),b(e,t,r)}),e("getMetadataKeys",function(e,t){if(!E(e))throw TypeError();return B(t)||(t=k(t)),function e(t,r){var i=A(t,r),n=R(t);if(null===n)return i;var o=e(n,r);if(o.length<=0)return i;if(i.length<=0)return o;for(var s=new p,a=[],l=0;l<i.length;l++){var u=i[l],c=s.has(u);c||(s.add(u),a.push(u))}for(var f=0;f<o.length;f++){var u=o[f],c=s.has(u);c||(s.add(u),a.push(u))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!E(e))throw TypeError();return B(t)||(t=k(t)),A(e,t)}),e("deleteMetadata",function(e,t,r){if(!E(t)||(B(r)||(r=k(r)),!E(t)))throw TypeError();B(r)||(r=k(r));var i=H(t,r,!1);return!B(i)&&i.OrdinaryDeleteMetadata(e,t,r)});function k(e){var t=function(e,t){switch(S(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r="string",i=T(e,o);if(void 0!==i){var n=i.call(e,r);if(E(n))throw TypeError();return n}return function(e,t){if("string"===t){var r=e.toString;if(O(r)){var i=r.call(e);if(!E(i))return i}var n=e.valueOf;if(O(n)){var i=n.call(e);if(!E(i))return i}}else{var n=e.valueOf;if(O(n)){var i=n.call(e);if(!E(i))return i}var o=e.toString;if(O(o)){var i=o.call(e);if(!E(i))return i}}throw TypeError()}(e,r)}(e,0);return"symbol"==typeof t?t:""+t}function C(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function O(e){return"function"==typeof e}function I(e){return"function"==typeof e}function N(e,t){return e===t||e!=e&&t!=t}function T(e,t){var r=e[t];if(null!=r){if(!O(r))throw TypeError();return r}}function U(e){var t=T(e,s);if(!O(t))throw TypeError();var r=t.call(e);if(!E(r))throw TypeError();return r}function j(e){var t=e.next();return!t.done&&t}function P(e){var t=e.return;t&&t.call(e)}function R(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===f||t!==f)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function H(e,t,r){var i=g.getProvider(e,t);if(!B(i))return i;if(r){if(g.setProvider(e,t,v))return v;throw Error("Illegal state.")}}function D(e){return e.__=void 0,delete e.__,e}})},630376,(e,t,r)=>{"use strict";var i=e.i(467034);class n{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=n.toUint8Array(e),i=n.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),n=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let o="string",s=/^[0-9a-f\s]+$/i,a=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,l=/^[a-zA-Z0-9-_]+$/;class u{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=n.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class c{static toString(e,t=!1){let r=n.toArrayBuffer(e),i=new DataView(r),o="";for(let e=0;e<r.byteLength;e+=2)o+=String.fromCharCode(i.getUint16(e,t));return o}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class f{static isHex(e){return typeof e===o&&s.test(e)}static isBase64(e){return typeof e===o&&a.test(e)}static isBase64Url(e){return typeof e===o&&l.test(e)}static ToString(e,t="utf8"){let r=n.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return c.toString(r,!0);case"utf16":case"utf16be":return c.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return c.fromString(e,!0);case"utf16":case"utf16be":return c.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=n.toUint8Array(e);return"u">typeof btoa?btoa(this.ToString(t,"binary")):i.Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"u">typeof atob?this.FromBinary(atob(t)):new Uint8Array(i.Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=f.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return u.fromString(e);case"utf16":case"utf16be":return c.fromString(e);case"utf16le":case"usc2":return c.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=f.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return u.toString(e);case"utf16":case"utf16be":return c.toString(e);case"utf16le":case"usc2":return c.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=n.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=n.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!f.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return c.toString(e,t)}static FromUtf16String(e,t=!1){return c.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}f.DEFAULT_UTF8_ENCODING="utf8",r.BufferSourceConverter=n,r.Convert=f,r.assign=function(e){let t=arguments[0];for(let e=1;e<arguments.length;e++){let r=arguments[e];for(let e in r)t[e]=r[e]}return t},r.combine=function(...e){let t=new Uint8Array(e.map(e=>e.byteLength).reduce((e,t)=>e+t)),r=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let i of e)t[r++]=i}),t.buffer},r.isEqual=function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}},284795,356026,784503,64043,e=>{"use strict";var t,r,i,n,o,s,a,l,u,c,f,h,p,d,y,g,v,m,b,w,A,S,B,x,E,k,C,O,I,N,T,U,j,P,R,H,D,_,V,L,M,F,$,z,q,K,W,G,Z,J,Y,Q,X,ee,et,er,ei,en,eo,es,ea,el,eu,ec,ef,eh,ep,ed,ey,eg,ev,em,eb,ew,eA,eS,eB,ex,eE=e.i(44314),ek=e.i(140965),eC=e.i(470525);let eO=BigInt(0),eI=BigInt(1);function eN(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function eT(e){if(!eN(e))throw Error("Uint8Array expected")}function eU(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function ej(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function eP(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?eO:BigInt("0x"+e)}let eR="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,eH=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function eD(e){if(eT(e),eR)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=eH[e[r]];return t}function e_(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function eV(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(eR)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=e_(e.charCodeAt(n)),o=e_(e.charCodeAt(n+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+o}return i}function eL(e){return eP(eD(e))}function eM(e){return eT(e),eP(eD(Uint8Array.from(e).reverse()))}function eF(e,t){return eV(e.toString(16).padStart(2*t,"0"))}function e$(e,t){return eF(e,t).reverse()}function ez(e,t,r){let i;if("string"==typeof t)try{i=eV(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(eN(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}function eq(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];eT(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}function eK(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}let eW=e=>"bigint"==typeof e&&eO<=e;function eG(e,t,r){return eW(e)&&eW(t)&&eW(r)&&t<=e&&e<r}function eZ(e,t,r,i){if(!eG(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let eJ=e=>(eI<<BigInt(e))-eI,eY=e=>new Uint8Array(e),eQ={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||eN(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function eX(e,t,r={}){let i=(t,r,i)=>{let n=eQ[r];if("function"!=typeof n)throw Error("invalid validator function");let o=e[t];if((!i||void 0!==o)&&!n(o,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+o)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function e0(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let o=e(r,...i);return t.set(r,o),o}}let e1=BigInt(0),e2=BigInt(1),e8=BigInt(2),e3=BigInt(3),e5=BigInt(4),e6=BigInt(5),e4=BigInt(8);function e9(e,t){let r=e%t;return r>=e1?r:t+r}function e7(e,t,r){let i=e;for(;t-- >e1;)i*=i,i%=r;return i}function te(e,t){if(e===e1)throw Error("invert: expected non-zero number");if(t<=e1)throw Error("invert: expected positive modulus, got "+t);let r=e9(e,t),i=t,n=e1,o=e2,s=e2,a=e1;for(;r!==e1;){let e=i/r,t=i%r,l=n-s*e,u=o-a*e;i=r,r=t,n=s,o=a,s=l,a=u}if(i!==e2)throw Error("invert: does not exist");return e9(n,t)}let tt=(e,t)=>(e9(e,t)&e2)===e2,tr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ti(e){return eX(e,tr.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function tn(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),o=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),o),i}function to(e,t){let r=function(e,t){let r=(e.ORDER-e2)/e8,i=e.pow(t,r),n=e.eql(i,e.ONE),o=e.eql(i,e.ZERO),s=e.eql(i,e.neg(e.ONE));if(!n&&!o&&!s)throw Error("Cannot find square root: probably non-prime P");return n?1:o?0:-1}(e,t);return 0===r||1===r}function ts(e,t){void 0!==t&&(0,eC.anumber)(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function ta(e,t,r=!1,i={}){let n;if(e<=e1)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:o,nByteLength:s}=ts(e,t);if(s>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:s,MASK:eJ(o),ZERO:e1,ONE:e2,create:t=>e9(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return e1<=t&&t<e},is0:e=>e===e1,isOdd:e=>(e&e2)===e2,neg:t=>e9(-t,e),eql:(e,t)=>e===t,sqr:t=>e9(t*t,e),add:(t,r)=>e9(t+r,e),sub:(t,r)=>e9(t-r,e),mul:(t,r)=>e9(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<e1)throw Error("invalid exponent, negatives unsupported");if(r===e1)return e.ONE;if(r===e2)return t;let i=e.ONE,n=t;for(;r>e1;)r&e2&&(i=e.mul(i,n)),n=e.sqr(n),r>>=e2;return i})(a,e,t),div:(t,r)=>e9(t*te(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>te(t,e),sqrt:i.sqrt||(t=>(n||(n=e%e5===e3?function(t,r){let i=t.pow(r,(e+e2)/e5);if(!t.eql(t.sqr(i),r))throw Error("Cannot find square root");return i}:e%e4===e6?function(t,r){let i=t.mul(r,e8),n=t.pow(i,(e-e6)/e4),o=t.mul(r,n),s=t.mul(t.mul(o,e8),n),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}:function(e){let t=e-e2,r=0;for(;t%e8===e1;)t/=e8,r++;let i=e8,n=ta(e);for(;i<e&&to(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r){let t=(e+e2)/e5;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let o=(t+e2)/e8;return function(e,n){if(!to(e,n))throw Error("Cannot find square root");let s=r,a=e.pow(e.mul(e.ONE,i),t),l=e.pow(n,o),u=e.pow(n,t);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<s&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(a,e2<<BigInt(s-t-1));a=e.sqr(r),l=e.mul(l,r),u=e.mul(u,a),s=t}return l}}(e)),n(a,t))),toBytes:e=>r?e$(e,s):eF(e,s),fromBytes:e=>{if(e.length!==s)throw Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?eM(e):eL(e)},invertBatch:e=>tn(a,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(a)}function tl(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function tu(e){let t=tl(e);return t+Math.ceil(t/2)}let tc=BigInt(0),tf=BigInt(1);function th(e,t){let r=t.negate();return e?r:t}function tp(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function td(e,t){tp(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:eJ(e),maxNumber:n,shiftBy:BigInt(e)}}function ty(e,t,r){let{windowSize:i,mask:n,maxNumber:o,shiftBy:s}=r,a=Number(e&n),l=e>>s;a>i&&(a-=o,l+=tf);let u=t*i,c=u+Math.abs(a)-1,f=0===a;return{nextN:l,offset:c,isZero:f,isNeg:a<0,isNegF:t%2!=0,offsetF:u}}let tg=new WeakMap,tv=new WeakMap;function tm(e){return tv.get(e)||1}function tb(e,t){return{constTimeNegate:th,hasPrecomputes:e=>1!==tm(e),unsafeLadder(t,r,i=e.ZERO){let n=t;for(;r>tc;)r&tf&&(i=i.add(n)),n=n.double(),r>>=tf;return i},precomputeWindow(e,r){let{windows:i,windowSize:n}=td(r,t),o=[],s=e,a=s;for(let e=0;e<i;e++){a=s,o.push(a);for(let e=1;e<n;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,i,n){let o=e.ZERO,s=e.BASE,a=td(r,t);for(let e=0;e<a.windows;e++){let{nextN:t,offset:r,isZero:l,isNeg:u,isNegF:c,offsetF:f}=ty(n,e,a);n=t,l?s=s.add(th(c,i[f])):o=o.add(th(u,i[r]))}return{p:o,f:s}},wNAFUnsafe(r,i,n,o=e.ZERO){let s=td(r,t);for(let e=0;e<s.windows&&n!==tc;e++){let{nextN:t,offset:r,isZero:a,isNeg:l}=ty(n,e,s);if(n=t,!a){let e=i[r];o=o.add(l?e.negate():e)}}return o},getPrecomputes(e,t,r){let i=tg.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&tg.set(t,r(i))),i},wNAFCached(e,t,r){let i=tm(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let n=tm(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){tp(r,t),tv.set(e,r),tg.delete(e)}}}function tw(e,t,r,i){if(!Array.isArray(r))throw Error("array expected");r.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)});if(!Array.isArray(i))throw Error("array of scalars expected");if(i.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)}),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let n=e.ZERO,o=function(e){let t;for(t=0;e>eO;e>>=eI,t+=1);return t}(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=eJ(s),l=Array(Number(a)+1).fill(n),u=Math.floor((t.BITS-1)/s)*s,c=n;for(let e=u;e>=0;e-=s){l.fill(n);for(let t=0;t<i.length;t++){let n=Number(i[t]>>BigInt(e)&a);l[n]=l[n].add(r[t])}let t=n;for(let e=l.length-1,r=n;e>0;e--)r=r.add(l[e]),t=t.add(r);if(c=c.add(t),0!==e)for(let e=0;e<s;e++)c=c.double()}return c}function tA(e){return ti(e.Fp),eX(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ts(e.n,e.nBitLength),...e,...{p:e.Fp.ORDER}})}function tS(e){void 0!==e.lowS&&eU("lowS",e.lowS),void 0!==e.prehash&&eU("prehash",e.prehash)}let tB={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=tB;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=ej(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=i>127?ej(n.length/2|128):"";return ej(e)+o+n+t},decode(e,t){let{Err:r}=tB,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],o=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let s=t.subarray(i,i+e);if(s.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of s)o=o<<8|e;if(i+=e,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let s=t.subarray(i,i+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(i+o)}}},_int:{encode(e){let{Err:t}=tB;if(e<tx)throw new t("integer: negative integers are not allowed");let r=ej(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=tB;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return eL(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=tB,n=ez("signature",e),{v:o,l:s}=i.decode(48,n);if(s.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:l}=i.decode(2,o),{v:u,l:c}=i.decode(2,l);if(c.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(e){let{_tlv:t,_int:r}=tB,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},tx=BigInt(0),tE=BigInt(1),tk=BigInt(2),tC=BigInt(3),tO=BigInt(4);function tI(e,t){if(ti(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=function(e,t){let r=e.ORDER,i=tx;for(let e=r-tE;e%tk===tx;e/=tk)i+=tE;let n=i,o=tk<<n-tE-tE,s=o*tk,a=(r-tE)/s,l=(a-tE)/tk,u=s-tE,c=e.pow(t,a),f=e.pow(t,(a+tE)/tk),h=(t,r)=>{let i=c,s=e.pow(r,u),a=e.sqr(s);a=e.mul(a,r);let h=e.mul(t,a);h=e.pow(h,l),h=e.mul(h,s),s=e.mul(h,r),a=e.mul(h,t);let p=e.mul(a,s);h=e.pow(p,o);let d=e.eql(h,e.ONE);s=e.mul(a,f),h=e.mul(p,i),a=e.cmov(s,a,d),p=e.cmov(h,p,d);for(let t=n;t>tE;t--){let r=t-tk;r=tk<<r-tE;let n=e.pow(p,r),o=e.eql(n,e.ONE);s=e.mul(a,i),i=e.mul(i,i),n=e.mul(p,i),a=e.cmov(s,a,o),p=e.cmov(n,p,o)}return{isValid:d,value:a}};if(e.ORDER%tO===tC){let r=(e.ORDER-tC)/tO,i=e.sqrt(e.neg(t));h=(t,n)=>{let o=e.sqr(n),s=e.mul(t,n);o=e.mul(o,s);let a=e.pow(o,r);a=e.mul(a,s);let l=e.mul(a,i),u=e.mul(e.sqr(a),n),c=e.eql(u,t),f=e.cmov(l,a,c);return{isValid:c,value:f}}}return h}(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return i=>{let n,o,s,a,l,u,c,f;n=e.sqr(i),n=e.mul(n,t.Z),o=e.sqr(n),o=e.add(o,n),s=e.add(o,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),a=e.mul(a,t.A),o=e.sqr(s),u=e.sqr(a),l=e.mul(u,t.A),o=e.add(o,l),o=e.mul(o,s),u=e.mul(u,a),l=e.mul(u,t.B),o=e.add(o,l),c=e.mul(n,s);let{isValid:h,value:p}=r(o,u);f=e.mul(n,i),f=e.mul(f,p),c=e.cmov(c,s,h),f=e.cmov(f,p,h);let d=e.isOdd(i)===e.isOdd(f);f=e.cmov(e.neg(f),f,d);let y=tn(e,[a],!0)[0];return{x:c=e.mul(c,y),y:f}}}function tN(e,t){let r=t=>(function(e){let t,r=(eX(t=tA(e),{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})),{Fp:i,n:n}=r,o=i.BYTES+1,s=2*i.BYTES+1;function a(e){return e9(e,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:c,isWithinCurveOrder:f}=function(e){let t=function(e){let t=tA(e);eX(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:n}=t;if(r){if(!i.eql(n,i.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:r}=t,i=ta(t.n,t.nBitLength),n=t.toBytes||((e,t,i)=>{let n=t.toAffine();return eq(Uint8Array.from([4]),r.toBytes(n.x),r.toBytes(n.y))}),o=t.fromBytes||(e=>{let t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function s(e){let{a:i,b:n}=t,o=r.sqr(e),s=r.mul(o,e);return r.add(r.add(s,r.mul(e,i)),n)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw Error("bad generator point: equation left != right");function a(e){let r,{allowedPrivateKeyLengths:i,nByteLength:n,wrapPrivateKey:o,n:s}=t;if(i&&"bigint"!=typeof e){if(eN(e)&&(e=eD(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*n,"0")}try{r="bigint"==typeof e?e:eL(ez("private key",e,n))}catch(t){throw Error("invalid private key, expected hex or "+n+" bytes, got "+typeof e)}return o&&(r=e9(r,s)),eZ("private key",r,tE,s),r}function l(e){if(!(e instanceof f))throw Error("ProjectivePoint expected")}let u=e0((e,t)=>{let{px:i,py:n,pz:o}=e;if(r.eql(o,r.ONE))return{x:i,y:n};let s=e.is0();null==t&&(t=s?r.ONE:r.inv(o));let a=r.mul(i,t),l=r.mul(n,t),u=r.mul(o,t);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw Error("invZ was invalid");return{x:a,y:l}}),c=e0(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}let{x:i,y:n}=e.toAffine();if(!r.isValid(i)||!r.isValid(n))throw Error("bad point: x or y not FE");let o=r.sqr(n),a=s(i);if(!r.eql(o,a))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class f{constructor(e,t,i){if(null==e||!r.isValid(e))throw Error("x required");if(null==t||!r.isValid(t)||r.is0(t))throw Error("y required");if(null==i||!r.isValid(i))throw Error("z required");this.px=e,this.py=t,this.pz=i,Object.freeze(this)}static fromAffine(e){let{x:t,y:i}=e||{};if(!e||!r.isValid(t)||!r.isValid(i))throw Error("invalid affine point");if(e instanceof f)throw Error("projective point not allowed");let n=e=>r.eql(e,r.ZERO);return n(t)&&n(i)?f.ZERO:new f(t,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=tn(r,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(f.fromAffine)}static fromHex(e){let t=f.fromAffine(o(ez("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return f.BASE.multiply(a(e))}static msm(e,t){return tw(f,i,e,t)}_setWindowSize(e){p.setWindowSize(this,e)}assertValidity(){c(this)}hasEvenY(){let{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){l(e);let{px:t,py:i,pz:n}=this,{px:o,py:s,pz:a}=e,u=r.eql(r.mul(t,a),r.mul(o,n)),c=r.eql(r.mul(i,a),r.mul(s,n));return u&&c}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){let{a:e,b:i}=t,n=r.mul(i,tC),{px:o,py:s,pz:a}=this,l=r.ZERO,u=r.ZERO,c=r.ZERO,h=r.mul(o,o),p=r.mul(s,s),d=r.mul(a,a),y=r.mul(o,s);return y=r.add(y,y),c=r.mul(o,a),c=r.add(c,c),l=r.mul(e,c),u=r.mul(n,d),u=r.add(l,u),l=r.sub(p,u),u=r.add(p,u),u=r.mul(l,u),l=r.mul(y,l),c=r.mul(n,c),d=r.mul(e,d),y=r.sub(h,d),y=r.mul(e,y),y=r.add(y,c),c=r.add(h,h),h=r.add(c,h),h=r.add(h,d),h=r.mul(h,y),u=r.add(u,h),d=r.mul(s,a),d=r.add(d,d),h=r.mul(d,y),l=r.sub(l,h),c=r.mul(d,p),c=r.add(c,c),new f(l,u,c=r.add(c,c))}add(e){l(e);let{px:i,py:n,pz:o}=this,{px:s,py:a,pz:u}=e,c=r.ZERO,h=r.ZERO,p=r.ZERO,d=t.a,y=r.mul(t.b,tC),g=r.mul(i,s),v=r.mul(n,a),m=r.mul(o,u),b=r.add(i,n),w=r.add(s,a);b=r.mul(b,w),w=r.add(g,v),b=r.sub(b,w),w=r.add(i,o);let A=r.add(s,u);return w=r.mul(w,A),A=r.add(g,m),w=r.sub(w,A),A=r.add(n,o),c=r.add(a,u),A=r.mul(A,c),c=r.add(v,m),A=r.sub(A,c),p=r.mul(d,w),c=r.mul(y,m),p=r.add(c,p),c=r.sub(v,p),p=r.add(v,p),h=r.mul(c,p),v=r.add(g,g),v=r.add(v,g),m=r.mul(d,m),w=r.mul(y,w),v=r.add(v,m),m=r.sub(g,m),m=r.mul(d,m),w=r.add(w,m),g=r.mul(v,w),h=r.add(h,g),g=r.mul(A,w),c=r.mul(b,c),c=r.sub(c,g),g=r.mul(b,v),p=r.mul(A,p),new f(c,h,p=r.add(p,g))}subtract(e){return this.add(e.negate())}is0(){return this.equals(f.ZERO)}wNAF(e){return p.wNAFCached(this,e,f.normalizeZ)}multiplyUnsafe(e){let{endo:i,n:n}=t;eZ("scalar",e,tx,n);let o=f.ZERO;if(e===tx)return o;if(this.is0()||e===tE)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,e,f.normalizeZ);let{k1neg:s,k1:a,k2neg:l,k2:u}=i.splitScalar(e),c=o,h=o,d=this;for(;a>tx||u>tx;)a&tE&&(c=c.add(d)),u&tE&&(h=h.add(d)),d=d.double(),a>>=tE,u>>=tE;return s&&(c=c.negate()),l&&(h=h.negate()),h=new f(r.mul(h.px,i.beta),h.py,h.pz),c.add(h)}multiply(e){let i,n,{endo:o,n:s}=t;if(eZ("scalar",e,tE,s),o){let{k1neg:t,k1:s,k2neg:a,k2:l}=o.splitScalar(e),{p:u,f:c}=this.wNAF(s),{p:h,f:d}=this.wNAF(l);u=p.constTimeNegate(t,u),h=p.constTimeNegate(a,h),h=new f(r.mul(h.px,o.beta),h.py,h.pz),i=u.add(h),n=c.add(d)}else{let{p:t,f:r}=this.wNAF(e);i=t,n=r}return f.normalizeZ([i,n])[0]}multiplyAndAddUnsafe(e,t,r){let i=f.BASE,n=(e,t)=>t!==tx&&t!==tE&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),o=n(this,t).add(n(e,r));return o.is0()?void 0:o}toAffine(e){return u(this,e)}isTorsionFree(){let{h:e,isTorsionFree:r}=t;if(e===tE)return!0;if(r)return r(f,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:r}=t;return e===tE?this:r?r(f,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return eU("isCompressed",e),this.assertValidity(),n(f,this,e)}toHex(e=!0){return eU("isCompressed",e),eD(this.toRawBytes(e))}}f.BASE=new f(t.Gx,t.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);let h=t.nBitLength,p=tb(f,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:function(e){return eG(e,tE,t.n)}}}({...r,toBytes(e,t,r){let n=t.toAffine(),o=i.toBytes(n.x);return(eU("isCompressed",r),r)?eq(Uint8Array.from([t.hasEvenY()?2:3]),o):eq(Uint8Array.from([4]),o,i.toBytes(n.y))},fromBytes(e){let t=e.length,r=e[0],n=e.subarray(1);if(t===o&&(2===r||3===r)){let e,t=eL(n);if(!eG(t,tE,i.ORDER))throw Error("Point is not on curve");let o=c(t);try{e=i.sqrt(o)}catch(e){throw Error("Point is not on curve"+(e instanceof Error?": "+e.message:""))}return(1&r)==1!=((e&tE)===tE)&&(e=i.neg(e)),{x:t,y:e}}if(t===s&&4===r)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw Error("invalid Point, expected length of "+o+", or uncompressed "+s+", got "+t)}}),h=e=>eD(eF(e,r.nByteLength)),p=(e,t,r)=>eL(e.slice(t,r));class d{constructor(e,t,r){eZ("r",e,tE,n),eZ("s",t,tE,n),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){let t=r.nByteLength;return new d(p(e=ez("compactSignature",e,2*t),0,t),p(e,t,2*t))}static fromDER(e){let{r:t,s:r}=tB.toSig(ez("DER",e));return new d(t,r)}assertValidity(){}addRecoveryBit(e){return new d(this.r,this.s,e)}recoverPublicKey(e){let{r:t,s:o,recovery:s}=this,u=v(ez("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let c=2===s||3===s?t+r.n:t;if(c>=i.ORDER)throw Error("recovery id 2 or 3 invalid");let f=(1&s)==0?"02":"03",p=l.fromHex(f+h(c)),d=te(c,n),y=a(-u*d),g=a(o*d),m=l.BASE.multiplyAndAddUnsafe(p,y,g);if(!m)throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return this.s>n>>tE}normalizeS(){return this.hasHighS()?new d(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return eV(this.toDERHex())}toDERHex(){return tB.hexFromSig(this)}toCompactRawBytes(){return eV(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}function y(e){let t=eN(e),r="string"==typeof e,i=(t||r)&&e.length;return t?i===o||i===s:r?i===2*o||i===2*s:e instanceof l}let g=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=eL(e),i=8*e.length-r.nBitLength;return i>0?t>>BigInt(i):t},v=r.bits2int_modN||function(e){return a(g(e))},m=eJ(r.nBitLength);function b(e){return eZ("num < 2^"+r.nBitLength,e,tx,m),eF(e,r.nByteLength)}let w={lowS:r.lowS,prehash:!1},A={lowS:r.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(y(e))throw Error("first arg must be private key");if(!y(t))throw Error("second arg must be public key");return l.fromHex(t).multiply(u(e)).toRawBytes(r)},sign:function(e,t,o=w){let{seed:s,k2sig:c}=function(e,t,o=w){if(["recovered","canonical"].some(e=>e in o))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:c}=r,{lowS:h,prehash:p,extraEntropy:y}=o;null==h&&(h=!0),e=ez("msgHash",e),tS(o),p&&(e=ez("prehashed msgHash",s(e)));let m=v(e),A=u(t),S=[b(A),b(m)];if(null!=y&&!1!==y){let e=!0===y?c(i.BYTES):y;S.push(ez("extraEntropy",e))}return{seed:eq(...S),k2sig:function(e){var t;let r=g(e);if(!f(r))return;let i=te(r,n),o=l.BASE.multiply(r).toAffine(),s=a(o.x);if(s===tx)return;let u=a(i*a(m+s*A));if(u===tx)return;let c=2*(o.x!==s)|Number(o.y&tE),p=u;return h&&u>n>>tE&&(p=(t=u)>n>>tE?a(-t):t,c^=1),new d(s,p,c)}}}(e,t,o);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=eY(e),n=eY(e),o=0,s=()=>{i.fill(1),n.fill(0),o=0},a=(...e)=>r(n,i,...e),l=(e=eY(0))=>{let t;if(n=a((t=[0],Uint8Array.from(t)),e),i=a(),0!==e.length){let t;n=a((t=[1],Uint8Array.from(t)),e),i=a()}},u=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=a()).slice();r.push(t),e+=i.length}return eq(...r)};return(e,t)=>{let r;for(s(),l(e);!(r=t(u()));)l();return s(),r}})(r.hash.outputLen,r.nByteLength,r.hmac)(s,c)},verify:function(e,t,i,o=A){let s,u;t=ez("msgHash",t),i=ez("publicKey",i);let{lowS:c,prehash:f,format:h}=o;if(tS(o),"strict"in o)throw Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw Error("format must be compact or der");let p="string"==typeof e||eN(e),y=!p&&!h&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!p&&!y)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(y&&(u=new d(e.r,e.s)),p){try{"compact"!==h&&(u=d.fromDER(e))}catch(e){if(!(e instanceof tB.Err))throw e}u||"der"===h||(u=d.fromCompact(e))}s=l.fromHex(i)}catch(e){return!1}if(!u||c&&u.hasHighS())return!1;f&&(t=r.hash(t));let{r:g,s:m}=u,b=v(t),w=te(m,n),S=a(b*w),B=a(g*w),x=l.BASE.multiplyAndAddUnsafe(s,S,B)?.toAffine();return!!x&&a(x.x)===g},ProjectivePoint:l,Signature:d,utils:{isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let e=tu(r.n);return function(e,t,r=!1){let i=e.length,n=tl(t),o=tu(t);if(i<16||i<o||i>1024)throw Error("expected "+o+"-1024 bytes of input, got "+i);let s=e9(r?eM(e):eL(e),t-e2)+e2;return r?e$(s,n):eF(s,n)}(r.randomBytes(e),r.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...e,...{hash:t,hmac:(e,...r)=>(0,ek.hmac)(t,e,(0,eC.concatBytes)(...r)),randomBytes:eC.randomBytes}});return{...r(t),create:r}}function tT(e,t){if(tU(e),tU(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)r[i]=255&e,e>>>=8;return new Uint8Array(r)}function tU(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function tj(e,t,r){let i;eX(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:o,m:s,hash:a,expand:l,DST:u}=r;eT(e),tU(t);let c="string"==typeof u?eK(u):u,f=Math.ceil((n.toString(2).length+o)/8),h=t*s*f;if("xmd"===l)i=function(e,t,r,i){eT(e),eT(t),tU(r),t.length>255&&(t=i(eq(eK("H2C-OVERSIZE-DST-"),t)));let{outputLen:n,blockLen:o}=i,s=Math.ceil(r/n);if(r>65535||s>255)throw Error("expand_message_xmd: invalid lenInBytes");let a=eq(t,tT(t.length,1)),l=tT(0,o),u=tT(r,2),c=Array(s),f=i(eq(l,e,u,tT(0,1),a));c[0]=i(eq(f,tT(1,1),a));for(let e=1;e<=s;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r}(f,c[e-1]),tT(e+1,1),a];c[e]=i(eq(...t))}return eq(...c).slice(0,r)}(e,c,h,a);else if("xof"===l)i=function(e,t,r,i,n){if(eT(e),eT(t),tU(r),t.length>255){let e=Math.ceil(2*i/8);t=n.create({dkLen:e}).update(eK("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return n.create({dkLen:r}).update(e).update(tT(r,2)).update(t).update(tT(t.length,1)).digest()}(e,c,h,o,a);else if("_internal_pass"===l)i=e;else throw Error('expand must be "xmd" or "xof"');let p=Array(t);for(let e=0;e<t;e++){let t=Array(s);for(let r=0;r<s;r++){let o=f*(r+e*s),a=i.subarray(o,o+f);t[r]=e9(eL(a),n)}p[e]=t}return p}function tP(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");function i(r){return e.fromAffine(t(r))}function n(t){let r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){let o=tj(e,2,{...r,DST:r.DST,...t}),s=i(o[0]),a=i(o[1]);return n(s.add(a))},encodeToCurve:(e,t)=>n(i(tj(e,1,{...r,DST:r.encodeDST,...t})[0])),mapToCurve(e){if(!Array.isArray(e))throw Error("expected array of bigints");for(let t of e)if("bigint"!=typeof t)throw Error("expected array of bigints");return n(i(e))}}}let tR=ta(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tH=tR.create(BigInt("-3")),tD=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),t_=tN({a:tH,b:tD,Fp:tR,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},eE.sha256),tV=tI(tR,{A:tH,B:tD,Z:tR.create(BigInt("-10"))});tP(t_.ProjectivePoint,e=>tV(e[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:tR.ORDER,m:1,k:128,expand:"xmd",hash:eE.sha256});let tL=ta(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),tM=tL.create(BigInt("-3")),tF=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef");tN({a:tM,b:tF,Fp:tL,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},eE.sha384),tI(tL,{A:tM,B:tF,Z:tL.create(BigInt("-12"))});let t$=ta(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tz=t$.create(BigInt("-3")),tq=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00");tN({a:tz,b:tq,Fp:t$,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},eE.sha512),tI(t$,{A:tz,B:tq,Z:t$.create(BigInt("-4"))});let tK=Uint8Array.from([0]),tW=Uint8Array.of();var tG=e.i(280355);function tZ(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function tJ(e,...t){if(!tZ(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function tY(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function tQ(e,t){tJ(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function tX(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function t0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function t1(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}let t2=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function t8(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(tZ(e))e=t6(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function t3(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),o=BigInt(0xffffffff),s=Number(r>>n&o),a=Number(r&o),l=4*!!i,u=4*!i;e.setUint32(t+l,s,i),e.setUint32(t+u,a,i)}function t5(e){return e.byteOffset%4==0}function t6(e){return Uint8Array.from(e)}let t4=new Uint8Array(16),t9=tX(t4),t7=(e,t,r,i)=>({s3:r<<31|i>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^-0x1f000000&-(1&i&1)}),re=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class rt{constructor(e,t){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,tJ(e=t8(e),16);const r=t1(e);let i=r.getUint32(0,!1),n=r.getUint32(4,!1),o=r.getUint32(8,!1),s=r.getUint32(12,!1);const a=[];for(let e=0;e<128;e++)a.push({s0:re(i),s1:re(n),s2:re(o),s3:re(s)}),{s0:i,s1:n,s2:o,s3:s}=t7(i,n,o,s);const l=(e=>e>65536?8:e>1024?4:2)(t||1024);if(![1,2,4,8].includes(l))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;const u=128/l,c=this.windowSize=2**l,f=[];for(let e=0;e<u;e++)for(let t=0;t<c;t++){let r=0,i=0,n=0,o=0;for(let s=0;s<l;s++){if(!(t>>>l-s-1&1))continue;const{s0:u,s1:c,s2:f,s3:h}=a[l*e+s];r^=u,i^=c,n^=f,o^=h}f.push({s0:r,s1:i,s2:n,s3:o})}this.t=f}_updateBlock(e,t,r,i){e^=this.s0,t^=this.s1,r^=this.s2,i^=this.s3;let{W:n,t:o,windowSize:s}=this,a=0,l=0,u=0,c=0,f=(1<<n)-1,h=0;for(let p of[e,t,r,i])for(let e=0;e<4;e++){let t=p>>>8*e&255;for(let e=8/n-1;e>=0;e--){let{s0:r,s1:i,s2:p,s3:d}=o[h*s+(t>>>n*e&f)];a^=r,l^=i,u^=p,c^=d,h+=1}}this.s0=a,this.s1=l,this.s2=u,this.s3=c}update(e){tY(this),tJ(e=t8(e));let t=tX(e),r=Math.floor(e.length/16),i=e.length%16;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return i&&(t4.set(e.subarray(16*r)),this._updateBlock(t9[0],t9[1],t9[2],t9[3]),t0(t9)),this}destroy(){let{t:e}=this;for(let t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){tY(this),tQ(e,this),this.finished=!0;let{s0:t,s1:r,s2:i,s3:n}=this,o=tX(e);return o[0]=t,o[1]=r,o[2]=i,o[3]=n,e}digest(){let e=new Uint8Array(16);return this.digestInto(e),this.destroy(),e}}class rr extends rt{constructor(e,t){tJ(e=t8(e));const r=function(e){e.reverse();let t=1&e[15],r=0;for(let t=0;t<e.length;t++){let i=e[t];e[t]=i>>>1|r,r=(1&i)<<7}return e[0]^=225&-t,e}(t6(e));super(r,t),t0(r)}update(e){e=t8(e),tY(this);let t=tX(e),r=e.length%16,i=Math.floor(e.length/16);for(let e=0;e<i;e++)this._updateBlock(re(t[4*e+3]),re(t[4*e+2]),re(t[4*e+1]),re(t[4*e+0]));return r&&(t4.set(e.subarray(16*i)),this._updateBlock(re(t9[3]),re(t9[2]),re(t9[1]),re(t9[0])),t0(t9)),this}digestInto(e){tY(this),tQ(e,this),this.finished=!0;let{s0:t,s1:r,s2:i,s3:n}=this,o=tX(e);return o[0]=t,o[1]=r,o[2]=i,o[3]=n,e.reverse()}}function ri(e){let t=(t,r)=>e(r,t.length).update(t8(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}let rn=ri((e,t)=>new rt(e,t));ri((e,t)=>new rr(e,t));let ro=new Uint8Array(16);function rs(e){return e<<1^283&-(e>>7)}function ra(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=rs(e);return r}let rl=(()=>{let e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=rs(r))e[t]=r;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let i=e[255-r];i|=i<<8,t[e[r]]=(i^i>>4^i>>5^i>>6^i>>7^99)&255}return t0(e),t})(),ru=rl.map((e,t)=>rl.indexOf(t)),rc=e=>e<<24|e>>>8,rf=e=>e<<8|e>>>24;function rh(e,t){if(256!==e.length)throw Error("Wrong sbox length");let r=new Uint32Array(256).map((r,i)=>t(e[i])),i=r.map(rf),n=i.map(rf),o=n.map(rf),s=new Uint32Array(65536),a=new Uint32Array(65536),l=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){let c=256*t+u;s[c]=r[t]^i[u],a[c]=n[t]^o[u],l[c]=e[t]<<8|e[u]}return{sbox:e,sbox2:l,T0:r,T1:i,T2:n,T3:o,T01:s,T23:a}}let rp=rh(rl,e=>ra(e,3)<<24|e<<16|e<<8|ra(e,2)),rd=rh(ru,e=>ra(e,11)<<24|ra(e,13)<<16|ra(e,9)<<8|ra(e,14)),ry=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=rs(r))e[t]=r;return e})();function rg(e){tJ(e);let t=e.length;if(![16,24,32].includes(t))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:r}=rp,i=[];t5(e)||i.push(e=t6(e));let n=tX(e),o=n.length,s=e=>rm(r,e,e,e,e),a=new Uint32Array(t+28);a.set(n);for(let e=o;e<a.length;e++){let t=a[e-1];e%o==0?t=s(rc(t))^ry[e/o-1]:o>6&&e%o==4&&(t=s(t)),a[e]=a[e-o]^t}return t0(...i),a}function rv(e,t,r,i,n,o){return e[r<<8&65280|i>>>8&255]^t[n>>>8&65280|o>>>24&255]}function rm(e,t,r,i,n){return e[255&t|65280&r]|e[i>>>16&255|n>>>16&65280]<<16}function rb(e,t,r,i,n){let{sbox2:o,T01:s,T23:a}=rp,l=0;t^=e[l++],r^=e[l++],i^=e[l++],n^=e[l++];let u=e.length/4-2;for(let o=0;o<u;o++){let o=e[l++]^rv(s,a,t,r,i,n),u=e[l++]^rv(s,a,r,i,n,t),c=e[l++]^rv(s,a,i,n,t,r),f=e[l++]^rv(s,a,n,t,r,i);t=o,r=u,i=c,n=f}return{s0:e[l++]^rm(o,t,r,i,n),s1:e[l++]^rm(o,r,i,n,t),s2:e[l++]^rm(o,i,n,t,r),s3:e[l++]^rm(o,n,t,r,i)}}function rw(e,t,r,i,n){tJ(r,16),tJ(i),n=function(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!t5(t))throw Error("invalid output, must be aligned");return t}(i.length,n);let o=tX(r),s=t1(r),a=tX(i),l=tX(n),u=12*!t,c=i.length,f=s.getUint32(u,t),{s0:h,s1:p,s2:d,s3:y}=rb(e,o[0],o[1],o[2],o[3]);for(let r=0;r+4<=a.length;r+=4)l[r+0]=a[r+0]^h,l[r+1]=a[r+1]^p,l[r+2]=a[r+2]^d,l[r+3]=a[r+3]^y,f=f+1>>>0,s.setUint32(u,f,t),{s0:h,s1:p,s2:d,s3:y}=rb(e,o[0],o[1],o[2],o[3]);let g=16*Math.floor(a.length/4);if(g<c){var v;let e=new Uint32Array([h,p,d,y]),t=new Uint8Array((v=e).buffer,v.byteOffset,v.byteLength);for(let e=g,r=0;e<c;e++,r++)n[e]=i[e]^t[r];t0(e)}return n}let rA=((e,t)=>{function r(i,...n){if(tJ(i),!t2)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){let t=n[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?tJ(t):tJ(t,e.nonceLength)}let o=e.tagLength;o&&void 0!==n[1]&&tJ(n[1]);let s=t(i,...n),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");tJ(t)}},l=!1;return{encrypt(e,t){if(l)throw Error("cannot encrypt() twice with same key + nonce");return l=!0,tJ(e),a(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(tJ(e),o&&e.length<o)throw Error("invalid ciphertext length: smaller than tagLength="+o);return a(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,r){if(t.length<8)throw Error("aes/gcm: invalid nonce length");function i(e,t,i){let n,o,s,a,l=(n=r?r.length:0,o=rn.create(e,i.length+n),r&&o.update(r),s=function(e,t,r){if("boolean"!=typeof r)throw Error(`boolean expected, not ${r}`);let i=new Uint8Array(16),n=t1(i);return t3(n,0,BigInt(t),r),t3(n,8,BigInt(e),r),i}(8*i.length,8*n,!1),o.update(i),o.update(s),a=o.digest(),t0(s),a);for(let e=0;e<t.length;e++)l[e]^=t[e];return l}function n(){let r=rg(e),i=ro.slice(),n=ro.slice();if(rw(r,!1,n,n,i),12===t.length)n.set(t);else{let e=ro.slice();t3(t1(e),8,BigInt(8*t.length),!1);let r=rn.create(i).update(t).update(e);r.digestInto(n),r.destroy()}let o=rw(r,!1,n,ro);return{xk:r,authKey:i,counter:n,tagMask:o}}return{encrypt(e){let{xk:t,authKey:r,counter:o,tagMask:s}=n(),a=new Uint8Array(e.length+16),l=[t,r,o,s];t5(e)||l.push(e=t6(e)),rw(t,!1,o,e,a.subarray(0,e.length));let u=i(r,s,a.subarray(0,a.length-16));return l.push(u),a.set(u,e.length),t0(...l),a},decrypt(e){let{xk:t,authKey:r,counter:o,tagMask:s}=n(),a=[t,r,s,o];t5(e)||a.push(e=t6(e));let l=e.subarray(0,-16),u=e.subarray(-16),c=i(r,s,l);if(a.push(c),!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(c,u))throw Error("aes/gcm: invalid ghash tag");let f=rw(t,!1,o,l);return t0(...a),f}}});var rS=["u8","u16","u32","u64","u128","i8","i16","i32","i64","i128","f32","f64"],rB=function(){function e(){this.offset=0,this.buffer_size=256,this.buffer=new ArrayBuffer(this.buffer_size),this.view=new DataView(this.buffer)}return e.prototype.resize_if_necessary=function(e){if(this.buffer_size-this.offset<e){this.buffer_size=Math.max(2*this.buffer_size,this.buffer_size+e);var t=new ArrayBuffer(this.buffer_size);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}},e.prototype.get_used_buffer=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},e.prototype.store_value=function(e,t){var r=t.substring(1),i=parseInt(r)/8;this.resize_if_necessary(i);var n="f"===t[0]?"setFloat".concat(r):"i"===t[0]?"setInt".concat(r):"setUint".concat(r);this.view[n](this.offset,e,!0),this.offset+=i},e.prototype.store_bytes=function(e){this.resize_if_necessary(e.length),new Uint8Array(this.buffer).set(new Uint8Array(e),this.offset),this.offset+=e.length},e}(),rx=function(){function e(e){this.offset=0,this.buffer_size=e.length,this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e),this.view=new DataView(this.buffer)}return e.prototype.assert_enough_buffer=function(e){if(this.offset+e>this.buffer.byteLength)throw Error("Error in schema, the buffer is smaller than expected")},e.prototype.consume_value=function(e){var t=e.substring(1),r=parseInt(t)/8;this.assert_enough_buffer(r);var i="f"===e[0]?"getFloat".concat(t):"i"===e[0]?"getInt".concat(t):"getUint".concat(t),n=this.view[i](this.offset,!0);return this.offset+=r,n},e.prototype.consume_bytes=function(e){this.assert_enough_buffer(e);var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},e}(),rE=(t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,r)},function(e,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)});function rk(e,t,r){if(typeof e!==t)throw Error("Expected ".concat(t," not ").concat(typeof e,"(").concat(e,") at ").concat(r.join(".")))}function rC(e,t,r){if(e!==t)throw Error("Array length ".concat(e," does not match schema length ").concat(t," at ").concat(r.join(".")))}var rO=rS.concat(["bool","string"]),rI=["option","enum","array","set","map","struct"],rN=function(e){function t(t,r){var i="Invalid schema: ".concat(JSON.stringify(t)," expected ").concat(r);return e.call(this,i)||this}return rE(t,e),t}(Error),rT=function(){function e(e){this.encoded=new rB,this.fieldPath=["value"],this.checkTypes=e}return e.prototype.encode=function(e,t){return this.encode_value(e,t),this.encoded.get_used_buffer()},e.prototype.encode_value=function(e,t){if("string"==typeof t){if(rS.includes(t))return this.encode_integer(e,t);if("string"===t)return this.encode_string(e);if("bool"===t)return this.encode_boolean(e)}if("object"==typeof t){if("option"in t)return this.encode_option(e,t);if("enum"in t)return this.encode_enum(e,t);if("array"in t)return this.encode_array(e,t);if("set"in t)return this.encode_set(e,t);if("map"in t)return this.encode_map(e,t);if("struct"in t)return this.encode_struct(e,t)}},e.prototype.encode_integer=function(e,t){var r=parseInt(t.substring(1));r<=32||"f64"==t?(this.checkTypes&&rk(e,"number",this.fieldPath),this.encoded.store_value(e,t)):(this.checkTypes&&function(e,t){var r=["number","string","bigint","boolean"].includes(typeof e),i="object"==typeof e&&null!==e&&"toString"in e;if(!r&&!i)throw Error("Expected bigint, number, boolean or string not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}(e,this.fieldPath),this.encode_bigint(BigInt(e),r))},e.prototype.encode_bigint=function(e,t){for(var r=t/8,i=new Uint8Array(r),n=0;n<r;n++)i[n]=Number(e&BigInt(255)),e>>=BigInt(8);this.encoded.store_bytes(new Uint8Array(i))},e.prototype.encode_string=function(e){this.checkTypes&&rk(e,"string",this.fieldPath);for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&e.charCodeAt(r)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}this.encoded.store_value(t.length,"u32"),this.encoded.store_bytes(new Uint8Array(t))},e.prototype.encode_boolean=function(e){this.checkTypes&&rk(e,"boolean",this.fieldPath),this.encoded.store_value(+!!e,"u8")},e.prototype.encode_option=function(e,t){null==e?this.encoded.store_value(0,"u8"):(this.encoded.store_value(1,"u8"),this.encode_value(e,t.option))},e.prototype.encode_enum=function(e,t){this.checkTypes&&function(e,t){if("object"!=typeof e||null===e)throw Error("Expected object not ".concat(typeof e,"(").concat(e,") at ").concat(t.join(".")))}(e,this.fieldPath);for(var r=Object.keys(e)[0],i=0;i<t.enum.length;i++){var n=t.enum[i];if(r===Object.keys(n.struct)[0])return this.encoded.store_value(i,"u8"),this.encode_struct(e,n)}throw Error("Enum key (".concat(r,") not found in enum schema: ").concat(JSON.stringify(t)," at ").concat(this.fieldPath.join(".")))},e.prototype.encode_array=function(e,t){if(Array.isArray(e)||e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&(0===e.length||e.length>0&&e.length-1 in e))return this.encode_arraylike(e,t);if(e instanceof ArrayBuffer)return this.encode_buffer(e,t);throw Error("Expected Array-like not ".concat(typeof e,"(").concat(e,") at ").concat(this.fieldPath.join(".")))},e.prototype.encode_arraylike=function(e,t){t.array.len?rC(e.length,t.array.len,this.fieldPath):this.encoded.store_value(e.length,"u32");for(var r=0;r<e.length;r++)this.encode_value(e[r],t.array.type)},e.prototype.encode_buffer=function(e,t){t.array.len?rC(e.byteLength,t.array.len,this.fieldPath):this.encoded.store_value(e.byteLength,"u32"),this.encoded.store_bytes(new Uint8Array(e))},e.prototype.encode_set=function(e,t){this.checkTypes&&rk(e,"object",this.fieldPath);var r=e instanceof Set?Array.from(e.values()):Object.values(e);this.encoded.store_value(r.length,"u32");for(var i=0;i<r.length;i++){var n=r[i];this.encode_value(n,t.set)}},e.prototype.encode_map=function(e,t){this.checkTypes&&rk(e,"object",this.fieldPath);var r=e instanceof Map,i=r?Array.from(e.keys()):Object.keys(e);this.encoded.store_value(i.length,"u32");for(var n=0;n<i.length;n++){var o=i[n];this.encode_value(o,t.map.key),this.encode_value(r?e.get(o):e[o],t.map.value)}},e.prototype.encode_struct=function(e,t){this.checkTypes&&rk(e,"object",this.fieldPath);for(var r=0,i=Object.keys(t.struct);r<i.length;r++){var n=i[r];this.fieldPath.push(n),this.encode_value(e[n],t.struct[n]),this.fieldPath.pop()}},e}();function rU(e){this.buffer=new rx(e)}rU.prototype.decode=function(e){return this.decode_value(e)},rU.prototype.decode_value=function(e){if("string"==typeof e){if(rS.includes(e))return this.decode_integer(e);if("string"===e)return this.decode_string();if("bool"===e)return this.decode_boolean()}if("object"==typeof e){if("option"in e)return this.decode_option(e);if("enum"in e)return this.decode_enum(e);if("array"in e)return this.decode_array(e);if("set"in e)return this.decode_set(e);if("map"in e)return this.decode_map(e);if("struct"in e)return this.decode_struct(e)}throw Error("Unsupported type: ".concat(e))},rU.prototype.decode_integer=function(e){var t=parseInt(e.substring(1));return t<=32||"f64"==e?this.buffer.consume_value(e):this.decode_bigint(t,e.startsWith("i"))},rU.prototype.decode_bigint=function(e,t){void 0===t&&(t=!1);var r=e/8,i=new Uint8Array(this.buffer.consume_bytes(r)),n=i.reduceRight(function(e,t){return e+t.toString(16).padStart(2,"0")},"");return t&&i[r-1]?BigInt.asIntN(e,BigInt("0x".concat(n))):BigInt("0x".concat(n))},rU.prototype.decode_string=function(){for(var e=this.decode_integer("u32"),t=new Uint8Array(this.buffer.consume_bytes(e)),r=[],i=0;i<e;++i){var n=t[i];if(n<128)r.push(n);else if(n<224)r.push((31&n)<<6|63&t[++i]);else if(n<240)r.push((15&n)<<12|(63&t[++i])<<6|63&t[++i]);else{var o=(7&n)<<18|(63&t[++i])<<12|(63&t[++i])<<6|63&t[++i];r.push(o)}}return String.fromCodePoint.apply(String,r)},rU.prototype.decode_boolean=function(){return this.buffer.consume_value("u8")>0},rU.prototype.decode_option=function(e){var t=this.buffer.consume_value("u8");if(1===t)return this.decode_value(e.option);if(0!==t)throw Error("Invalid option ".concat(t));return null},rU.prototype.decode_enum=function(e){var t,r=this.buffer.consume_value("u8");if(r>e.enum.length)throw Error("Enum option ".concat(r," is not available"));var i=e.enum[r].struct,n=Object.keys(i)[0];return(t={})[n]=this.decode_value(i[n]),t},rU.prototype.decode_array=function(e){for(var t=[],r=e.array.len?e.array.len:this.decode_integer("u32"),i=0;i<r;++i)t.push(this.decode_value(e.array.type));return t},rU.prototype.decode_set=function(e){for(var t=this.decode_integer("u32"),r=new Set,i=0;i<t;++i)r.add(this.decode_value(e.set));return r},rU.prototype.decode_map=function(e){for(var t=this.decode_integer("u32"),r=new Map,i=0;i<t;++i){var n=this.decode_value(e.map.key),o=this.decode_value(e.map.value);r.set(n,o)}return r},rU.prototype.decode_struct=function(e){var t={};for(var r in e.struct)t[r]=this.decode_value(e.struct[r]);return t},e.i(95185);var rj=e.i(628778);let rP=(e,t)=>(e&BigInt(1)<<BigInt(t))!==BigInt(0),rR=new Uint8Array([75,69,77,0,16]),rH=new Uint8Array([72,80,75,69,0,16,0,1,0,2]),rD=new Uint8Array([72,80,75,69,45,118,49]),r_=new Uint8Array([115,101,99,114,101,116]),rV=new Uint8Array([101,97,101,95,112,114,107]),rL=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),rM=new Uint8Array([0,32,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,107,101,121,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),rF=new Uint8Array([0,12,72,80,75,69,45,118,49,72,80,75,69,0,16,0,1,0,2,98,97,115,101,95,110,111,110,99,101,0,143,195,174,184,50,73,10,75,90,179,228,32,35,40,125,178,154,31,75,199,194,34,192,223,34,135,39,183,10,64,33,18,47,63,4,233,32,108,209,36,19,80,53,41,180,122,198,166,48,185,46,196,207,125,35,69,8,208,175,151,113,201,158,80]),r$=new Uint8Array([113,111,115,95,101,110,99,114,121,112,116,105,111,110,95,104,109,97,99,95,109,101,115,115,97,103,101]),rz="04cf288fe433cc4e1aa0ce1632feac4ea26bf2f5a09dcfe5a42c398e06898710330f0572882f4dbdf0f5304b8fc8703acd69adca9a4bbf7f5d00d20a5e364b2569",rq=`-----BEGIN CERTIFICATE-----
MIICETCCAZagAwIBAgIRAPkxdWgbkK/hHUbMtOTn+FYwCgYIKoZIzj0EAwMwSTEL
MAkGA1UEBhMCVVMxDzANBgNVBAoMBkFtYXpvbjEMMAoGA1UECwwDQVdTMRswGQYD
VQQDDBJhd3Mubml0cm8tZW5jbGF2ZXMwHhcNMTkxMDI4MTMyODA1WhcNNDkxMDI4
MTQyODA1WjBJMQswCQYDVQQGEwJVUzEPMA0GA1UECgwGQW1hem9uMQwwCgYDVQQL
DANBV1MxGzAZBgNVBAMMEmF3cy5uaXRyby1lbmNsYXZlczB2MBAGByqGSM49AgEG
BSuBBAAiA2IABPwCVOumCMHzaHDimtqQvkY4MpJzbolL//Zy2YlES1BR5TSksfbb
48C8WBoyt7F2Bw7eEtaaP+ohG2bnUs990d0JX28TcPQXCEPZ3BABIeTPYwEoCWZE
h8l5YoQwTcU/9KNCMEAwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUkCW1DdkF
R+eWw5b6cp3PmanfS5YwDgYDVR0PAQH/BAQDAgGGMAoGCCqGSM49BAMDA2kAMGYC
MQCjfy+Rocm9Xue4YnwWmNJVA44fA0P5W2OpYow9OYCVRaEevL8uO1XYru5xtMPW
rfMCMQCi85sWBbJwKKXdS6BptQFuZbT73o/gBh1qUxl/nNr12UO8Yfwr6wPLb+6N
IwLz3/Y=
-----END CERTIFICATE-----`,rK="641A0321A3E244EFE456463195D606317ED7CDCC3C1756E09893F3C68F79BB5B",rW={struct:{nonce:{array:{type:"u8",len:12}},ephemeralSenderPublic:{array:{type:"u8",len:65}},encryptedMessage:{array:{type:"u8"}}}},rG=(e,t=!0)=>t_.getPublicKey(e,t),rZ=({plainTextBuf:e,targetKeyBuf:t})=>{try{let r=r0(),i=(0,rj.uint8ArrayFromHexString)(r.privateKey),n=(0,rj.uint8ArrayFromHexString)(r.publicKeyUncompressed),o=r1(n,t),s=r9(t,(0,rj.uint8ArrayToHexString)(i)),a=it(n,(0,rj.uint8ArrayToHexString)(t)),l=r5(rV,s,rR),u=r6(rL,a,rR,32),c=r4(new Uint8Array([]),l,u,32);l=r5(r_,new Uint8Array([]),rH),u=rM;let f=r4(c,l,u,32);u=rF;let h=r4(c,l,u,12),p=r7(e,f,h,o),d=r8(n),y=new Uint8Array(d.length+p.length);return y.set(d,0),y.set(p,d.length),y}catch(e){throw Error(`Unable to perform hpkeEncrypt: ${e}`)}},rJ=({plainTextBuf:e,targetKeyBuf:t,senderPriv:r})=>{try{let i=(0,rj.uint8ArrayFromHexString)(r),n=rG(r,!1),o=r1(n,t),s=r9(t,(0,rj.uint8ArrayToHexString)(i)),a=it(n,(0,rj.uint8ArrayToHexString)(t)),l=r5(rV,s,rR),u=r6(rL,a,rR,32),c=r4(new Uint8Array([]),l,u,32);l=r5(r_,new Uint8Array([]),rH),u=rM;let f=r4(c,l,u,32);u=rF;let h=r4(c,l,u,12),p=r7(e,f,h,o),d=r8(n),y=new Uint8Array(d.length+p.length);return y.set(d,0),y.set(p,d.length),y}catch(e){throw Error(`Unable to perform hpkeEncrypt: ${e}`)}},rY=async(e,t)=>{var r;let i=r0(),n=i.publicKeyUncompressed,o=await is((0,rj.uint8ArrayFromHexString)(n),(0,rj.uint8ArrayFromHexString)(i.privateKey),e),s=new Uint8Array(12);crypto.getRandomValues(s);let a=function(e,t){let r=e.length,i=t.length;if(r>255||i>255)throw Error("AAD len fields are 1 byte");let n=new Uint8Array(r+1+i+1),o=0;return n.set(e,o),o+=r,n[o++]=r,n.set(t,o),o+=i,n[o++]=i,n}((0,rj.uint8ArrayFromHexString)(n),e),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:s,tagLength:128,additionalData:a},o,t),u={nonce:s,ephemeralSenderPublic:(0,rj.uint8ArrayFromHexString)(n),encryptedMessage:new Uint8Array(l)};return void 0===r&&(r=!0),r&&function e(t){if(!("string"==typeof t&&rO.includes(t))){if(t&&"object"==typeof t){var r=Object.keys(t);if(1===r.length&&rI.includes(r[0])){var i=r[0];if("option"===i)return e(t[i]);if("enum"===i){var n=t[i];if(!Array.isArray(n))throw new rN(n,"Array");for(var o=0;o<n.length;o++){var s=n[o];if("object"!=typeof s||!("struct"in s))throw Error('Missing "struct" key in enum schema');if("object"!=typeof s.struct||1!==Object.keys(s.struct).length)throw Error('The "struct" in each enum must have a single key');e({struct:s.struct})}return}if("array"===i){var a=t[i];if("object"!=typeof a)throw new rN(a,"{ type, len? }");if(a.len&&"number"!=typeof a.len)throw Error("Invalid schema: ".concat(a));if("type"in a)return e(a.type);throw new rN(a,"{ type, len? }")}if("set"===i)return e(t[i]);if("map"===i){var l=t[i];if("object"==typeof l&&"key"in l&&"value"in l)e(l.key),e(l.value);else throw new rN(l,"{ key, value }");return}if("struct"===i){var u=t[i];if("object"!=typeof u)throw new rN(u,"object");for(var c in u)e(u[c]);return}}}throw new rN(t,rI.join(", ")+" or "+rO.join(", "))}}(rW),new rT(r).encode(u,rW)},rQ=e=>{let t=e.slice(0,33),r=e.slice(33);return JSON.stringify({encappedPublic:(0,rj.uint8ArrayToHexString)(r3(t)),ciphertext:(0,rj.uint8ArrayToHexString)(r)})},rX=({ciphertextBuf:e,encappedKeyBuf:t,receiverPriv:r})=>{try{let i,n,o=rG((0,rj.uint8ArrayFromHexString)(r),!1),s=r1(t,o),a=r9(t,r),l=it(t,(0,rj.uint8ArrayToHexString)(o));i=r5(rV,a,rR),n=r6(rL,l,rR,32);let u=r4(new Uint8Array([]),i,n,32);i=r5(r_,new Uint8Array([]),rH),n=rM;let c=r4(u,i,n,32);n=rF;let f=r4(u,i,n,12);return ie(e,c,f,s)}catch(e){throw Error(`Unable to perform hpkeDecrypt: ${e} `)}},r0=()=>{let e=(0,eC.randomBytes)(32),t=rG(e,!0),r=(0,rj.uint8ArrayToHexString)(r3(t));return{privateKey:(0,rj.uint8ArrayToHexString)(e),publicKey:(0,rj.uint8ArrayToHexString)(t),publicKeyUncompressed:r}},r1=(e,t)=>new Uint8Array([...Array.from(e),...Array.from(t)]),r2=e=>e.slice(36,68),r8=e=>{let t=e.byteLength;var r=e.slice(0,1+t>>>1);return r[0]=2|1&e[t-1],r},r3=(e,t="CURVE_P256")=>{let r,i,n;if(33!==e.length)throw Error("failed to uncompress raw public key: invalid length");if(2!==e[0]&&3!==e[0])throw Error("failed to uncompress raw public key: invalid prefix");let o=3===e[0],s=BigInt("0x"+(0,rj.uint8ArrayToHexString)(e.subarray(1)));"CURVE_P256"===t?(r=BigInt("115792089210356248762697446949407573530086143415290314195533631308867097853951"),n=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),i=r-BigInt(3)):(r=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),i=BigInt(0),n=BigInt(7));let a=((e,t)=>{if(t<=BigInt(0))throw Error("p must be positive");let r=e%t;if(rP(t,0)&&rP(t,1)){let e=((e,t,r)=>{if(t===BigInt(0))return BigInt(1);let i=e%r,n=t.toString(2);for(let t=1;t<n.length;++t)i=i*i%r,"1"===n[t]&&(i=i*e%r);return i})(r,t+BigInt(1)>>BigInt(2),t);if(e*e%t!==r)throw Error("could not find a modular square root");return e}throw Error("unsupported modulus value")})(((s*s+i)*s+n)%r,r);if(o!==rP(a,0)&&(a=(r-a)%r),s<BigInt(0)||s>=r)throw Error("x is out of range");if(a<BigInt(0)||a>=r)throw Error("y is out of range");var l="04"+ir(s,64)+ir(a,64);return(0,rj.uint8ArrayFromHexString)(l)},r5=(e,t,r)=>{let i=new Uint8Array(rD.length+r.length+e.length+t.length),n=0;return i.set(rD,n),n+=rD.length,i.set(r,n),n+=r.length,i.set(e,n),n+=e.length,i.set(t,n),i},r6=(e,t,r,i)=>{let n=new Uint8Array(9+r.byteLength+e.byteLength+t.byteLength);return n.set(new Uint8Array([0,i]),0),n.set(rD,2),n.set(r,9),n.set(e,9+r.byteLength),n.set(t,9+r.byteLength+e.byteLength),n},r4=(e,t,r,i)=>{var n,o;let s=(n=tG.sha256,o=e,(0,eC.ahash)(n),void 0===o&&(o=new Uint8Array(n.outputLen)),(0,ek.hmac)(n,(0,eC.toBytes)(o),(0,eC.toBytes)(t))),a=function(e,t,r,i=32){(0,eC.ahash)(e),(0,eC.anumber)(i);let n=e.outputLen;if(i>255*n)throw Error("Length should be <= 255*HashLen");let o=Math.ceil(i/n);void 0===r&&(r=tW);let s=new Uint8Array(o*n),a=ek.hmac.create(e,t),l=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let e=0;e<o;e++)tK[0]=e+1,l.update(0===e?tW:u).update(r).update(tK).digestInto(u),s.set(u,n*e),a._cloneInto(l);return a.destroy(),l.destroy(),(0,eC.clean)(u,tK),s.slice(0,i)}(tG.sha256,s,r,i);return new Uint8Array(a)},r9=(e,t)=>t_.getSharedSecret((0,rj.uint8ArrayFromHexString)(t),e).slice(1),r7=(e,t,r,i)=>rA(t,r,i).encrypt(e),ie=(e,t,r,i)=>rA(t,r,i).decrypt(e),it=(e,t)=>{let r=new Uint8Array(e),i=(0,rj.uint8ArrayFromHexString)(t),n=new Uint8Array(r.length+i.length);return n.set(r),n.set(i,r.length),n},ir=(e,t)=>{let r=e.toString(16);if(r.length>t)throw Error(`number cannot fit in a hex string of ${t} characters`);return r.padStart(t,"0")},ii=e=>{let t=(0,rj.uint8ArrayFromHexString)(e);if(t.length<2)throw Error("failed to convert DER-encoded signature: insufficient length");if(48!==t[0])throw Error("failed to convert DER-encoded signature: invalid format (missing SEQUENCE tag)");let r=1,i=t[1];if(i<=127){if(t.length<2+i)throw Error("failed to convert DER-encoded signature: inconsistent message length header");r+=1}else throw Error("failed to convert DER-encoded signature: unexpectedly large or invalid signature length");if(2!==t[r])throw Error("failed to convert DER-encoded signature: invalid tag for r");let n=t[++r];if(n>33)throw Error("failed to convert DER-encoded signature: unexpected length for r");r++;let o=t.slice(r,r+n);if(2!==t[r+=n])throw Error("failed to convert DER-encoded signature: invalid tag for s");let s=t[++r];if(s>33)throw Error("failed to convert DER-encoded signature: unexpected length for s");r++;let a=t.slice(r,r+s);return new Uint8Array([...(0,rj.normalizePadding)(o,32),...(0,rj.normalizePadding)(a,32)])},io=e=>{let t=(0,rj.uint8ArrayFromHexString)(e),r=t.slice(0,32),i=t.slice(32,64),n=e=>{if(void 0===e||0===e.length||void 0===e[0])throw Error("Invalid integer: input is undefined or empty.");let t=128&e[0]?new Uint8Array([0,...e]):e;return new Uint8Array([2,t.length,...t])},o=n(r),s=n(i),a=new Uint8Array([48,o.length+s.length,...o,...s]);return(0,rj.uint8ArrayToHexString)(a)};async function is(e,t,r){let i=t_.getSharedSecret(t,r,!1).slice(1,33),n=new Uint8Array(e.length+r.length+i.length);n.set(e,0),n.set(r,e.length),n.set(i,e.length+r.length);let o=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:"SHA-512"},!1,["sign"]),s=new Uint8Array(await crypto.subtle.sign("HMAC",o,r$)).slice(0,32);return crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["encrypt"])}e.s(["buildAdditionalAssociatedData",()=>r1,"compressRawPublicKey",()=>r8,"extractPrivateKeyFromPKCS8Bytes",()=>r2,"formatHpkeBuf",()=>rQ,"fromDerSignature",()=>ii,"generateP256KeyPair",()=>r0,"getPublicKey",()=>rG,"hpkeAuthEncrypt",()=>rJ,"hpkeDecrypt",()=>rX,"hpkeEncrypt",()=>rZ,"quorumKeyEncrypt",()=>rY,"toDerSignature",()=>io,"uncompressRawPublicKey",()=>r3],356026);var ia=e.i(378831),il=e.i(59297);let iu=BigInt(0),ic=BigInt(1),ih=BigInt(2),ip=BigInt(8),id={zip215:!0},iy=(BigInt(0),BigInt(1),BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949")),ig=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),iv=BigInt(0),im=BigInt(1),ib=BigInt(2),iw=BigInt(3),iA=BigInt(5),iS=BigInt(8);function iB(e,t){var r;let i,n,o,s,a,l,u,c,f,h,p,d,y,g,v=e9(t*t*t,iy),m=(r=e*e9(v*v*t,iy),i=BigInt(10),n=BigInt(20),o=BigInt(40),s=BigInt(80),l=e7(a=r*r%iy*r%iy,ib,iy)*a%iy,u=e7(l,im,iy)*r%iy,c=e7(u,iA,iy)*u%iy,f=e7(c,i,iy)*c%iy,h=e7(f,n,iy)*f%iy,p=e7(h,o,iy)*h%iy,d=e7(p,s,iy)*p%iy,y=e7(d,s,iy)*p%iy,g=e7(y,i,iy)*c%iy,{pow_p_5_8:e7(g,ib,iy)*r%iy,b2:a}).pow_p_5_8,b=e9(e*v*m,iy),w=e9(t*b*b,iy),A=b,S=e9(b*ig,iy),B=w===e,x=w===e9(-e,iy),E=w===e9(-e*ig,iy);return B&&(b=A),(x||E)&&(b=S),tt(b,iy)&&(b=e9(-b,iy)),{isValid:B||x,value:b}}let ix=ta(iy,void 0,!0),iE=function(e){let t,r=(t=tA(e),eX(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})),{Fp:i,n:n,prehash:o,hash:s,randomBytes:a,nByteLength:l,h:u}=r,c=ih<<BigInt(8*l)-ic,f=i.create,h=ta(r.n,r.nBitLength),p=r.uvRatio||((e,t)=>{try{return{isValid:!0,value:i.sqrt(e*i.inv(t))}}catch(e){return{isValid:!1,value:iu}}}),d=r.adjustScalarBytes||(e=>e),y=r.domain||((e,t,r)=>{if(eU("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function g(e,t,r=!1){eZ("coordinate "+e,t,r?ic:iu,c)}function v(e){if(!(e instanceof w))throw Error("ExtendedPoint expected")}let m=e0((e,t)=>{let{ex:r,ey:n,ez:o}=e,s=e.is0();null==t&&(t=s?ip:i.inv(o));let a=f(r*t),l=f(n*t),u=f(o*t);if(s)return{x:iu,y:ic};if(u!==ic)throw Error("invZ was invalid");return{x:a,y:l}}),b=e0(e=>{let{a:t,d:i}=r;if(e.is0())throw Error("bad point: ZERO");let{ex:n,ey:o,ez:s,et:a}=e,l=f(n*n),u=f(o*o),c=f(s*s),h=f(c*c),p=f(l*t);if(f(c*f(p+u))!==f(h+f(i*f(l*u))))throw Error("bad point: equation left != right (1)");if(f(n*o)!==f(s*a))throw Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,i){g("x",e),g("y",t),g("z",r,!0),g("t",i),this.ex=e,this.ey=t,this.ez=r,this.et=i,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw Error("extended point not allowed");let{x:t,y:r}=e||{};return g("x",t),g("y",r),new w(t,r,ic,f(t*r))}static normalizeZ(e){let t=tn(i,e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(w.fromAffine)}static msm(e,t){return tw(w,h,e,t)}_setWindowSize(e){B.setWindowSize(this,e)}assertValidity(){b(this)}equals(e){v(e);let{ex:t,ey:r,ez:i}=this,{ex:n,ey:o,ez:s}=e,a=f(t*s),l=f(n*i),u=f(r*s),c=f(o*i);return a===l&&u===c}is0(){return this.equals(w.ZERO)}negate(){return new w(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:e}=r,{ex:t,ey:i,ez:n}=this,o=f(t*t),s=f(i*i),a=f(ih*f(n*n)),l=f(e*o),u=t+i,c=f(f(u*u)-o-s),h=l+s,p=h-a,d=l-s,y=f(c*p),g=f(h*d),v=f(c*d);return new w(y,g,f(p*h),v)}add(e){v(e);let{a:t,d:i}=r,{ex:n,ey:o,ez:s,et:a}=this,{ex:l,ey:u,ez:c,et:h}=e,p=f(n*l),d=f(o*u),y=f(a*i*h),g=f(s*c),m=f((n+o)*(l+u)-p-d),b=g-y,A=g+y,S=f(d-t*p),B=f(m*b),x=f(A*S),E=f(m*S);return new w(B,x,f(b*A),E)}subtract(e){return this.add(e.negate())}wNAF(e){return B.wNAFCached(this,e,w.normalizeZ)}multiply(e){eZ("scalar",e,ic,n);let{p:t,f:r}=this.wNAF(e);return w.normalizeZ([t,r])[0]}multiplyUnsafe(e,t=w.ZERO){return(eZ("scalar",e,iu,n),e===iu)?S:this.is0()||e===ic?this:B.wNAFCachedUnsafe(this,e,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return B.unsafeLadder(this,n).is0()}toAffine(e){return m(this,e)}clearCofactor(){let{h:e}=r;return e===ic?this:this.multiplyUnsafe(e)}static fromHex(e,t=!1){let{d:n,a:o}=r,s=i.BYTES;e=ez("pointHex",e,s),eU("zip215",t);let a=e.slice(),l=e[s-1];a[s-1]=-129&l;let u=eM(a);eZ("pointHex.y",u,iu,t?c:i.ORDER);let h=f(u*u),{isValid:d,value:y}=p(f(h-ic),f(n*h-o));if(!d)throw Error("Point.fromHex: invalid y coordinate");let g=(y&ic)===ic,v=(128&l)!=0;if(!t&&y===iu&&v)throw Error("Point.fromHex: x=0 and x_0=1");return v!==g&&(y=f(-y)),w.fromAffine({x:y,y:u})}static fromPrivateKey(e){let{scalar:t}=x(e);return A.multiply(t)}toRawBytes(){let{x:e,y:t}=this.toAffine(),r=e$(t,i.BYTES);return r[r.length-1]|=e&ic?128:0,r}toHex(){return eD(this.toRawBytes())}}w.BASE=new w(r.Gx,r.Gy,ic,f(r.Gx*r.Gy)),w.ZERO=new w(iu,ic,ic,iu);let{BASE:A,ZERO:S}=w,B=tb(w,8*l);function x(e){let t=i.BYTES;e=ez("private key",e,t);let r=ez("hashed private key",s(e),2*t),o=d(r.slice(0,t)),a=r.slice(t,2*t),l=e9(eM(o),n);return{head:o,prefix:a,scalar:l}}function E(e){let{head:t,prefix:r,scalar:i}=x(e),n=A.multiply(i),o=n.toRawBytes();return{head:t,prefix:r,scalar:i,point:n,pointBytes:o}}function k(e=Uint8Array.of(),...t){return e9(eM(s(y(eq(...t),ez("context",e),!!o))),n)}return A._setWindowSize(8),{CURVE:r,getPublicKey:function(e){return E(e).pointBytes},sign:function(e,t,r={}){e=ez("message",e),o&&(e=o(e));let{prefix:s,scalar:a,pointBytes:l}=E(t),u=k(r.context,s,e),c=A.multiply(u).toRawBytes(),f=e9(u+k(r.context,c,l,e)*a,n);return eZ("signature.s",f,iu,n),ez("result",eq(c,e$(f,i.BYTES)),2*i.BYTES)},verify:function(e,t,r,n=id){let s,a,l,{context:u,zip215:c}=n,f=i.BYTES;e=ez("signature",e,2*f),t=ez("message",t),r=ez("publicKey",r,f),void 0!==c&&eU("zip215",c),o&&(t=o(t));let h=eM(e.slice(f,2*f));try{s=w.fromHex(r,c),a=w.fromHex(e.slice(0,f),c),l=A.multiplyUnsafe(h)}catch(e){return!1}if(!c&&s.isSmallOrder())return!1;let p=k(u,a.toRawBytes(),s.toRawBytes(),t);return a.add(s.multiplyUnsafe(p)).subtract(l).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:E,randomPrivateKey:()=>a(i.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:ix.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ix,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:iS,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:eE.sha512,randomBytes:eC.randomBytes,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:iB}),ik=(ix.ORDER+iw)/iS,iC=ix.pow(ib,ik),iO=ix.sqrt(ix.neg(ix.ONE)),iI=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}(ix,ix.neg(BigInt(486664)));tP(iE.ExtendedPoint,e=>(function(e){let t,r,i,n,o,s,a,l,u,c,f,h,p,d,y,g,v,m,b,w,A,S,B,{xMn:x,xMd:E,yMn:k,yMd:C}=(t=(ix.ORDER-iA)/iS,r=BigInt(486662),i=ix.sqr(e),i=ix.mul(i,ib),n=ix.add(i,ix.ONE),o=ix.neg(r),s=ix.sqr(n),a=ix.mul(s,n),l=ix.mul(i,r),l=ix.mul(l,o),l=ix.add(l,s),l=ix.mul(l,o),u=ix.sqr(a),s=ix.sqr(u),u=ix.mul(u,a),u=ix.mul(u,l),s=ix.mul(s,u),c=ix.pow(s,t),c=ix.mul(c,u),f=ix.mul(c,iO),s=ix.sqr(c),s=ix.mul(s,a),h=ix.eql(s,l),p=ix.cmov(f,c,h),d=ix.mul(o,i),y=ix.mul(c,e),y=ix.mul(y,iC),g=ix.mul(y,iO),v=ix.mul(l,i),s=ix.sqr(y),s=ix.mul(s,a),m=ix.eql(s,v),b=ix.cmov(g,y,m),s=ix.sqr(p),s=ix.mul(s,a),w=ix.eql(s,l),A=ix.cmov(d,o,w),S=ix.cmov(b,p,w),B=ix.isOdd(S),{xMn:A,xMd:n,yMn:S=ix.cmov(S,ix.neg(S),w!==B),yMd:im}),O=ix.mul(x,C);O=ix.mul(O,iI);let I=ix.mul(E,k),N=ix.sub(x,E),T=ix.add(x,E),U=ix.mul(I,T),j=ix.eql(U,ix.ZERO);O=ix.cmov(O,ix.ZERO,j),I=ix.cmov(I,ix.ONE,j),N=ix.cmov(N,ix.ONE,j),T=ix.cmov(T,ix.ONE,j);let[P,R]=tn(ix,[I,T],!0);return{x:ix.mul(O,P),y:ix.mul(N,R)}})(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:ix.ORDER,m:1,k:128,expand:"xmd",hash:eE.sha512});(r=w||(w={})).NOTARIZER="notarizer",r.SIGNER="signer",r.EVM_PARSER="evm-parser",r.TLS_FETCHER="tls-fetcher",r.UMP="ump";let iN=(e,t)=>{try{let r=ia.bs58check.decode(e);if(r.byteLength<=33)throw Error(`Bundle size ${r.byteLength} is too low. Expecting a compressed public key (33 bytes) and an encrypted credential.`);let i=r.slice(0,33),n=r.slice(33),o=r3(i),s=rX({ciphertextBuf:n,encappedKeyBuf:o,receiverPriv:t});return(0,rj.uint8ArrayToHexString)(s)}catch(e){throw Error(`"Error decrypting bundle:", ${e}`)}},iT=async({exportBundle:e,embeddedKey:t,organizationId:r,dangerouslyOverrideSignerPublicKey:i,keyFormat:n,returnMnemonic:o})=>{try{let s=JSON.parse(e);if(!await ij(s.enclaveQuorumPublic,s.dataSignature,s.data,i))throw Error(`failed to verify enclave signature: ${s}`);let a=JSON.parse(new TextDecoder().decode((0,rj.uint8ArrayFromHexString)(s.data)));if(!a.organizationId||a.organizationId!==r)throw Error(`organization id does not match expected value. Expected: ${r}. Found: ${a.organizationId}.`);if(!a.encappedPublic)throw Error('missing "encappedPublic" in bundle signed data');let l=(0,rj.uint8ArrayFromHexString)(a.encappedPublic),u=(0,rj.uint8ArrayFromHexString)(a.ciphertext),c=rX({ciphertextBuf:u,encappedKeyBuf:l,receiverPriv:t});if("SOLANA"===n&&!o){if(32!==c.length)throw Error(`invalid private key length. Expected 32 bytes. Got ${c.length}.`);let e=iE.getPublicKey(c);if(32!==e.length)throw Error(`invalid public key length. Expected 32 bytes. Got ${e.length}.`);let t=new Uint8Array(64);return t.set(c,0),t.set(e,32),il.bs58.encode(t)}let f=(0,rj.uint8ArrayToHexString)(c);return o?(0,rj.hexToAscii)(f):f}catch(e){throw Error(`Error decrypting bundle: ${e}`)}},iU=async(e,t,r)=>{let i=iP((0,rj.uint8ArrayFromHexString)(e));if(!i)throw Error("failed to load public key");let n=ii(t),o=new TextEncoder().encode(r),s=(0,tG.sha256)(o);return t_.verify(n,s,i.toHex())},ij=async(e,t,r,i)=>{if(e!=(i||rz))throw Error(`expected signer key ${i??rz} does not match signer key from bundle: ${e}`);let n=iP(new Uint8Array((0,rj.uint8ArrayFromHexString)(e)));if(!n)throw Error("failed to load quorum key");let o=ii(t),s=(0,rj.uint8ArrayFromHexString)(r),a=(0,tG.sha256)(s);return t_.verify(o,a,n.toHex())},iP=e=>t_.ProjectivePoint.fromHex((0,rj.uint8ArrayToHexString)(e)),iR=async({privateKey:e,keyFormat:t,importBundle:r,userId:i,organizationId:n,dangerouslyOverrideSignerPublicKey:o})=>{let s=JSON.parse(r),a=((e,t)=>{switch(t){case"SOLANA":let r=il.bs58.decode(e);if(64!==r.length)throw Error(`invalid key length. Expected 64 bytes. Got ${r.length}.`);return r.subarray(0,32);case"HEXADECIMAL":if(e.startsWith("0x"))return(0,rj.uint8ArrayFromHexString)(e.slice(2));return(0,rj.uint8ArrayFromHexString)(e);default:if(console.warn(`invalid key format: ${t}. Defaulting to HEXADECIMAL.`),e.startsWith("0x"))return(0,rj.uint8ArrayFromHexString)(e.slice(2));return(0,rj.uint8ArrayFromHexString)(e)}})(e,t);if(!await ij(s.enclaveQuorumPublic,s.dataSignature,s.data,o))throw Error(`failed to verify enclave signature: ${r}`);let l=JSON.parse(new TextDecoder().decode((0,rj.uint8ArrayFromHexString)(s.data)));if(!l.organizationId||l.organizationId!==n)throw Error(`organization id does not match expected value. Expected: ${n}. Found: ${l.organizationId}.`);if(!l.userId||l.userId!==i)throw Error(`user id does not match expected value. Expected: ${i}. Found: ${l.userId}.`);if(!l.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return rQ(rZ({plainTextBuf:a,targetKeyBuf:(0,rj.uint8ArrayFromHexString)(l.targetPublic)}))},iH=async({mnemonic:e,importBundle:t,userId:r,organizationId:i,dangerouslyOverrideSignerPublicKey:n})=>{let o=JSON.parse(t),s=new TextEncoder().encode(e);if(!await ij(o.enclaveQuorumPublic,o.dataSignature,o.data,n))throw Error(`failed to verify enclave signature: ${t}`);let a=JSON.parse(new TextDecoder().decode((0,rj.uint8ArrayFromHexString)(o.data)));if(!a.organizationId||a.organizationId!==i)throw Error(`organization id does not match expected value. Expected: ${i}. Found: ${a.organizationId}.`);if(!a.userId||a.userId!==r)throw Error(`user id does not match expected value. Expected: ${r}. Found: ${a.userId}.`);if(!a.targetPublic)throw Error('missing "targetPublic" in bundle signed data');return rQ(rZ({plainTextBuf:s,targetKeyBuf:(0,rj.uint8ArrayFromHexString)(a.targetPublic)}))},iD=async(e,t)=>{let r,[i,n,o]=e.split(".");if(!o)throw Error("invalid JWT: need 3 parts");let s=`${i}.${n}`,a=(0,tG.sha256)(new TextEncoder().encode(s)),l=(0,tG.sha256)(a),u=Uint8Array.from(atob((r=(r=o).replace(/-/g,"+").replace(/_/g,"/")).padEnd(r.length+(4-r.length%4)%4,"=")).split("").map(e=>e.charCodeAt(0))),c=(0,rj.uint8ArrayFromHexString)(t??"04d498aa87ac3bf982ac2b5dd9604d0074905cfbda5d62727c5a237b895e6749205e9f7cd566909c4387f6ca25c308445c60884b788560b785f4a96ac33702a469");return t_.verify(u,l,c)},i_=async(e,t)=>await rY((0,rj.uint8ArrayFromHexString)(e),new TextEncoder().encode(t)),iV=async(e,t)=>(0,rj.uint8ArrayToHexString)(await i_(t??"045e899f1fcf7d12b3c8fd997a7a43bb853dd4e8d63419a8f867c70aacc1c4cf9d04848baca41f0c85ffbbd23cbf78967501cd8eca9e4a6369370a9a38f70d13c0",e)),iL=(e,t)=>ia.bs58check.encode(rZ({plainTextBuf:new TextEncoder().encode(e),targetKeyBuf:r3((0,rj.uint8ArrayFromHexString)(t??"02336ebd7e929ef64b87c776b72540255b4c7b41579a24b1e68fb060daa873f9f6"))}));e.s(["Enclave",()=>w,"decryptCredentialBundle",()=>iN,"decryptExportBundle",()=>iT,"encryptOauth2ClientSecret",()=>iV,"encryptOnRampSecret",()=>iL,"encryptPrivateKeyToBundle",()=>iR,"encryptToEnclave",()=>i_,"encryptWalletToBundle",()=>iH,"verifySessionJwtSignature",()=>iD,"verifyStampSignature",()=>iU],784503);var iM=e.i(649347);e.i(964495);var iF=e.i(630376);function i$(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function iz(e,t,r=-1){let i=e,n=0,o=Math.pow(2,t);for(let s=1;s<8;s++){if(e<o){let e;if(r<0)e=new ArrayBuffer(s),n=s;else{if(r<s)return new ArrayBuffer(0);e=new ArrayBuffer(r),n=r}let o=new Uint8Array(e);for(let e=s-1;e>=0;e--){let r=Math.pow(2,e*t);o[n-e-1]=Math.floor(i/r),i-=o[n-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function iq(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new Uint8Array(new ArrayBuffer(t));for(let t of e)i.set(t,r),r+=t.length;return i}function iK(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let e=0;e<this.valueHex.byteLength;e++)t[e]=0;t[0]=128&e[0];let r=i$(t,8),i=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let t=0;t<this.valueHex.byteLength;t++)i[t]=e[t];return i[0]&=127,i$(i,8)-r}function iW(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,n=Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}function iG(){if("u"<typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function iZ(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function iJ(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class iY{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return iZ(this.items)}}let iQ=[new Uint8Array([1])],iX="0123456789",i0="name",i1="valueHexView",i2=new ArrayBuffer(0),i8=new Uint8Array(0),i3="EndOfContent",i5="OCTET STRING",i6="BIT STRING";function i4(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!=(t=r.isHexOnly)&&t,this.valueHexView=r.valueHex?iF.BufferSourceConverter.toUint8Array(r.valueHex):i8}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!iJ(this,i,t,r))return -1;let n=t+r;return(this.valueHexView=i.subarray(t,n),this.valueHexView.length)?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",i2)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:iF.Convert.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class i9{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=i8}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=iF.BufferSourceConverter.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:iF.Convert.ToHex(this.valueBeforeDecodeView)}}}i9.NAME="baseBlock";class i7 extends i9{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}i7.NAME="valueBlock";class ne extends i4(i9){constructor({idBlock:e={}}={}){var t,r,i,n;super(),e?(this.isHexOnly=null!=(t=e.isHexOnly)&&t,this.valueHexView=e.valueHex?iF.BufferSourceConverter.toUint8Array(e.valueHex):i8,this.tagClass=null!=(r=e.tagClass)?r:-1,this.tagNumber=null!=(i=e.tagNumber)?i:-1,this.isConstructed=null!=(n=e.isConstructed)&&n):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",i2}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=iz(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,o=new Uint8Array(n+1);if(o[0]=31|t,!e){for(let e=0;e<n-1;e++)o[e+1]=128|i[e];o[n]=i[n-1]}return o.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&n[0])==32,this.isHexOnly=!1;let o=31&n[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&n[e];){if(t[e-1]=127&n[e],++e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){let e=new Uint8Array(r+=255);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&n[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=i$(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}ne.NAME="identificationBlock";class nt extends i9{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!=(t=e.isIndefiniteForm)&&t,this.longFormUsed=null!=(r=e.longFormUsed)&&r,this.length=null!=(i=e.length)?i:0}fromBER(e,t,r){let i=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;let o=127&n[0];if(o>8)return this.error="Too big integer",-1;if(o+1>n.length)return this.error="End of input reached before message was fully decoded",-1;let s=t+1,a=i.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=i$(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=iz(this.length,8);if(i.byteLength>127)return this.error="Too big length",i2;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let n=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}nt.NAME="lengthBlock";let nr={};class ni extends i9{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new ne(i),this.lenBlock=new nt(i),this.valueBlock=n?new n(i):new i7(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new iY;t||function e(t){var r;if(t instanceof nr.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(null==(r=t.lenBlock)?void 0:r.isIndefiniteForm)}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?i2:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():iF.Convert.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,t=iF.Convert.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),r=e.toBER();if(t.byteLength!==r.byteLength)return!1;let i=new Uint8Array(t),n=new Uint8Array(r);for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}}ni.NAME="BaseBlock";class nn extends ni{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}nn.NAME="BaseStringBlock";class no extends i4(i7){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}no.NAME="PrimitiveValueBlock";class ns extends ni{constructor(e={}){super(e,no),this.idBlock.isConstructed=!1}}function na(e,t=0,r=e.length){let i=t,n=new ni({},i7),o=new i9;if(!iJ(o,e,t,r))return n.error=o.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let s=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===s)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=s,r-=n.idBlock.blockLength,s=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===s)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=s,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=ni;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=nr.EndOfContent;break;case 1:a=nr.Boolean;break;case 2:a=nr.Integer;break;case 3:a=nr.BitString;break;case 4:a=nr.OctetString;break;case 5:a=nr.Null;break;case 6:a=nr.ObjectIdentifier;break;case 10:a=nr.Enumerated;break;case 12:a=nr.Utf8String;break;case 13:a=nr.RelativeObjectIdentifier;break;case 14:a=nr.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=nr.Sequence;break;case 17:a=nr.Set;break;case 18:a=nr.NumericString;break;case 19:a=nr.PrintableString;break;case 20:a=nr.TeletexString;break;case 21:a=nr.VideotexString;break;case 22:a=nr.IA5String;break;case 23:a=nr.UTCTime;break;case 24:a=nr.GeneralizedTime;break;case 25:a=nr.GraphicString;break;case 26:a=nr.VisibleString;break;case 27:a=nr.GeneralString;break;case 28:a=nr.UniversalString;break;case 29:a=nr.CharacterString;break;case 30:a=nr.BmpString;break;case 31:a=nr.DATE;break;case 32:a=nr.TimeOfDay;break;case 33:a=nr.DateTime;break;case 34:a=nr.Duration;break;default:{let e=n.idBlock.isConstructed?new nr.Constructed:new nr.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?nr.Constructed:nr.Primitive;return s=(n=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a)).fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:s,result:n}}function nl(e){if(!e.byteLength){let e=new ni({},i7);return e.error="Input buffer has zero length",{offset:-1,result:e}}return na(iF.BufferSourceConverter.toUint8Array(e).slice(),0,e.byteLength)}nr.Primitive=ns,ns.NAME="PRIMITIVE";class nu extends i7{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,n;let o=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,o,t,r))return -1;if(this.valueBeforeDecodeView=o.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;i=this.isIndefiniteForm,n=r,(i?1:n)>0;){let e=na(o,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===i3)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===i3?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){let r=t||new iY;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?i2:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}nu.NAME="ConstructedValueBlock";class nc extends ni{constructor(e={}){super(e,nu),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}nr.Constructed=nc,nc.NAME="CONSTRUCTED";class nf extends i7{fromBER(e,t,r){return t}toBER(e){return i2}}nf.override="EndOfContentValueBlock";class nh extends ni{constructor(e={}){super(e,nf),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}nr.EndOfContent=nh,nh.NAME=i3;class np extends ni{constructor(e={}){super(e,i7),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}nr.Null=np,np.NAME="NULL";class nd extends i4(i7){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=255*!!e}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=iF.BufferSourceConverter.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){let i=iF.BufferSourceConverter.toUint8Array(e);return iJ(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,iK.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}nd.NAME="BooleanValueBlock";class ny extends ni{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,nd),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}nr.Boolean=ny,ny.NAME="BOOLEAN";class ng extends i4(nu){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=nu.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===i3)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;else break;if(t!==i5)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?nu.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}ng.NAME="OctetStringValueBlock";class nv extends ni{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},ng),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=na(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return nc.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,t=iF.Convert.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof A&&e.push(t.valueBlock.valueHexView);return iF.BufferSourceConverter.concat(e)}}nr.OctetString=A=nv,nv.NAME=i5;class nm extends i4(nu){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=nu.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===i3)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;else break;if(t!==i6)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let n=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,n,t,r))return -1;let o=n.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=o.subarray(1);try{if(e.byteLength){let t=na(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return nu.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength){let e=new Uint8Array(1);return e[0]=0,e.buffer}let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}nm.NAME="BitStringValueBlock";class nb extends ni{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},nm),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return nc.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join(""),r=this.constructor.NAME,i=t.substring(0,t.length-this.valueBlock.unusedBits);return`${r} : ${i}`}}}function nw(e){if(e>=iQ.length)for(let t=iQ.length;t<=e;t++){let e=new Uint8Array([0]),r=iQ[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=iq(e,r)),iQ.push(r)}return iQ[e]}nr.BitString=nb,nb.NAME=i6;class nA extends i4(i7){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=iK.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=iz(r-t,8,i),n=new Uint8Array(e);return n[0]|=128,e}let n=iz(t,8,i),o=new Uint8Array(n);if(128&o[0]){let e=n.slice(0),t=new Uint8Array(e);o=new Uint8Array(n=new ArrayBuffer(n.byteLength+1));for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return n}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let n=this.fromBER(e,t,r);if(-1===n)return n;let o=this.valueHexView;return 0===o[0]&&(128&o[1])!=0?this.valueHexView=o.subarray(1):0!==i&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),n}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e,t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,n=this.valueHexView,o="",s=!1;for(let s=n.byteLength-1;s>=0;s--){e=n[s];for(let n=0;n<8;n++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,n=new Uint8Array(e),o=new Uint8Array(t),s=n.slice(0),a=s.length-1,l=o.slice(0),u=l.length-1,c=0;for(let e=u;e>=0;e--,c++)!0==(r=s[a-c]-l[u-c]-i)<0?(i=1,s[a-c]=r+10):(i=0,s[a-c]=r);if(i>0)for(let e=a-u+1;e>=0;e--,c++)if((r=s[a-c]-i)<0)i=1,s[a-c]=r+10;else{i=0,s[a-c]=r;break}return s.slice()}(nw(i),r),o="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t),o=i.slice(0),s=o.length-1,a=n.slice(0),l=a.length-1,u=0,c=l<s?s:l,f=0;for(let e=c;e>=0;e--,f++)u=!0==f<a.length?o[s-f]+a[l-f]+r[0]:o[s-f]+r[0],r[0]=u/10,!0==f>=o.length?o=iq(new Uint8Array([u%10]),o):o[s-f]=u%10;return r[0]>0&&(o=iq(r,o)),o}(r,nw(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(s=!0),s&&(o+=iX.charAt(r[e]));return!1===s&&(o+=iX.charAt(0)),o}}nA.NAME="IntegerValueBlock",Object.defineProperty(nA.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class nS extends ni{constructor(e={}){super(e,nA),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return iG(),BigInt(this.valueBlock.toString())}static fromBigInt(e){iG();let t=BigInt(e),r=new iY,i=t.toString(16).replace(/^-/,""),n=new Uint8Array(iF.Convert.FromHex(i));if(t<0){let e=new Uint8Array(n.length+(128&n[0]?1:0));e[0]|=128;let i=BigInt(`0x${iF.Convert.ToHex(e)}`)+t,o=iF.BufferSourceConverter.toUint8Array(iF.Convert.FromHex(i.toString(16)));o[0]|=128,r.write(o)}else 128&n[0]&&r.write(new Uint8Array([0])),r.write(n);return new S({valueHex:r.final()})}convertToDER(){let e=new S({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new S({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}nr.Integer=S=nS,nS.NAME="INTEGER";class nB extends nS{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}nr.Enumerated=nB,nB.NAME="ENUMERATED";class nx extends i4(i7){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=i$(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){iG();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+128*(e+1<r.length);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=iz(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",i2;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=iF.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}nx.NAME="sidBlock";class nE extends i7{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new nx;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,i2;t.push(i)}return iZ(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,n){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{let e=new nx;if(i>Number.MAX_SAFE_INTEGER)iG(),e.valueBigInt=BigInt(i);else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}nE.NAME="ObjectIdentifierValueBlock";class nk extends ni{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,nE),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}nr.ObjectIdentifier=nk,nk.NAME="OBJECT IDENTIFIER";class nC extends i4(i9){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=iF.BufferSourceConverter.toUint8Array(e);if(!iJ(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=i$(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=iz(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",i2;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?iF.Convert.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}nC.NAME="relativeSidBlock";class nO extends i7{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new nC;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,i2;r.push(i)}return iZ(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let n=new nC;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))break;this.value.push(n)}while(-1!==r)return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}nO.NAME="RelativeObjectIdentifierValueBlock";class nI extends ni{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,nO),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}nr.RelativeObjectIdentifier=nI,nI.NAME="RelativeObjectIdentifier";class nN extends nc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}nr.Sequence=nN,nN.NAME="SEQUENCE";class nT extends nc{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}nr.Set=nT,nT.NAME="SET";class nU extends i4(i7){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}nU.NAME="StringValueBlock";class nj extends nU{}nj.NAME="SimpleStringValueBlock";class nP extends nn{constructor({...e}={}){super(e,nj)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,iF.BufferSourceConverter.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}nP.NAME="SIMPLE STRING";class nR extends nP{fromBuffer(e){this.valueBlock.valueHexView=iF.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=iF.Convert.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=iF.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(iF.Convert.FromUtf8String(e)),this.valueBlock.value=e}}nR.NAME="Utf8StringValueBlock";class nH extends nR{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}nr.Utf8String=nH,nH.NAME="UTF8String";class nD extends nP{fromBuffer(e){this.valueBlock.value=iF.Convert.ToUtf16String(e),this.valueBlock.valueHexView=iF.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(iF.Convert.FromUtf16String(e))}}nD.NAME="BmpStringValueBlock";class n_ extends nD{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}nr.BmpString=n_,n_.NAME="BMPString";class nV extends nP{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=new Uint8Array(iz(e.charCodeAt(i),8));if(t.length>4)continue;let n=4-t.length;for(let e=t.length-1;e>=0;e--)r[4*i+e+n]=t[e]}this.valueBlock.value=e}}nV.NAME="UniversalStringValueBlock";class nL extends nV{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}nr.UniversalString=nL,nL.NAME="UniversalString";class nM extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}nr.NumericString=nM,nM.NAME="NumericString";class nF extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}nr.PrintableString=nF,nF.NAME="PrintableString";class n$ extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}nr.TeletexString=n$,n$.NAME="TeletexString";class nz extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}nr.VideotexString=nz,nz.NAME="VideotexString";class nq extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}nr.IA5String=nq,nq.NAME="IA5String";class nK extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}nr.GraphicString=nK,nK.NAME="GraphicString";class nW extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}nr.VisibleString=nW,nW.NAME="VisibleString";class nG extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}nr.GeneralString=nG,nG.NAME="GeneralString";class nZ extends nP{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}nr.CharacterString=nZ,nZ.NAME="CharacterString";class nJ extends nW{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,iF.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=iW(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=iW(this.month,2),e[2]=iW(this.day,2),e[3]=iW(this.hour,2),e[4]=iW(this.minute,2),e[5]=iW(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}nr.UTCTime=nJ,nJ.NAME="UTCTime";class nY extends nJ{constructor(e={}){super(e),null!=this.millisecond||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",n="",o=0,s=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw Error("Wrong input string for conversion");if(s=e*n,4===r.length){if(isNaN((n=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*n}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");o=e.valueOf(),n=i.substring(0,l)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let u=t.exec(n);if(null===u)throw Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+s;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(iW(this.year,4)),e.push(iW(this.month,2)),e.push(iW(this.day,2)),e.push(iW(this.hour,2)),e.push(iW(this.minute,2)),e.push(iW(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(iW(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}nr.GeneralizedTime=nY,nY.NAME="GeneralizedTime";class nQ extends nH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}nr.DATE=nQ,nQ.NAME="DATE";class nX extends nH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}nr.TimeOfDay=nX,nX.NAME="TimeOfDay";class n0 extends nH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}nr.DateTime=n0,n0.NAME="DateTime";class n1 extends nH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}nr.Duration=n1,n1.NAME="Duration";class n2 extends nH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}nr.TIME=n2,n2.NAME="TIME";class n8{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class n3 extends n8{constructor({value:e=[],...t}={}){super(t),this.value=e}}class n5 extends n8{constructor({value:e=new n8,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class n6{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=iF.BufferSourceConverter.toUint8Array(e)}constructor({data:e=i8}={}){this.dataView=iF.BufferSourceConverter.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=iF.BufferSourceConverter.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function n4(e,t,r){if(r instanceof n3){for(let i of r.value)if(n4(e,t,i).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(i0)&&(e.name=r.name),e}}if(r instanceof n8)return r.hasOwnProperty(i0)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(i1 in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof nr.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof n5&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof n5){if(!1===(n=n4(e,t.valueBlock.value[s],r.valueBlock.value[0].value)).verified)if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(i0 in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(!1===(n=n4(e,t.valueBlock.value[s-i],r.valueBlock.value[s])).verified)if(!r.valueBlock.value[s].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(!1===n.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&i1 in t.valueBlock){let i=na(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return n4(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function n9(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=na(iF.BufferSourceConverter.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:n4(r.result,r.result,t)}e.s(["Any",()=>n8,"BaseBlock",()=>ni,"BaseStringBlock",()=>nn,"BitString",()=>nb,"BmpString",()=>n_,"Boolean",()=>ny,"CharacterString",()=>nZ,"Choice",()=>n3,"Constructed",()=>nc,"DATE",()=>nQ,"DateTime",()=>n0,"Duration",()=>n1,"EndOfContent",()=>nh,"Enumerated",()=>nB,"GeneralString",()=>nG,"GeneralizedTime",()=>nY,"GraphicString",()=>nK,"HexBlock",()=>i4,"IA5String",()=>nq,"Integer",()=>nS,"Null",()=>np,"NumericString",()=>nM,"ObjectIdentifier",()=>nk,"OctetString",()=>nv,"Primitive",()=>ns,"PrintableString",()=>nF,"RawData",()=>n6,"RelativeObjectIdentifier",()=>nI,"Repeated",()=>n5,"Sequence",()=>nN,"Set",()=>nT,"TIME",()=>n2,"TeletexString",()=>n$,"TimeOfDay",()=>nX,"UTCTime",()=>nJ,"UniversalString",()=>nL,"Utf8String",()=>nH,"ValueBlock",()=>i7,"VideotexString",()=>nz,"ViewWriter",()=>iY,"VisibleString",()=>nW,"compareSchema",()=>n4,"fromBER",()=>nl,"verifySchema",()=>n9],60922),(i=B||(B={}))[i.Sequence=0]="Sequence",i[i.Set=1]="Set",i[i.Choice=2]="Choice",(n=x||(x={}))[n.Any=1]="Any",n[n.Boolean=2]="Boolean",n[n.OctetString=3]="OctetString",n[n.BitString=4]="BitString",n[n.Integer=5]="Integer",n[n.Enumerated=6]="Enumerated",n[n.ObjectIdentifier=7]="ObjectIdentifier",n[n.Utf8String=8]="Utf8String",n[n.BmpString=9]="BmpString",n[n.UniversalString=10]="UniversalString",n[n.NumericString=11]="NumericString",n[n.PrintableString=12]="PrintableString",n[n.TeletexString=13]="TeletexString",n[n.VideotexString=14]="VideotexString",n[n.IA5String=15]="IA5String",n[n.GraphicString=16]="GraphicString",n[n.VisibleString=17]="VisibleString",n[n.GeneralString=18]="GeneralString",n[n.CharacterString=19]="CharacterString",n[n.UTCTime=20]="UTCTime",n[n.GeneralizedTime=21]="GeneralizedTime",n[n.DATE=22]="DATE",n[n.TimeOfDay=23]="TimeOfDay",n[n.DateTime=24]="DateTime",n[n.Duration=25]="Duration",n[n.TIME=26]="TIME",n[n.Null=27]="Null";class n7{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else if(iF.BufferSourceConverter.isBufferSource(e))this.unusedBits=t,this.value=iF.BufferSourceConverter.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof nb))throw TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new nb({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new nb({name:e})}toNumber(){let e="";for(let t of new Uint8Array(this.value))e+=t.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2),r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;let i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let n=0;for(;n<r;)i[n]=parseInt(t.slice(n<<3,(n<<3)+8),2),n++;this.value=i.buffer}}class oe{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):iF.BufferSourceConverter.isBufferSource(e)?this.buffer=iF.BufferSourceConverter.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof nv))throw TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new nv({valueHex:this.buffer})}toSchema(e){return new nv({name:e})}}let ot={fromASN:e=>e instanceof np?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new np;let t=nl(e);if(t.result.error)throw Error(t.result.error);return t.result}},or={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new nS({value:+e})},oi={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new nB({value:e})},on={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new nS({valueHex:e})},oo={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new nb({valueHex:e})},os={fromASN:e=>e.valueBlock.toString(),toASN:e=>new nk({value:e})},oa={fromASN:e=>e.valueBlock.value,toASN:e=>new ny({value:e})},ol={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new nv({valueHex:e})};function ou(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let oc=ou(nH),of=ou(n_),oh=ou(nL),op=ou(nM),od=ou(nF),oy=ou(n$),og=ou(nz),ov=ou(nq),om=ou(nK),ob=ou(nW),ow=ou(nG),oA=ou(nZ),oS={fromASN:e=>e.toDate(),toASN:e=>new nJ({valueDate:e})},oB={fromASN:e=>e.toDate(),toASN:e=>new nY({valueDate:e})},ox={fromASN:()=>null,toASN:()=>new np};function oE(e){switch(e){case x.Any:return ot;case x.BitString:return oo;case x.BmpString:return of;case x.Boolean:return oa;case x.CharacterString:return oA;case x.Enumerated:return oi;case x.GeneralString:return ow;case x.GeneralizedTime:return oB;case x.GraphicString:return om;case x.IA5String:return ov;case x.Integer:return or;case x.Null:return ox;case x.NumericString:return op;case x.ObjectIdentifier:return os;case x.OctetString:return ol;case x.PrintableString:return od;case x.TeletexString:return oy;case x.UTCTime:return oS;case x.UniversalString:return oh;case x.Utf8String:return oc;case x.VideotexString:return og;case x.VisibleString:return ob;default:return null}}var ok=e.i(60922);function oC(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||oC(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}let oO=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:B.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),i=[];for(let e in r.items){let n,o=r.items[e],s=t?e:"";if("number"==typeof o.type){let e=x[o.type],t=ok[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);n=new t({name:s})}else oC(o.type)?n=new o.type().toSchema(s):o.optional?this.get(o.type).type===B.Choice?n=new ok.Any({name:s}):(n=this.create(o.type,!1)).name=s:n=new ok.Any({name:s});let a=!!o.optional||void 0!==o.defaultValue;if(o.repeated&&(n.name="",n=new("set"===o.repeated?ok.Set:ok.Sequence)({name:"",value:[new ok.Repeated({name:s,value:n})]})),null!==o.context&&void 0!==o.context)if(o.implicit)if("number"==typeof o.type||oC(o.type)){let e=o.repeated?ok.Constructed:ok.Primitive;i.push(new e({name:s,optional:a,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);let e=!!o.repeated,t=e?n:this.get(o.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new ok.Constructed({name:e?"":s,optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:t}))}else i.push(new ok.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:[n]}));else n.optional=a,i.push(n)}switch(r.type){case B.Sequence:return new ok.Sequence({value:i,name:""});case B.Set:return new ok.Set({value:i,name:""});case B.Choice:return new ok.Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},oI=e=>t=>{let r;oO.has(t)?r=oO.get(t):(r=oO.createDefault(t),oO.set(t,r)),Object.assign(r,e)},oN=e=>(t,r)=>{let i;oO.has(t.constructor)?i=oO.get(t.constructor):(i=oO.createDefault(t.constructor),oO.set(t.constructor,i));let n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){let i=oE(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}n.raw=e.raw,i.items[r]=n};class oT extends Error{constructor(){super(...arguments),this.schemas=[]}}class oU{static parse(e,t){let r=ok.fromBER(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){try{if(oC(t))return new t().fromASN(e);let r=oO.get(t);oO.cache(t);let i=r.schema,n=this.handleChoiceTypes(e,r,t,i);if(null==n?void 0:n.result)return n.result;(null==n?void 0:n.targetSchema)&&(i=n.targetSchema);let o=this.handleSequenceTypes(e,r,t,i),s=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null==(r=null==i?void 0:i.prototype)?void 0:r.constructor)===Array||e(i)}return!1}(t))return this.handleArrayTypes(e,r,t);return this.processSchemaItems(r,o,s),s}catch(e){throw e instanceof oT&&e.schemas.push(t.name),e}}static handleChoiceTypes(e,t,r,i){if(e.constructor===ok.Constructed&&t.type===B.Choice&&3===e.idBlock.tagClass)for(let i in t.items){let n=t.items[i];if(n.context===e.idBlock.tagNumber&&n.implicit&&"function"==typeof n.type&&oO.has(n.type)){let t=oO.get(n.type);if(t&&t.type===B.Sequence){let t=new ok.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock){t.valueBlock.value=e.valueBlock.value;let o=this.fromASN(t,n.type),s=new r;return s[i]=o,{result:s}}}}}else if(e.constructor===ok.Constructed&&t.type!==B.Choice){let r=new ok.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:t.schema.valueBlock.value});for(let r in t.items)delete e[r];return{targetSchema:r}}return null}static handleSequenceTypes(e,t,r,i){if(t.type===B.Sequence){let t=ok.compareSchema({},e,i);if(!t.verified)throw new oT(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}{let t=ok.compareSchema({},e,i);if(!t.verified)throw new oT(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}}static processRepeatedField(e,t,r){let i=e.slice(t);if(1===i.length&&"Sequence"===i[0].constructor.name){let e=i[0];e.valueBlock&&e.valueBlock.value&&Array.isArray(e.valueBlock.value)&&(i=e.valueBlock.value)}if("number"!=typeof r.type)return i.filter(e=>e&&e.valueBlock).map(e=>{try{return this.fromASN(e,r.type)}catch{return}}).filter(e=>void 0!==e);{let e=oE(r.type);if(!e)throw Error(`No converter for ASN.1 type ${r.type}`);return i.filter(e=>e&&e.valueBlock).map(t=>{try{return e.fromASN(t)}catch{return}}).filter(e=>void 0!==e)}}static processPrimitiveField(e,t){let r=oE(t.type);if(!r)throw Error(`No converter for ASN.1 type ${t.type}`);return r.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&"function"==typeof e.type&&oO.has(e.type)&&oO.get(e.type).type===B.Choice}static processOptionalChoiceField(e,t){try{let r=this.fromASN(e,t.type);return{processed:!0,value:r}}catch(e){if(e instanceof oT&&/Wrong values for Choice type/.test(e.message))return{processed:!1};throw e}}static handleArrayTypes(e,t,r){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let i=t.itemType;if("number"!=typeof i)return r.from(e.valueBlock.value,e=>this.fromASN(e,i));{let t=oE(i);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(e.valueBlock.value,e=>t.fromASN(e))}}static processSchemaItems(e,t,r){for(let i in e.items){let n,o=t.result[i];if(!o)continue;let s=e.items[i],a=s.type;(n="number"==typeof a||oC(a)?this.processPrimitiveSchemaItem(o,s,a):this.processComplexSchemaItem(o,s,a))&&"object"==typeof n&&"value"in n&&"raw"in n?(r[i]=n.value,r[`${i}Raw`]=n.raw):r[i]=n}}static processPrimitiveSchemaItem(e,t,r){var i;let n=null!=(i=t.converter)?i:oC(r)?new r:null;if(!n)throw Error("Converter is empty");return t.repeated?this.processRepeatedPrimitiveItem(e,t,n):this.processSinglePrimitiveItem(e,t,r,n)}static processRepeatedPrimitiveItem(e,t,r){if(!t.implicit)return Array.from(e,e=>r.fromASN(e));{let i=new("sequence"===t.repeated?ok.Sequence:ok.Set);i.valueBlock=e.valueBlock;let n=ok.fromBER(i.toBER(!1));if(-1===n.offset)throw Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock&&Array.isArray(n.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");return Array.from(n.result.valueBlock.value,e=>r.fromASN(e))}}static processSinglePrimitiveItem(e,t,r,i){let n=e;if(t.implicit){let e;if(oC(r))e=new r().toSchema("");else{let t=x[r],i=ok[t];if(!i)throw Error(`Cannot get '${t}' class from asn1js module`);e=new i}e.valueBlock=n.valueBlock,n=ok.fromBER(e.toBER(!1)).result}return i.fromASN(n)}static processComplexSchemaItem(e,t,r){if(t.repeated){if(!Array.isArray(e))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,e=>this.fromASN(e,r))}{let i=this.handleImplicitTagging(e,t,r);if(this.isOptionalChoiceField(t))try{return this.fromASN(i,r)}catch(e){if(e instanceof oT&&/Wrong values for Choice type/.test(e.message))return;throw e}{let n=this.fromASN(i,r);return t.raw?{value:n,raw:e.valueBeforeDecodeView}:n}}}static handleImplicitTagging(e,t,r){if(t.implicit&&"number"==typeof t.context){let t=oO.get(r);if(t.type===B.Sequence){let t=new ok.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}else if(t.type===B.Set){let t=new ok.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}}return e}}class oj{static serialize(e){return e instanceof ni?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&oC(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,i=oO.get(r);oO.cache(r);let n=[];if(i.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof i.itemType){let t=oE(i.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);n=e.map(e=>t.toASN(e))}else n=e.map(e=>this.toAsnItem({type:i.itemType},"[]",r,e))}else for(let t in i.items){let o=i.items[t],s=e[t];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(o.defaultValue),this.serialize(s)))continue;let a=oj.toAsnItem(o,t,r,s);if("number"==typeof o.context)if(o.implicit)if(!o.repeated&&("number"==typeof o.type||oC(o.type))){let e={};e.valueHex=a instanceof np?a.valueBeforeDecodeView:a.valueBlock.toBER(),n.push(new ns({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},...e}))}else n.push(new nc({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else n.push(new nc({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?n=n.concat(a):n.push(a)}switch(i.type){case B.Sequence:t=new nN({value:n});break;case B.Set:t=new nT({value:n});break;case B.Choice:if(!n[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=n[0]}return t}static toAsnItem(e,t,r,i){let n;if("number"==typeof e.type){let o=e.converter;if(!o)throw Error(`Property '${t}' doesn't have converter for type ${x[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>o.toASN(e));n=new("sequence"===e.repeated?nN:nT)({value:t})}else n=o.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));n=new("sequence"===e.repeated?nN:nT)({value:t})}else n=this.toASN(i);return n}}class oP extends Array{constructor(e=[]){if("number"==typeof e)super(e);else for(const t of(super(),e))this.push(t)}}class oR{static serialize(e){return oj.serialize(e)}static parse(e,t){return oU.parse(e,t)}static toString(e){let t=nl(iF.BufferSourceConverter.isBufferSource(e)?iF.BufferSourceConverter.toArrayBuffer(e):oR.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function oH(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}"function"==typeof SuppressedError&&SuppressedError;class oD{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let t=e.split(".");if(4!==t.length)throw Error("Invalid IPv4 address");return t.map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw Error("Invalid IPv4 address part");return t})}static parseIPv6(e){let t=this.expandIPv6(e).split(":");if(8!==t.length)throw Error("Invalid IPv6 address");return t.reduce((e,t)=>{let r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e},[])}static expandIPv6(e){if(!e.includes("::"))return e;let t=e.split("::");if(t.length>2)throw Error("Invalid IPv6 address");let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],n=8-(r.length+i.length);if(n<0)throw Error("Invalid IPv6 address");return[...r,...Array(n).fill("0"),...i].join(":")}static formatIPv6(e){let t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){let t=e.split(":"),r=-1,i=0,n=-1,o=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===n&&(n=e),o++):(o>i&&(r=n,i=o),n=-1,o=0);if(o>i&&(r=n,i=o),i>1){let e=t.slice(0,r).join(":"),n=t.slice(r+i).join(":");return`${e}::${n}`}return e}static parseCIDR(e){let[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;let t=parseInt(e.slice(8),16).toString(2).split("").reduce((e,t)=>e+ +t,0),r=e.slice(0,8).replace(/(.{2})/g,e=>`${parseInt(e,16)}.`);return r=r.slice(0,-1),`${r}/${t}`}static toString(e){let t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){let e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every(e=>0===e))return 8===t.length?"0.0.0.0/0":"::/0";let n=i.reduce((e,t)=>e+(t.toString(2).match(/1/g)||[]).length,0);if(8===t.length){let e=Array.from(r).join(".");return`${e}/${n}`}{let e=this.formatIPv6(r);return`${e}/${n}`}}return this.decodeIP(iF.Convert.ToHex(e))}static fromString(e){if(e.includes("/")){let[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length),n=r;for(let e=0;e<i.length;e++)n>=8?(i[e]=255,n-=8):n>0&&(i[e]=255<<8-n,n=0);let o=new Uint8Array(2*t.length);return o.set(t,0),o.set(i,t.length),o.buffer}return new Uint8Array(this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e)).buffer}}let o_=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};oH([oN({type:x.TeletexString})],o_.prototype,"teletexString",void 0),oH([oN({type:x.PrintableString})],o_.prototype,"printableString",void 0),oH([oN({type:x.UniversalString})],o_.prototype,"universalString",void 0),oH([oN({type:x.Utf8String})],o_.prototype,"utf8String",void 0),oH([oN({type:x.BmpString})],o_.prototype,"bmpString",void 0),o_=oH([oI({type:B.Choice})],o_);let oV=class extends o_{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?iF.Convert.ToHex(this.anyValue):super.toString())}};oH([oN({type:x.IA5String})],oV.prototype,"ia5String",void 0),oH([oN({type:x.Any})],oV.prototype,"anyValue",void 0),oV=oH([oI({type:B.Choice})],oV);class oL{constructor(e={}){this.type="",this.value=new oV,Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],oL.prototype,"type",void 0),oH([oN({type:oV})],oL.prototype,"value",void 0);let oM=E=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,E.prototype)}};oM=E=oH([oI({type:B.Set,itemType:oL})],oM);let oF=k=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,k.prototype)}};oF=k=oH([oI({type:B.Sequence,itemType:oM})],oF);let o$=C=class extends oF{constructor(e){super(e),Object.setPrototypeOf(this,C.prototype)}};o$=C=oH([oI({type:B.Sequence})],o$);class oz{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],oz.prototype,"typeId",void 0),oH([oN({type:x.Any,context:0})],oz.prototype,"value",void 0);class oq{constructor(e={}){this.partyName=new o_,Object.assign(this,e)}}oH([oN({type:o_,optional:!0,context:0,implicit:!0})],oq.prototype,"nameAssigner",void 0),oH([oN({type:o_,context:1,implicit:!0})],oq.prototype,"partyName",void 0);let oK=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oz,context:0,implicit:!0})],oK.prototype,"otherName",void 0),oH([oN({type:x.IA5String,context:1,implicit:!0})],oK.prototype,"rfc822Name",void 0),oH([oN({type:x.IA5String,context:2,implicit:!0})],oK.prototype,"dNSName",void 0),oH([oN({type:x.Any,context:3,implicit:!0})],oK.prototype,"x400Address",void 0),oH([oN({type:o$,context:4,implicit:!1})],oK.prototype,"directoryName",void 0),oH([oN({type:oq,context:5})],oK.prototype,"ediPartyName",void 0),oH([oN({type:x.IA5String,context:6,implicit:!0})],oK.prototype,"uniformResourceIdentifier",void 0),oH([oN({type:x.OctetString,context:7,implicit:!0,converter:{fromASN:e=>oD.toString(ol.fromASN(e)),toASN:e=>ol.toASN(oD.fromString(e))}})],oK.prototype,"iPAddress",void 0),oH([oN({type:x.ObjectIdentifier,context:8,implicit:!0})],oK.prototype,"registeredID",void 0),oK=oH([oI({type:B.Choice})],oK);let oW="1.3.6.1.5.5.7",oG=`${oW}.1`,oZ=`${oW}.3`,oJ=`${oW}.48`,oY=`${oJ}.1`,oQ=`${oJ}.2`,oX=`${oJ}.3`,o0=`${oJ}.5`,o1="2.5.29",o2=`${oG}.1`;class o8{constructor(e={}){this.accessMethod="",this.accessLocation=new oK,Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],o8.prototype,"accessMethod",void 0),oH([oN({type:oK})],o8.prototype,"accessLocation",void 0);let o3=O=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype)}};o3=O=oH([oI({type:B.Sequence,itemType:o8})],o3);let o5=`${o1}.35`;class o6 extends oe{}class o4{constructor(e={}){e&&Object.assign(this,e)}}oH([oN({type:o6,context:0,optional:!0,implicit:!0})],o4.prototype,"keyIdentifier",void 0),oH([oN({type:oK,context:1,optional:!0,implicit:!0,repeated:"sequence"})],o4.prototype,"authorityCertIssuer",void 0),oH([oN({type:x.Integer,context:2,optional:!0,implicit:!0,converter:on})],o4.prototype,"authorityCertSerialNumber",void 0);let o9=`${o1}.19`;class o7{constructor(e={}){this.cA=!1,Object.assign(this,e)}}oH([oN({type:x.Boolean,defaultValue:!1})],o7.prototype,"cA",void 0),oH([oN({type:x.Integer,optional:!0})],o7.prototype,"pathLenConstraint",void 0);let se=I=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,I.prototype)}};se=I=oH([oI({type:B.Sequence,itemType:oK})],se);let st=N=class extends se{constructor(e){super(e),Object.setPrototypeOf(this,N.prototype)}};st=N=oH([oI({type:B.Sequence})],st);let sr=`${o1}.32`,si=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};oH([oN({type:x.IA5String})],si.prototype,"ia5String",void 0),oH([oN({type:x.VisibleString})],si.prototype,"visibleString",void 0),oH([oN({type:x.BmpString})],si.prototype,"bmpString",void 0),oH([oN({type:x.Utf8String})],si.prototype,"utf8String",void 0),si=oH([oI({type:B.Choice})],si);class sn{constructor(e={}){this.organization=new si,this.noticeNumbers=[],Object.assign(this,e)}}oH([oN({type:si})],sn.prototype,"organization",void 0),oH([oN({type:x.Integer,repeated:"sequence"})],sn.prototype,"noticeNumbers",void 0);class so{constructor(e={}){Object.assign(this,e)}}oH([oN({type:sn,optional:!0})],so.prototype,"noticeRef",void 0),oH([oN({type:si,optional:!0})],so.prototype,"explicitText",void 0);let ss=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:x.IA5String})],ss.prototype,"cPSuri",void 0),oH([oN({type:so})],ss.prototype,"userNotice",void 0),ss=oH([oI({type:B.Choice})],ss);class sa{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],sa.prototype,"policyQualifierId",void 0),oH([oN({type:x.Any})],sa.prototype,"qualifier",void 0);class sl{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],sl.prototype,"policyIdentifier",void 0),oH([oN({type:sa,repeated:"sequence",optional:!0})],sl.prototype,"policyQualifiers",void 0);let su=T=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,T.prototype)}};su=T=oH([oI({type:B.Sequence,itemType:sl})],su);let sc=class{constructor(e=0){this.value=e}};oH([oN({type:x.Integer})],sc.prototype,"value",void 0),sc=oH([oI({type:B.Choice})],sc);let sf=class extends sc{};sf=oH([oI({type:B.Choice})],sf);let sh=`${o1}.31`;(o=j||(j={}))[o.unused=1]="unused",o[o.keyCompromise=2]="keyCompromise",o[o.cACompromise=4]="cACompromise",o[o.affiliationChanged=8]="affiliationChanged",o[o.superseded=16]="superseded",o[o.cessationOfOperation=32]="cessationOfOperation",o[o.certificateHold=64]="certificateHold",o[o.privilegeWithdrawn=128]="privilegeWithdrawn",o[o.aACompromise=256]="aACompromise";class sp extends n7{toJSON(){let e=[],t=this.toNumber();return t&j.aACompromise&&e.push("aACompromise"),t&j.affiliationChanged&&e.push("affiliationChanged"),t&j.cACompromise&&e.push("cACompromise"),t&j.certificateHold&&e.push("certificateHold"),t&j.cessationOfOperation&&e.push("cessationOfOperation"),t&j.keyCompromise&&e.push("keyCompromise"),t&j.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&j.superseded&&e.push("superseded"),t&j.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let sd=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oK,context:0,repeated:"sequence",implicit:!0})],sd.prototype,"fullName",void 0),oH([oN({type:oM,context:1,implicit:!0})],sd.prototype,"nameRelativeToCRLIssuer",void 0),sd=oH([oI({type:B.Choice})],sd);class sy{constructor(e={}){Object.assign(this,e)}}oH([oN({type:sd,context:0,optional:!0})],sy.prototype,"distributionPoint",void 0),oH([oN({type:sp,context:1,optional:!0,implicit:!0})],sy.prototype,"reasons",void 0),oH([oN({type:oK,context:2,optional:!0,repeated:"sequence",implicit:!0})],sy.prototype,"cRLIssuer",void 0);let sg=U=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,U.prototype)}};sg=U=oH([oI({type:B.Sequence,itemType:sy})],sg);let sv=P=class extends sg{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}};sv=P=oH([oI({type:B.Sequence,itemType:sy})],sv);class sm{constructor(e={}){this.onlyContainsUserCerts=sm.ONLY,this.onlyContainsCACerts=sm.ONLY,this.indirectCRL=sm.ONLY,this.onlyContainsAttributeCerts=sm.ONLY,Object.assign(this,e)}}sm.ONLY=!1,oH([oN({type:sd,context:0,optional:!0})],sm.prototype,"distributionPoint",void 0),oH([oN({type:x.Boolean,context:1,defaultValue:sm.ONLY,implicit:!0})],sm.prototype,"onlyContainsUserCerts",void 0),oH([oN({type:x.Boolean,context:2,defaultValue:sm.ONLY,implicit:!0})],sm.prototype,"onlyContainsCACerts",void 0),oH([oN({type:sp,context:3,optional:!0,implicit:!0})],sm.prototype,"onlySomeReasons",void 0),oH([oN({type:x.Boolean,context:4,defaultValue:sm.ONLY,implicit:!0})],sm.prototype,"indirectCRL",void 0),oH([oN({type:x.Boolean,context:5,defaultValue:sm.ONLY,implicit:!0})],sm.prototype,"onlyContainsAttributeCerts",void 0),(s=R||(R={}))[s.unspecified=0]="unspecified",s[s.keyCompromise=1]="keyCompromise",s[s.cACompromise=2]="cACompromise",s[s.affiliationChanged=3]="affiliationChanged",s[s.superseded=4]="superseded",s[s.cessationOfOperation=5]="cessationOfOperation",s[s.certificateHold=6]="certificateHold",s[s.removeFromCRL=8]="removeFromCRL",s[s.privilegeWithdrawn=9]="privilegeWithdrawn",s[s.aACompromise=10]="aACompromise";let sb=class{constructor(e=R.unspecified){this.reason=R.unspecified,this.reason=e}toJSON(){return R[this.reason]}toString(){return this.toJSON()}};oH([oN({type:x.Enumerated})],sb.prototype,"reason",void 0),sb=oH([oI({type:B.Choice})],sb);let sw=`${o1}.37`,sA=H=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,H.prototype)}};sA=H=oH([oI({type:B.Sequence,itemType:x.ObjectIdentifier})],sA);let sS=`${oZ}.1`,sB=`${oZ}.2`,sx=`${oZ}.3`,sE=`${oZ}.4`,sk=`${oZ}.8`,sC=`${oZ}.9`,sO=class{constructor(e=new ArrayBuffer(0)){this.value=e}};oH([oN({type:x.Integer,converter:on})],sO.prototype,"value",void 0),sO=oH([oI({type:B.Choice})],sO);let sI=class{constructor(e){this.value=new Date,e&&(this.value=e)}};oH([oN({type:x.GeneralizedTime})],sI.prototype,"value",void 0),sI=oH([oI({type:B.Choice})],sI);let sN=D=class extends se{constructor(e){super(e),Object.setPrototypeOf(this,D.prototype)}};sN=D=oH([oI({type:B.Sequence})],sN);let sT=`${o1}.15`;(a=_||(_={}))[a.digitalSignature=1]="digitalSignature",a[a.nonRepudiation=2]="nonRepudiation",a[a.keyEncipherment=4]="keyEncipherment",a[a.dataEncipherment=8]="dataEncipherment",a[a.keyAgreement=16]="keyAgreement",a[a.keyCertSign=32]="keyCertSign",a[a.cRLSign=64]="cRLSign",a[a.encipherOnly=128]="encipherOnly",a[a.decipherOnly=256]="decipherOnly";class sU extends n7{toJSON(){let e=this.toNumber(),t=[];return e&_.cRLSign&&t.push("crlSign"),e&_.dataEncipherment&&t.push("dataEncipherment"),e&_.decipherOnly&&t.push("decipherOnly"),e&_.digitalSignature&&t.push("digitalSignature"),e&_.encipherOnly&&t.push("encipherOnly"),e&_.keyAgreement&&t.push("keyAgreement"),e&_.keyCertSign&&t.push("keyCertSign"),e&_.keyEncipherment&&t.push("keyEncipherment"),e&_.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class sj{constructor(e={}){this.base=new oK,this.minimum=0,Object.assign(this,e)}}oH([oN({type:oK})],sj.prototype,"base",void 0),oH([oN({type:x.Integer,context:0,defaultValue:0,implicit:!0})],sj.prototype,"minimum",void 0),oH([oN({type:x.Integer,context:1,optional:!0,implicit:!0})],sj.prototype,"maximum",void 0);let sP=V=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,V.prototype)}};sP=V=oH([oI({type:B.Sequence,itemType:sj})],sP);class sR{constructor(e={}){Object.assign(this,e)}}oH([oN({type:sP,context:0,optional:!0,implicit:!0})],sR.prototype,"permittedSubtrees",void 0),oH([oN({type:sP,context:1,optional:!0,implicit:!0})],sR.prototype,"excludedSubtrees",void 0);class sH{constructor(e={}){Object.assign(this,e)}}oH([oN({type:x.Integer,context:0,implicit:!0,optional:!0,converter:on})],sH.prototype,"requireExplicitPolicy",void 0),oH([oN({type:x.Integer,context:1,implicit:!0,optional:!0,converter:on})],sH.prototype,"inhibitPolicyMapping",void 0);class sD{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],sD.prototype,"issuerDomainPolicy",void 0),oH([oN({type:x.ObjectIdentifier})],sD.prototype,"subjectDomainPolicy",void 0);let s_=L=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,L.prototype)}};s_=L=oH([oI({type:B.Sequence,itemType:sD})],s_);let sV=`${o1}.17`,sL=M=class extends se{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype)}};sL=M=oH([oI({type:B.Sequence})],sL);class sM{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],sM.prototype,"type",void 0),oH([oN({type:x.Any,repeated:"set"})],sM.prototype,"values",void 0);let sF=F=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,F.prototype)}};sF=F=oH([oI({type:B.Sequence,itemType:sM})],sF);let s$=`${o1}.14`;class sz extends o6{}class sq{constructor(e={}){Object.assign(this,e)}}oH([oN({type:x.GeneralizedTime,context:0,implicit:!0,optional:!0})],sq.prototype,"notBefore",void 0),oH([oN({type:x.GeneralizedTime,context:1,implicit:!0,optional:!0})],sq.prototype,"notAfter",void 0),(l=$||($={}))[l.keyUpdateAllowed=1]="keyUpdateAllowed",l[l.newExtensions=2]="newExtensions",l[l.pKIXCertificate=4]="pKIXCertificate";class sK extends n7{toJSON(){let e=[],t=this.toNumber();return t&$.pKIXCertificate&&e.push("pKIXCertificate"),t&$.newExtensions&&e.push("newExtensions"),t&$.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class sW{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new sK,Object.assign(this,e)}}oH([oN({type:x.GeneralString})],sW.prototype,"entrustVers",void 0),oH([oN({type:sK})],sW.prototype,"entrustInfoFlags",void 0);let sG=z=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,z.prototype)}};sG=z=oH([oI({type:B.Sequence,itemType:o8})],sG);class sZ{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof sZ&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&iF.isEqual(e.parameters,this.parameters)||e.parameters===this.parameters)}}oH([oN({type:x.ObjectIdentifier})],sZ.prototype,"algorithm",void 0),oH([oN({type:x.Any,optional:!0})],sZ.prototype,"parameters",void 0);class sJ{constructor(e={}){this.algorithm=new sZ,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:sZ})],sJ.prototype,"algorithm",void 0),oH([oN({type:x.BitString})],sJ.prototype,"subjectPublicKey",void 0);let sY=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw Error("Cannot get time from CHOICE object");return e}};oH([oN({type:x.UTCTime})],sY.prototype,"utcTime",void 0),oH([oN({type:x.GeneralizedTime})],sY.prototype,"generalTime",void 0),sY=oH([oI({type:B.Choice})],sY);class sQ{constructor(e){this.notBefore=new sY(new Date),this.notAfter=new sY(new Date),e&&(this.notBefore=new sY(e.notBefore),this.notAfter=new sY(e.notAfter))}}oH([oN({type:sY})],sQ.prototype,"notBefore",void 0),oH([oN({type:sY})],sQ.prototype,"notAfter",void 0);class sX{constructor(e={}){this.extnID="",this.critical=sX.CRITICAL,this.extnValue=new oe,Object.assign(this,e)}}sX.CRITICAL=!1,oH([oN({type:x.ObjectIdentifier})],sX.prototype,"extnID",void 0),oH([oN({type:x.Boolean,defaultValue:sX.CRITICAL})],sX.prototype,"critical",void 0),oH([oN({type:oe})],sX.prototype,"extnValue",void 0);let s0=q=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,q.prototype)}};s0=q=oH([oI({type:B.Sequence,itemType:sX})],s0),(u=K||(K={}))[u.v1=0]="v1",u[u.v2=1]="v2",u[u.v3=2]="v3";class s1{constructor(e={}){this.version=K.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new sZ,this.issuer=new o$,this.validity=new sQ,this.subject=new o$,this.subjectPublicKeyInfo=new sJ,Object.assign(this,e)}}oH([oN({type:x.Integer,context:0,defaultValue:K.v1})],s1.prototype,"version",void 0),oH([oN({type:x.Integer,converter:on})],s1.prototype,"serialNumber",void 0),oH([oN({type:sZ})],s1.prototype,"signature",void 0),oH([oN({type:o$})],s1.prototype,"issuer",void 0),oH([oN({type:sQ})],s1.prototype,"validity",void 0),oH([oN({type:o$})],s1.prototype,"subject",void 0),oH([oN({type:sJ})],s1.prototype,"subjectPublicKeyInfo",void 0),oH([oN({type:x.BitString,context:1,implicit:!0,optional:!0})],s1.prototype,"issuerUniqueID",void 0),oH([oN({type:x.BitString,context:2,implicit:!0,optional:!0})],s1.prototype,"subjectUniqueID",void 0),oH([oN({type:s0,context:3,optional:!0})],s1.prototype,"extensions",void 0);class s2{constructor(e={}){this.tbsCertificate=new s1,this.signatureAlgorithm=new sZ,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:s1,raw:!0})],s2.prototype,"tbsCertificate",void 0),oH([oN({type:sZ})],s2.prototype,"signatureAlgorithm",void 0),oH([oN({type:x.BitString})],s2.prototype,"signatureValue",void 0);class s8{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new sY,Object.assign(this,e)}}oH([oN({type:x.Integer,converter:on})],s8.prototype,"userCertificate",void 0),oH([oN({type:sY})],s8.prototype,"revocationDate",void 0),oH([oN({type:sX,optional:!0,repeated:"sequence"})],s8.prototype,"crlEntryExtensions",void 0);class s3{constructor(e={}){this.signature=new sZ,this.issuer=new o$,this.thisUpdate=new sY,Object.assign(this,e)}}oH([oN({type:x.Integer,optional:!0})],s3.prototype,"version",void 0),oH([oN({type:sZ})],s3.prototype,"signature",void 0),oH([oN({type:o$})],s3.prototype,"issuer",void 0),oH([oN({type:sY})],s3.prototype,"thisUpdate",void 0),oH([oN({type:sY,optional:!0})],s3.prototype,"nextUpdate",void 0),oH([oN({type:s8,repeated:"sequence",optional:!0})],s3.prototype,"revokedCertificates",void 0),oH([oN({type:sX,optional:!0,context:0,repeated:"sequence"})],s3.prototype,"crlExtensions",void 0);class s5{constructor(e={}){this.tbsCertList=new s3,this.signatureAlgorithm=new sZ,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:s3,raw:!0})],s5.prototype,"tbsCertList",void 0),oH([oN({type:sZ})],s5.prototype,"signatureAlgorithm",void 0),oH([oN({type:x.BitString})],s5.prototype,"signature",void 0);class s6{constructor(e={}){this.issuer=new o$,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:o$})],s6.prototype,"issuer",void 0),oH([oN({type:x.Integer,converter:on})],s6.prototype,"serialNumber",void 0);let s4=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:sz,context:0,implicit:!0})],s4.prototype,"subjectKeyIdentifier",void 0),oH([oN({type:s6})],s4.prototype,"issuerAndSerialNumber",void 0),s4=oH([oI({type:B.Choice})],s4),(c=W||(W={}))[c.v0=0]="v0",c[c.v1=1]="v1",c[c.v2=2]="v2",c[c.v3=3]="v3",c[c.v4=4]="v4",c[c.v5=5]="v5";let s9=class extends sZ{};s9=oH([oI({type:B.Sequence})],s9);let s7=class extends sZ{};s7=oH([oI({type:B.Sequence})],s7);let ae=class extends sZ{};ae=oH([oI({type:B.Sequence})],ae);let at=class extends sZ{};at=oH([oI({type:B.Sequence})],at);let ar=class extends sZ{};ar=oH([oI({type:B.Sequence})],ar);let ai=class extends sZ{};ai=oH([oI({type:B.Sequence})],ai);class an{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],an.prototype,"attrType",void 0),oH([oN({type:x.Any,repeated:"set"})],an.prototype,"attrValues",void 0);class ao{constructor(e={}){this.version=W.v0,this.sid=new s4,this.digestAlgorithm=new s9,this.signatureAlgorithm=new s7,this.signature=new oe,Object.assign(this,e)}}oH([oN({type:x.Integer})],ao.prototype,"version",void 0),oH([oN({type:s4})],ao.prototype,"sid",void 0),oH([oN({type:s9})],ao.prototype,"digestAlgorithm",void 0),oH([oN({type:an,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],ao.prototype,"signedAttrs",void 0),oH([oN({type:s7})],ao.prototype,"signatureAlgorithm",void 0),oH([oN({type:oe})],ao.prototype,"signature",void 0),oH([oN({type:an,repeated:"set",context:1,implicit:!0,optional:!0})],ao.prototype,"unsignedAttrs",void 0);let as=G=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,G.prototype)}};as=G=oH([oI({type:B.Set,itemType:ao})],as);let aa=class extends ao{};aa=oH([oI({type:B.Sequence})],aa);let al=class extends sY{};al=oH([oI({type:B.Choice})],al);class au{constructor(e={}){this.acIssuer=new oK,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}oH([oN({type:oK})],au.prototype,"acIssuer",void 0),oH([oN({type:x.Integer})],au.prototype,"acSerial",void 0),oH([oN({type:sM,repeated:"sequence"})],au.prototype,"attrs",void 0);let ac=Z=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,Z.prototype)}};ac=Z=oH([oI({type:B.Sequence,itemType:x.ObjectIdentifier})],ac);class af{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}oH([oN({type:x.Integer,optional:!0})],af.prototype,"pathLenConstraint",void 0),oH([oN({type:ac,implicit:!0,context:0,optional:!0})],af.prototype,"permittedAttrs",void 0),oH([oN({type:ac,implicit:!0,context:1,optional:!0})],af.prototype,"excludedAttrs",void 0),oH([oN({type:x.Boolean,defaultValue:!0})],af.prototype,"permitUnSpecified",void 0);class ah{constructor(e={}){this.issuer=new se,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:se})],ah.prototype,"issuer",void 0),oH([oN({type:x.Integer,converter:on})],ah.prototype,"serial",void 0),oH([oN({type:x.BitString,optional:!0})],ah.prototype,"issuerUID",void 0),(f=J||(J={}))[f.publicKey=0]="publicKey",f[f.publicKeyCert=1]="publicKeyCert",f[f.otherObjectTypes=2]="otherObjectTypes";class ap{constructor(e={}){this.digestedObjectType=J.publicKey,this.digestAlgorithm=new sZ,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.Enumerated})],ap.prototype,"digestedObjectType",void 0),oH([oN({type:x.ObjectIdentifier,optional:!0})],ap.prototype,"otherObjectTypeID",void 0),oH([oN({type:sZ})],ap.prototype,"digestAlgorithm",void 0),oH([oN({type:x.BitString})],ap.prototype,"objectDigest",void 0);class ad{constructor(e={}){Object.assign(this,e)}}oH([oN({type:se,optional:!0})],ad.prototype,"issuerName",void 0),oH([oN({type:ah,context:0,implicit:!0,optional:!0})],ad.prototype,"baseCertificateID",void 0),oH([oN({type:ap,context:1,implicit:!0,optional:!0})],ad.prototype,"objectDigestInfo",void 0);let ay=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oK,repeated:"sequence"})],ay.prototype,"v1Form",void 0),oH([oN({type:ad,context:0,implicit:!0})],ay.prototype,"v2Form",void 0),ay=oH([oI({type:B.Choice})],ay);class ag{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}oH([oN({type:x.GeneralizedTime})],ag.prototype,"notBeforeTime",void 0),oH([oN({type:x.GeneralizedTime})],ag.prototype,"notAfterTime",void 0);class av{constructor(e={}){Object.assign(this,e)}}oH([oN({type:ah,implicit:!0,context:0,optional:!0})],av.prototype,"baseCertificateID",void 0),oH([oN({type:se,implicit:!0,context:1,optional:!0})],av.prototype,"entityName",void 0),oH([oN({type:ap,implicit:!0,context:2,optional:!0})],av.prototype,"objectDigestInfo",void 0),(h=Y||(Y={}))[h.v2=1]="v2";class am{constructor(e={}){this.version=Y.v2,this.holder=new av,this.issuer=new ay,this.signature=new sZ,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new ag,this.attributes=[],Object.assign(this,e)}}oH([oN({type:x.Integer})],am.prototype,"version",void 0),oH([oN({type:av})],am.prototype,"holder",void 0),oH([oN({type:ay})],am.prototype,"issuer",void 0),oH([oN({type:sZ})],am.prototype,"signature",void 0),oH([oN({type:x.Integer,converter:on})],am.prototype,"serialNumber",void 0),oH([oN({type:ag})],am.prototype,"attrCertValidityPeriod",void 0),oH([oN({type:sM,repeated:"sequence"})],am.prototype,"attributes",void 0),oH([oN({type:x.BitString,optional:!0})],am.prototype,"issuerUniqueID",void 0),oH([oN({type:s0,optional:!0})],am.prototype,"extensions",void 0);class ab{constructor(e={}){this.acinfo=new am,this.signatureAlgorithm=new sZ,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:am})],ab.prototype,"acinfo",void 0),oH([oN({type:sZ})],ab.prototype,"signatureAlgorithm",void 0),oH([oN({type:x.BitString})],ab.prototype,"signatureValue",void 0),(p=Q||(Q={}))[p.unmarked=1]="unmarked",p[p.unclassified=2]="unclassified",p[p.restricted=4]="restricted",p[p.confidential=8]="confidential",p[p.secret=16]="secret",p[p.topSecret=32]="topSecret";class aw extends n7{}class aA{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier,implicit:!0,context:0})],aA.prototype,"type",void 0),oH([oN({type:x.Any,implicit:!0,context:1})],aA.prototype,"value",void 0);class aS{constructor(e={}){this.policyId="",this.classList=new aw(Q.unclassified),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aS.prototype,"policyId",void 0),oH([oN({type:aw,defaultValue:new aw(Q.unclassified)})],aS.prototype,"classList",void 0),oH([oN({type:aA,repeated:"set"})],aS.prototype,"securityCategories",void 0);class aB{constructor(e={}){Object.assign(this,e)}}oH([oN({type:oe})],aB.prototype,"cotets",void 0),oH([oN({type:x.ObjectIdentifier})],aB.prototype,"oid",void 0),oH([oN({type:x.Utf8String})],aB.prototype,"string",void 0);class ax{constructor(e={}){this.values=[],Object.assign(this,e)}}oH([oN({type:se,implicit:!0,context:0,optional:!0})],ax.prototype,"policyAuthority",void 0),oH([oN({type:aB,repeated:"sequence"})],ax.prototype,"values",void 0);class aE{constructor(e={}){this.targetCertificate=new ah,Object.assign(this,e)}}oH([oN({type:ah})],aE.prototype,"targetCertificate",void 0),oH([oN({type:oK,optional:!0})],aE.prototype,"targetName",void 0),oH([oN({type:ap,optional:!0})],aE.prototype,"certDigestInfo",void 0);let ak=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oK,context:0,implicit:!0})],ak.prototype,"targetName",void 0),oH([oN({type:oK,context:1,implicit:!0})],ak.prototype,"targetGroup",void 0),oH([oN({type:aE,context:2,implicit:!0})],ak.prototype,"targetCert",void 0),ak=oH([oI({type:B.Choice})],ak);let aC=X=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,X.prototype)}};aC=X=oH([oI({type:B.Sequence,itemType:ak})],aC);let aO=ee=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ee.prototype)}};aO=ee=oH([oI({type:B.Sequence,itemType:aC})],aO);class aI{constructor(e={}){Object.assign(this,e)}}oH([oN({type:se,implicit:!0,context:0,optional:!0})],aI.prototype,"roleAuthority",void 0),oH([oN({type:oK,implicit:!0,context:1})],aI.prototype,"roleName",void 0);class aN{constructor(e={}){this.service=new oK,this.ident=new oK,Object.assign(this,e)}}oH([oN({type:oK})],aN.prototype,"service",void 0),oH([oN({type:oK})],aN.prototype,"ident",void 0),oH([oN({type:oe,optional:!0})],aN.prototype,"authInfo",void 0);class aT{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aT.prototype,"otherCertFormat",void 0),oH([oN({type:x.Any})],aT.prototype,"otherCert",void 0);let aU=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:s2})],aU.prototype,"certificate",void 0),oH([oN({type:ab,context:2,implicit:!0})],aU.prototype,"v2AttrCert",void 0),oH([oN({type:aT,context:3,implicit:!0})],aU.prototype,"other",void 0),aU=oH([oI({type:B.Choice})],aU);let aj=et=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,et.prototype)}};aj=et=oH([oI({type:B.Set,itemType:aU})],aj);class aP{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aP.prototype,"contentType",void 0),oH([oN({type:x.Any,context:0})],aP.prototype,"content",void 0);let aR=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oe})],aR.prototype,"single",void 0),oH([oN({type:x.Any})],aR.prototype,"any",void 0),aR=oH([oI({type:B.Choice})],aR);class aH{constructor(e={}){this.eContentType="",Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aH.prototype,"eContentType",void 0),oH([oN({type:aR,context:0,optional:!0})],aH.prototype,"eContent",void 0);let aD=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:oe,context:0,implicit:!0,optional:!0})],aD.prototype,"value",void 0),oH([oN({type:oe,converter:{fromASN:e=>new oe(e.getValue()),toASN:e=>e.toASN()},context:0,implicit:!0,optional:!0,repeated:"sequence"})],aD.prototype,"constructedValue",void 0),aD=oH([oI({type:B.Choice})],aD);class a_{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new at,Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],a_.prototype,"contentType",void 0),oH([oN({type:at})],a_.prototype,"contentEncryptionAlgorithm",void 0),oH([oN({type:aD,optional:!0})],a_.prototype,"encryptedContent",void 0);class aV{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aV.prototype,"keyAttrId",void 0),oH([oN({type:x.Any,optional:!0})],aV.prototype,"keyAttr",void 0);class aL{constructor(e={}){this.subjectKeyIdentifier=new sz,Object.assign(this,e)}}oH([oN({type:sz})],aL.prototype,"subjectKeyIdentifier",void 0),oH([oN({type:x.GeneralizedTime,optional:!0})],aL.prototype,"date",void 0),oH([oN({type:aV,optional:!0})],aL.prototype,"other",void 0);let aM=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:aL,context:0,implicit:!0,optional:!0})],aM.prototype,"rKeyId",void 0),oH([oN({type:s6,optional:!0})],aM.prototype,"issuerAndSerialNumber",void 0),aM=oH([oI({type:B.Choice})],aM);class aF{constructor(e={}){this.rid=new aM,this.encryptedKey=new oe,Object.assign(this,e)}}oH([oN({type:aM})],aF.prototype,"rid",void 0),oH([oN({type:oe})],aF.prototype,"encryptedKey",void 0);let a$=er=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,er.prototype)}};a$=er=oH([oI({type:B.Sequence,itemType:aF})],a$);class az{constructor(e={}){this.algorithm=new sZ,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:sZ})],az.prototype,"algorithm",void 0),oH([oN({type:x.BitString})],az.prototype,"publicKey",void 0);let aq=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:sz,context:0,implicit:!0,optional:!0})],aq.prototype,"subjectKeyIdentifier",void 0),oH([oN({type:az,context:1,implicit:!0,optional:!0})],aq.prototype,"originatorKey",void 0),oH([oN({type:s6,optional:!0})],aq.prototype,"issuerAndSerialNumber",void 0),aq=oH([oI({type:B.Choice})],aq);class aK{constructor(e={}){this.version=W.v3,this.originator=new aq,this.keyEncryptionAlgorithm=new ae,this.recipientEncryptedKeys=new a$,Object.assign(this,e)}}oH([oN({type:x.Integer})],aK.prototype,"version",void 0),oH([oN({type:aq,context:0})],aK.prototype,"originator",void 0),oH([oN({type:oe,context:1,optional:!0})],aK.prototype,"ukm",void 0),oH([oN({type:ae})],aK.prototype,"keyEncryptionAlgorithm",void 0),oH([oN({type:a$})],aK.prototype,"recipientEncryptedKeys",void 0);let aW=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:sz,context:0,implicit:!0})],aW.prototype,"subjectKeyIdentifier",void 0),oH([oN({type:s6})],aW.prototype,"issuerAndSerialNumber",void 0),aW=oH([oI({type:B.Choice})],aW);class aG{constructor(e={}){this.version=W.v0,this.rid=new aW,this.keyEncryptionAlgorithm=new ae,this.encryptedKey=new oe,Object.assign(this,e)}}oH([oN({type:x.Integer})],aG.prototype,"version",void 0),oH([oN({type:aW})],aG.prototype,"rid",void 0),oH([oN({type:ae})],aG.prototype,"keyEncryptionAlgorithm",void 0),oH([oN({type:oe})],aG.prototype,"encryptedKey",void 0);class aZ{constructor(e={}){this.keyIdentifier=new oe,Object.assign(this,e)}}oH([oN({type:oe})],aZ.prototype,"keyIdentifier",void 0),oH([oN({type:x.GeneralizedTime,optional:!0})],aZ.prototype,"date",void 0),oH([oN({type:aV,optional:!0})],aZ.prototype,"other",void 0);class aJ{constructor(e={}){this.version=W.v4,this.kekid=new aZ,this.keyEncryptionAlgorithm=new ae,this.encryptedKey=new oe,Object.assign(this,e)}}oH([oN({type:x.Integer})],aJ.prototype,"version",void 0),oH([oN({type:aZ})],aJ.prototype,"kekid",void 0),oH([oN({type:ae})],aJ.prototype,"keyEncryptionAlgorithm",void 0),oH([oN({type:oe})],aJ.prototype,"encryptedKey",void 0);class aY{constructor(e={}){this.version=W.v0,this.keyEncryptionAlgorithm=new ae,this.encryptedKey=new oe,Object.assign(this,e)}}oH([oN({type:x.Integer})],aY.prototype,"version",void 0),oH([oN({type:ai,context:0,optional:!0})],aY.prototype,"keyDerivationAlgorithm",void 0),oH([oN({type:ae})],aY.prototype,"keyEncryptionAlgorithm",void 0),oH([oN({type:oe})],aY.prototype,"encryptedKey",void 0);class aQ{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],aQ.prototype,"oriType",void 0),oH([oN({type:x.Any})],aQ.prototype,"oriValue",void 0);let aX=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:aG,optional:!0})],aX.prototype,"ktri",void 0),oH([oN({type:aK,context:1,implicit:!0,optional:!0})],aX.prototype,"kari",void 0),oH([oN({type:aJ,context:2,implicit:!0,optional:!0})],aX.prototype,"kekri",void 0),oH([oN({type:aY,context:3,implicit:!0,optional:!0})],aX.prototype,"pwri",void 0),oH([oN({type:aQ,context:4,implicit:!0,optional:!0})],aX.prototype,"ori",void 0),aX=oH([oI({type:B.Choice})],aX);let a0=ei=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ei.prototype)}};a0=ei=oH([oI({type:B.Set,itemType:aX})],a0);class a1{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],a1.prototype,"otherRevInfoFormat",void 0),oH([oN({type:x.Any})],a1.prototype,"otherRevInfo",void 0);let a2=class{constructor(e={}){this.other=new a1,Object.assign(this,e)}};oH([oN({type:a1,context:1,implicit:!0})],a2.prototype,"other",void 0),a2=oH([oI({type:B.Choice})],a2);let a8=en=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,en.prototype)}};a8=en=oH([oI({type:B.Set,itemType:a2})],a8);class a3{constructor(e={}){Object.assign(this,e)}}oH([oN({type:aj,context:0,implicit:!0,optional:!0})],a3.prototype,"certs",void 0),oH([oN({type:a8,context:1,implicit:!0,optional:!0})],a3.prototype,"crls",void 0);let a5=eo=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,eo.prototype)}};a5=eo=oH([oI({type:B.Set,itemType:an})],a5);class a6{constructor(e={}){this.version=W.v0,this.recipientInfos=new a0,this.encryptedContentInfo=new a_,Object.assign(this,e)}}oH([oN({type:x.Integer})],a6.prototype,"version",void 0),oH([oN({type:a3,context:0,implicit:!0,optional:!0})],a6.prototype,"originatorInfo",void 0),oH([oN({type:a0})],a6.prototype,"recipientInfos",void 0),oH([oN({type:a_})],a6.prototype,"encryptedContentInfo",void 0),oH([oN({type:a5,context:1,implicit:!0,optional:!0})],a6.prototype,"unprotectedAttrs",void 0);let a4="1.2.840.113549.1.7.2",a9=es=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,es.prototype)}};a9=es=oH([oI({type:B.Set,itemType:s9})],a9);class a7{constructor(e={}){this.version=W.v0,this.digestAlgorithms=new a9,this.encapContentInfo=new aH,this.signerInfos=new as,Object.assign(this,e)}}oH([oN({type:x.Integer})],a7.prototype,"version",void 0),oH([oN({type:a9})],a7.prototype,"digestAlgorithms",void 0),oH([oN({type:aH})],a7.prototype,"encapContentInfo",void 0),oH([oN({type:aj,context:0,implicit:!0,optional:!0})],a7.prototype,"certificates",void 0),oH([oN({type:a8,context:1,implicit:!0,optional:!0})],a7.prototype,"crls",void 0),oH([oN({type:as})],a7.prototype,"signerInfos",void 0);let le="1.2.840.10045.2.1",lt="1.2.840.10045.4.1",lr="1.2.840.10045.4.3.1",li="1.2.840.10045.4.3.2",ln="1.2.840.10045.4.3.3",lo="1.2.840.10045.4.3.4",ls="1.2.840.10045.3.1.7",la="1.3.132.0.34",ll="1.3.132.0.35";function lu(e){return new sZ({algorithm:e})}let lc=lu(lt);lu(lr);let lf=lu(li),lh=lu(ln),lp=lu(lo),ld=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:x.ObjectIdentifier})],ld.prototype,"fieldType",void 0),oH([oN({type:x.Any})],ld.prototype,"parameters",void 0),ld=oH([oI({type:B.Sequence})],ld);let ly=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:x.OctetString})],ly.prototype,"a",void 0),oH([oN({type:x.OctetString})],ly.prototype,"b",void 0),oH([oN({type:x.BitString,optional:!0})],ly.prototype,"seed",void 0),ly=oH([oI({type:B.Sequence})],ly),(d=ea||(ea={}))[d.ecpVer1=1]="ecpVer1";let lg=class{constructor(e={}){this.version=ea.ecpVer1,Object.assign(this,e)}};oH([oN({type:x.Integer})],lg.prototype,"version",void 0),oH([oN({type:ld})],lg.prototype,"fieldID",void 0),oH([oN({type:ly})],lg.prototype,"curve",void 0),oH([oN({type:class extends oe{}})],lg.prototype,"base",void 0),oH([oN({type:x.Integer,converter:on})],lg.prototype,"order",void 0),oH([oN({type:x.Integer,optional:!0})],lg.prototype,"cofactor",void 0),lg=oH([oI({type:B.Sequence})],lg);let lv=class{constructor(e={}){Object.assign(this,e)}};oH([oN({type:x.ObjectIdentifier})],lv.prototype,"namedCurve",void 0),oH([oN({type:x.Null})],lv.prototype,"implicitCurve",void 0),oH([oN({type:lg})],lv.prototype,"specifiedCurve",void 0),lv=oH([oI({type:B.Choice})],lv);class lm{constructor(e={}){this.version=1,this.privateKey=new oe,Object.assign(this,e)}}oH([oN({type:x.Integer})],lm.prototype,"version",void 0),oH([oN({type:oe})],lm.prototype,"privateKey",void 0),oH([oN({type:lv,context:0,optional:!0})],lm.prototype,"parameters",void 0),oH([oN({type:x.BitString,context:1,optional:!0})],lm.prototype,"publicKey",void 0);class lb{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.Integer,converter:on})],lb.prototype,"r",void 0),oH([oN({type:x.Integer,converter:on})],lb.prototype,"s",void 0);let lw="1.2.840.113549.1.1",lA=`${lw}.1`,lS=`${lw}.7`,lB=`${lw}.9`,lx=`${lw}.10`,lE=`${lw}.2`,lk=`${lw}.4`,lC=`${lw}.5`,lO=`${lw}.14`,lI=`${lw}.11`,lN=`${lw}.12`,lT=`${lw}.13`,lU=`${lw}.15`,lj=`${lw}.16`,lP="1.3.14.3.2.26",lR="2.16.840.1.101.3.4.2.4",lH="2.16.840.1.101.3.4.2.1",lD="2.16.840.1.101.3.4.2.2",l_="2.16.840.1.101.3.4.2.3",lV=`${lw}.8`;function lL(e){return new sZ({algorithm:e,parameters:null})}lL("1.2.840.113549.2.2"),lL("1.2.840.113549.2.5");let lM=lL(lP);lL(lR),lL(lH),lL(lD),lL(l_),lL("2.16.840.1.101.3.4.2.5"),lL("2.16.840.1.101.3.4.2.6");let lF=new sZ({algorithm:lV,parameters:oR.serialize(lM)}),l$=new sZ({algorithm:lB,parameters:oR.serialize(ol.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});lL(lA),lL(lE),lL(lk),lL(lC),lL(lU),lL(lj),lL(lN),lL(lT),lL(lU),lL(lj);class lz{constructor(e={}){this.hashAlgorithm=new sZ(lM),this.maskGenAlgorithm=new sZ({algorithm:lV,parameters:oR.serialize(lM)}),this.pSourceAlgorithm=new sZ(l$),Object.assign(this,e)}}oH([oN({type:sZ,context:0,defaultValue:lM})],lz.prototype,"hashAlgorithm",void 0),oH([oN({type:sZ,context:1,defaultValue:lF})],lz.prototype,"maskGenAlgorithm",void 0),oH([oN({type:sZ,context:2,defaultValue:l$})],lz.prototype,"pSourceAlgorithm",void 0),new sZ({algorithm:lS,parameters:oR.serialize(new lz)});class lq{constructor(e={}){this.hashAlgorithm=new sZ(lM),this.maskGenAlgorithm=new sZ({algorithm:lV,parameters:oR.serialize(lM)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}oH([oN({type:sZ,context:0,defaultValue:lM})],lq.prototype,"hashAlgorithm",void 0),oH([oN({type:sZ,context:1,defaultValue:lF})],lq.prototype,"maskGenAlgorithm",void 0),oH([oN({type:x.Integer,context:2,defaultValue:20})],lq.prototype,"saltLength",void 0),oH([oN({type:x.Integer,context:3,defaultValue:1})],lq.prototype,"trailerField",void 0),new sZ({algorithm:lx,parameters:oR.serialize(new lq)});class lK{constructor(e={}){this.digestAlgorithm=new sZ,this.digest=new oe,Object.assign(this,e)}}oH([oN({type:sZ})],lK.prototype,"digestAlgorithm",void 0),oH([oN({type:oe})],lK.prototype,"digest",void 0);class lW{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.Integer,converter:on})],lW.prototype,"prime",void 0),oH([oN({type:x.Integer,converter:on})],lW.prototype,"exponent",void 0),oH([oN({type:x.Integer,converter:on})],lW.prototype,"coefficient",void 0);let lG=el=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,el.prototype)}};lG=el=oH([oI({type:B.Sequence,itemType:lW})],lG);class lZ{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.Integer})],lZ.prototype,"version",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"modulus",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"publicExponent",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"privateExponent",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"prime1",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"prime2",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"exponent1",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"exponent2",void 0),oH([oN({type:x.Integer,converter:on})],lZ.prototype,"coefficient",void 0),oH([oN({type:lG,optional:!0})],lZ.prototype,"otherPrimeInfos",void 0);class lJ{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.Integer,converter:on})],lJ.prototype,"modulus",void 0),oH([oN({type:x.Integer,converter:on})],lJ.prototype,"publicExponent",void 0),(y=eu||(eu={}))[y.Transient=0]="Transient",y[y.Singleton=1]="Singleton",y[y.ResolutionScoped=2]="ResolutionScoped",y[y.ContainerScoped=3]="ContainerScoped";let lY=eu;var lQ=function(e,t){return(lQ=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function lX(e,t){function r(){this.constructor=e}lQ(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function l0(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l1(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function l2(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l1(arguments[t]));return e}function l8(e){return!!e.useClass}function l3(e){return!!e.useFactory}var l5=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler(function(){return i||(t=e(r.wrap()),i=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]=e(),Reflect[r].apply(void 0,l2(t))}}),t},e}();function l6(e){return"string"==typeof e||"symbol"==typeof e}function l4(e){return"object"==typeof e&&"token"in e&&"transform"in e}function l9(e){return!!e.useToken}function l7(e){return void 0!=e.useValue}var ue=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lX(t,e),t}(ue);let ur=function(){this.scopedResolutions=new Map};var ui=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lX(t,e),t}(ue),un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lX(t,e),t}(ue);let uo=function(){this.preResolution=new ui,this.postResolution=new un};var us=new Map,ua=new(function(){function e(e){this.parent=e,this._registry=new ut,this.interceptors=new uo,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){if(void 0===r&&(r={lifecycle:lY.Transient}),this.ensureNotDisposed(),i=l8(t)||l7(t)||l9(t)||l3(t)?t:{useClass:t},l9(i))for(var i,n=[e],o=i;null!=o;){var s=o.useToken;if(n.includes(s))throw Error("Token registration cycle detected! "+l2(n,[s]).join(" -> "));n.push(s);var a=this._registry.get(s);o=a&&l9(a.provider)?a.provider:null}if((r.lifecycle===lY.Singleton||r.lifecycle==lY.ContainerScoped||r.lifecycle==lY.ResolutionScoped)&&(l7(i)||l3(i)))throw Error('Cannot use lifecycle "'+lY[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),l6(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),l6(e)){if(l6(t))return this.register(e,{useToken:t},{lifecycle:lY.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:lY.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!l6(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:lY.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new ur),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&l6(e)){if(r)return;throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if("function"==typeof e||e instanceof l5){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var n=[];try{for(var o=l0(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&n.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,n)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,n;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=l0(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var l=a.value;"Once"!=l.options.frequency&&o.push(l),l.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===lY.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===lY.Singleton,n=e.options.lifecycle===lY.ContainerScoped,o=i||n;return r=l7(e.provider)?e.provider.useValue:l9(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):l8(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):l3(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===lY.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var i=this;void 0===t&&(t=new ur),void 0===r&&(r=!1),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&l6(e)){if(r)return[];throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),n){var o=n.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,o,"All"),o}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=l0(this._registry.entries()),i=r.next();!i.done;i=r.next()){var n=l1(i.value,2),o=n[0],s=n[1];this._registry.setAll(o,s.filter(function(e){return!l7(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,r,i=new e(this);try{for(var n=l0(this._registry.entries()),o=n.next();!o.done;o=n.next()){var s=l1(o.value,2),a=s[0],l=s[1];l.some(function(e){return e.options.lifecycle===lY.ContainerScoped})&&i._registry.setAll(a,l.map(function(e){return e.options.lifecycle===lY.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function(){var e;return function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){var l=[o,a];if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&l[0]?i.return:l[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,l[1])).done)return n;switch(i=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,i=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){s=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){s.label=l[1];break}if(6===l[0]&&s.label<n[1]){s.label=n[1],n=l;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(l);break}n[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],i=0}finally{r=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var r=t.dispose();r&&e.push(r)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof l5)return e.createProxy(function(e){return r.resolve(e,t)});var i=function(){var i=us.get(e);if(!i||0===i.length)if(0===e.length)return new e;else throw Error('TypeInfo not known for "'+e.name+'"');var n=i.map(r.resolveParams(t,e));return new(e.bind.apply(e,l2([void 0],n)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(i,n){var o,s,a,l,u,c,f;try{if("object"==typeof i&&"token"in i&&"multiple"in i)if(l4(i))return i.multiple?(o=r.resolve(i.transform)).transform.apply(o,l2([r.resolveAll(i.token,new ur,i.isOptional)],i.transformArgs)):(s=r.resolve(i.transform)).transform.apply(s,l2([r.resolve(i.token,e,i.isOptional)],i.transformArgs));else return i.multiple?r.resolveAll(i.token,new ur,i.isOptional):r.resolve(i.token,e,i.isOptional);if(l4(i))return(a=r.resolve(i.transform,e)).transform.apply(a,l2([r.resolve(i.token,e)],i.transformArgs));return r.resolve(i,e)}catch(e){throw Error((c="Cannot inject the dependency "+(u=void 0===(l=l1(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:l,null===u?"at position #"+n:'"'+u.split(",")[n].trim()+'" at position #'+n)+' of "'+t.name+'" constructor. Reason:',void 0===f&&(f="    "),l2([c],e.message.split("\n").map(function(e){return f+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}());let ul=function(e){return function(t){var r,i;us.set(t,(r=Reflect.getMetadata("design:paramtypes",t)||[],Object.keys(i=Reflect.getOwnMetadata("injectionTokens",t)||{}).forEach(function(e){r[+e]=i[e]}),r)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach(function(e){ua.register(e,t)}):ua.register(e.token,t))}};if(e.s([],568370),"u"<typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");e.i(568370);class uu{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}oH([oN({type:x.ObjectIdentifier})],uu.prototype,"attrId",void 0),oH([oN({type:x.Any,repeated:"set"})],uu.prototype,"attrValues",void 0);let uc=ec=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ec.prototype)}};uc=ec=oH([oI({type:B.Sequence,itemType:uu})],uc);let uf=ef=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ef.prototype)}};uf=ef=oH([oI({type:B.Sequence,itemType:aP})],uf);class uh{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],uh.prototype,"certId",void 0),oH([oN({type:x.Any,context:0})],uh.prototype,"certValue",void 0);class up{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],up.prototype,"crlId",void 0),oH([oN({type:x.Any,context:0})],up.prototype,"crltValue",void 0);class ud extends oe{}class uy{constructor(e={}){this.encryptionAlgorithm=new sZ,this.encryptedData=new ud,Object.assign(this,e)}}oH([oN({type:sZ})],uy.prototype,"encryptionAlgorithm",void 0),oH([oN({type:ud})],uy.prototype,"encryptedData",void 0),(g=ep||(ep={}))[g.v1=0]="v1";class ug extends oe{}let uv=eh=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,eh.prototype)}};uv=eh=oH([oI({type:B.Sequence,itemType:sM})],uv);class um{constructor(e={}){this.version=ep.v1,this.privateKeyAlgorithm=new sZ,this.privateKey=new ug,Object.assign(this,e)}}oH([oN({type:x.Integer})],um.prototype,"version",void 0),oH([oN({type:sZ})],um.prototype,"privateKeyAlgorithm",void 0),oH([oN({type:ug})],um.prototype,"privateKey",void 0),oH([oN({type:uv,implicit:!0,context:0,optional:!0})],um.prototype,"attributes",void 0);let ub=class extends um{};ub=oH([oI({type:B.Sequence})],ub);let uw=class extends uy{};uw=oH([oI({type:B.Sequence})],uw);class uA{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],uA.prototype,"secretTypeId",void 0),oH([oN({type:x.Any,context:0})],uA.prototype,"secretValue",void 0);class uS{constructor(e={}){this.mac=new lK,this.macSalt=new oe,this.iterations=1,Object.assign(this,e)}}oH([oN({type:lK})],uS.prototype,"mac",void 0),oH([oN({type:oe})],uS.prototype,"macSalt",void 0),oH([oN({type:x.Integer,defaultValue:1})],uS.prototype,"iterations",void 0);class uB{constructor(e={}){this.version=3,this.authSafe=new aP,this.macData=new uS,Object.assign(this,e)}}oH([oN({type:x.Integer})],uB.prototype,"version",void 0),oH([oN({type:aP})],uB.prototype,"authSafe",void 0),oH([oN({type:uS,optional:!0})],uB.prototype,"macData",void 0);class ux{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:x.ObjectIdentifier})],ux.prototype,"bagId",void 0),oH([oN({type:x.Any,context:0})],ux.prototype,"bagValue",void 0),oH([oN({type:uu,repeated:"set",optional:!0})],ux.prototype,"bagAttributes",void 0);let uE=ed=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ed.prototype)}};uE=ed=oH([oI({type:B.Sequence,itemType:ux})],uE);let uk="1.2.840.113549.1.9",uC=`${uk}.7`,uO=`${uk}.14`,uI=class extends o_{constructor(e={}){super(e)}toString(){return({}).toString(),this.ia5String||super.toString()}};oH([oN({type:x.IA5String})],uI.prototype,"ia5String",void 0),uI=oH([oI({type:B.Choice})],uI);let uN=class extends aP{};uN=oH([oI({type:B.Sequence})],uN);let uT=class extends uB{};uT=oH([oI({type:B.Sequence})],uT);let uU=class extends uy{};uU=oH([oI({type:B.Sequence})],uU);let uj=class{constructor(e=""){this.value=e}toString(){return this.value}};oH([oN({type:x.IA5String})],uj.prototype,"value",void 0),uj=oH([oI({type:B.Choice})],uj);let uP=class extends uI{};uP=oH([oI({type:B.Choice})],uP);let uR=class extends o_{};uR=oH([oI({type:B.Choice})],uR);let uH=class{constructor(e=new Date){this.value=e}};oH([oN({type:x.GeneralizedTime})],uH.prototype,"value",void 0),uH=oH([oI({type:B.Choice})],uH);let uD=class extends o_{};uD=oH([oI({type:B.Choice})],uD);let u_=class{constructor(e="M"){this.value=e}toString(){return this.value}};oH([oN({type:x.PrintableString})],u_.prototype,"value",void 0),u_=oH([oI({type:B.Choice})],u_);let uV=class{constructor(e=""){this.value=e}toString(){return this.value}};oH([oN({type:x.PrintableString})],uV.prototype,"value",void 0),uV=oH([oI({type:B.Choice})],uV);let uL=class extends uV{};uL=oH([oI({type:B.Choice})],uL);let uM=class extends o_{};uM=oH([oI({type:B.Choice})],uM);let uF=class{constructor(e=""){this.value=e}toString(){return this.value}};oH([oN({type:x.ObjectIdentifier})],uF.prototype,"value",void 0),uF=oH([oI({type:B.Choice})],uF);let u$=class extends sY{};u$=oH([oI({type:B.Choice})],u$);let uz=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};oH([oN({type:x.Integer})],uz.prototype,"value",void 0),uz=oH([oI({type:B.Choice})],uz);let uq=class extends ao{};uq=oH([oI({type:B.Sequence})],uq);let uK=class extends o_{};uK=oH([oI({type:B.Choice})],uK);let uW=ey=class extends s0{constructor(e){super(e),Object.setPrototypeOf(this,ey.prototype)}};uW=ey=oH([oI({type:B.Sequence})],uW);let uG=eg=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,eg.prototype)}};uG=eg=oH([oI({type:B.Set,itemType:an})],uG);let uZ=class{constructor(e=""){this.value=e}toString(){return this.value}};oH([oN({type:x.BmpString})],uZ.prototype,"value",void 0),uZ=oH([oI({type:B.Choice})],uZ);let uJ=class extends sZ{};uJ=oH([oI({type:B.Sequence})],uJ);let uY=ev=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,ev.prototype)}};uY=ev=oH([oI({type:B.Sequence,itemType:uJ})],uY);let uQ=em=class extends oP{constructor(e){super(e),Object.setPrototypeOf(this,em.prototype)}};uQ=em=oH([oI({type:B.Sequence,itemType:sM})],uQ);class uX{constructor(e={}){this.version=0,this.subject=new o$,this.subjectPKInfo=new sJ,this.attributes=new uQ,Object.assign(this,e)}}oH([oN({type:x.Integer})],uX.prototype,"version",void 0),oH([oN({type:o$})],uX.prototype,"subject",void 0),oH([oN({type:sJ})],uX.prototype,"subjectPKInfo",void 0),oH([oN({type:uQ,implicit:!0,context:0,optional:!0})],uX.prototype,"attributes",void 0);class u0{constructor(e={}){this.certificationRequestInfo=new uX,this.signatureAlgorithm=new sZ,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}oH([oN({type:uX,raw:!0})],u0.prototype,"certificationRequestInfo",void 0),oH([oN({type:sZ})],u0.prototype,"signatureAlgorithm",void 0),oH([oN({type:x.BitString})],u0.prototype,"signature",void 0);let u1="crypto.algorithm",u2="crypto.algorithmProvider";ua.registerSingleton(u2,class{getAlgorithms(){return ua.resolveAll(u1)}toAsnAlgorithm(e){for(let t of({...e},this.getAlgorithms())){let r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){let t=new sZ({algorithm:e.name});return"parameters"in e&&(t.parameters=e.parameters),t}throw Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let t of this.getAlgorithms()){let r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});let u8="1.3.36.3.3.2.8.1.1",u3=`${u8}.1`,u5=`${u8}.2`,u6=`${u8}.3`,u4=`${u8}.4`,u9=`${u8}.5`,u7=`${u8}.6`,ce=`${u8}.7`,ct=`${u8}.8`,cr=`${u8}.9`,ci=`${u8}.10`,cn=`${u8}.11`,co=`${u8}.12`,cs=`${u8}.13`,ca=`${u8}.14`,cl="brainpoolP160r1",cu="brainpoolP160t1",cc="brainpoolP192r1",cf="brainpoolP192t1",ch="brainpoolP224r1",cp="brainpoolP224t1",cd="brainpoolP256r1",cy="brainpoolP256t1",cg="brainpoolP320r1",cv="brainpoolP320t1",cm="brainpoolP384r1",cb="brainpoolP384t1",cw="brainpoolP512r1",cA="brainpoolP512t1",cS="ECDSA",cB=eb=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===cS.toLowerCase()){if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return lc;case"sha-256":return lf;case"sha-384":return lh;case"sha-512":return lp}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=ls;break;case"K-256":t=eb.SECP256K1;break;case"P-384":t=la;break;case"P-521":t=ll;break;case cl:t=u3;break;case cu:t=u5;break;case cc:t=u6;break;case cf:t=u4;break;case ch:t=u9;break;case cp:t=u7;break;case cd:t=ce;break;case cy:t=ct;break;case cg:t=cr;break;case cv:t=ci;break;case cm:t=cn;break;case cb:t=co;break;case cw:t=cs;break;case cA:t=ca}if(t)return new sZ({algorithm:le,parameters:oR.serialize(new lv({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case lt:return{name:cS,hash:{name:"SHA-1"}};case li:return{name:cS,hash:{name:"SHA-256"}};case ln:return{name:cS,hash:{name:"SHA-384"}};case lo:return{name:cS,hash:{name:"SHA-512"}};case le:if(!e.parameters)throw TypeError("Cannot get required parameters from EC algorithm");switch(oR.parse(e.parameters,lv).namedCurve){case ls:return{name:cS,namedCurve:"P-256"};case eb.SECP256K1:return{name:cS,namedCurve:"K-256"};case la:return{name:cS,namedCurve:"P-384"};case ll:return{name:cS,namedCurve:"P-521"};case u3:return{name:cS,namedCurve:cl};case u5:return{name:cS,namedCurve:cu};case u6:return{name:cS,namedCurve:cc};case u4:return{name:cS,namedCurve:cf};case u9:return{name:cS,namedCurve:ch};case u7:return{name:cS,namedCurve:cp};case ce:return{name:cS,namedCurve:cd};case ct:return{name:cS,namedCurve:cy};case cr:return{name:cS,namedCurve:cg};case ci:return{name:cS,namedCurve:cv};case cn:return{name:cS,namedCurve:cm};case co:return{name:cS,namedCurve:cb};case cs:return{name:cS,namedCurve:cw};case ca:return{name:cS,namedCurve:cA}}}return null}};cB.SECP256K1="1.3.132.0.10",cB=eb=oH([ul()],cB),ua.registerSingleton(u1,cB);let cx=Symbol("name"),cE=Symbol("value");class ck{constructor(e,t={},r=""){for(const i in this[cx]=e,this[cE]=r,t)this[i]=t[i]}}ck.NAME=cx,ck.VALUE=cE;class cC{static toString(e){let t=this.items[e];return t||e}}cC.items={[lP]:"sha1",[lR]:"sha224",[lH]:"sha256",[lD]:"sha384",[l_]:"sha512",[lA]:"rsaEncryption",[lC]:"sha1WithRSAEncryption",[lO]:"sha224WithRSAEncryption",[lI]:"sha256WithRSAEncryption",[lN]:"sha384WithRSAEncryption",[lT]:"sha512WithRSAEncryption",[le]:"ecPublicKey",[lt]:"ecdsaWithSHA1",[lr]:"ecdsaWithSHA224",[li]:"ecdsaWithSHA256",[ln]:"ecdsaWithSHA384",[lo]:"ecdsaWithSHA512",[sS]:"TLS WWW server authentication",[sB]:"TLS WWW client authentication",[sx]:"Code Signing",[sE]:"E-mail Protection",[sk]:"Time Stamping",[sC]:"OCSP Signing",[a4]:"Signed Data"};class cO{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){let r=[],i=this.pad(t++),n="",o=e[ck.VALUE];for(let s in o&&(n=` ${o}`),r.push(`${i}${e[ck.NAME]}:${n}`),i=this.pad(t),e){if("symbol"==typeof s)continue;let n=e[s],o=s?`${s}: `:"";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)r.push(`${i}${o}${n}`);else if(n instanceof Date)r.push(`${i}${o}${n.toUTCString()}`);else if(Array.isArray(n))for(let e of n)e[ck.NAME]=s,r.push(...this.serializeObj(e,t));else if(n instanceof ck)n[ck.NAME]=s,r.push(...this.serializeObj(n,t));else if(iF.BufferSourceConverter.isBufferSource(n))s?(r.push(`${i}${o}`),r.push(...this.serializeBufferSource(n,t+1))):r.push(...this.serializeBufferSource(n,t));else if("toTextObject"in n){let e=n.toTextObject();e[ck.NAME]=s,r.push(...this.serializeObj(e,t))}else throw TypeError("Cannot serialize data in text format. Unsupported type.")}return r}static serializeBufferSource(e,t=0){let r=this.pad(t),i=iF.BufferSourceConverter.toUint8Array(e),n=[];for(let e=0;e<i.length;){let t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");let n=i[e++].toString(16).padStart(2,"0");t.push(n)}n.push(`${r}${t.join(" ")}`)}return n}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}cO.oidSerializer=cC,cO.algorithmSerializer=class{static toTextObject(e){let t=new ck("Algorithm Identifier",{},cC.toString(e.algorithm));if(e.parameters)if(e.algorithm===le){let r=new cB().toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters}else t.Parameters=e.parameters;return t}};class cI{constructor(...e){if(1===e.length){const t=e[0];this.rawData=oR.serialize(t),this.onInit(t)}else{const t=oR.parse(e[0],e[1]);this.rawData=iF.BufferSourceConverter.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof cI&&(0,iF.isEqual)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return oR.toString(this.rawData);case"text":return cO.serialize(this.toTextObject());case"hex":return iF.Convert.ToHex(this.rawData);case"base64":return iF.Convert.ToBase64(this.rawData);case"base64url":return iF.Convert.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new ck(this.getTextName(),{},e)}}cI.NAME="ASN";class cN extends cI{constructor(...e){super(iF.BufferSourceConverter.isBufferSource(e[0])?iF.BufferSourceConverter.toArrayBuffer(e[0]):oR.serialize(new sX({extnID:e[0],critical:e[1],extnValue:new oe(iF.BufferSourceConverter.toArrayBuffer(e[2]))})),sX)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[ck.NAME]===cN.NAME&&(e[ck.NAME]=cC.toString(this.type)),e}}class cT{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[ew]="CryptoProvider","u">typeof self&&"u">typeof crypto?this.set(cT.DEFAULT,crypto):e.g.crypto&&e.g.crypto.subtle&&this.set(cT.DEFAULT,e.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=cT.DEFAULT){let t=this.items.get(e.toLowerCase());if(!t)throw Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(cT.DEFAULT,e);return this}}ew=Symbol.toStringTag,cT.DEFAULT="default";let cU=new cT,cj=/^[0-2](?:\.[1-9][0-9]*)+$/;class cP{constructor(e={}){for(const t in this.items={},e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return new RegExp(cj).test(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}let cR=new cP;function cH(e,t){return`\\${iF.Convert.ToHex(iF.Convert.FromUtf8String(t)).toUpperCase()}`}cR.register("CN","2.5.4.3"),cR.register("L","2.5.4.7"),cR.register("ST","2.5.4.8"),cR.register("O","2.5.4.10"),cR.register("OU","2.5.4.11"),cR.register("C","2.5.4.6"),cR.register("DC","0.9.2342.19200300.100.1.25"),cR.register("E","1.2.840.113549.1.9.1"),cR.register("G","2.5.4.42"),cR.register("I","2.5.4.43"),cR.register("SN","2.5.4.4"),cR.register("T","2.5.4.12");class cD{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){for(const e in this.extraNames=new cP,this.asn=new o$,t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof o$?this.asn=e:iF.BufferSourceConverter.isBufferSource(e)?this.asn=oR.parse(e,o$):this.asn=this.fromJSON(e)}getField(e){let t=this.extraNames.findId(e)||cR.findId(e),r=[];for(let e of this.asn)for(let i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||cR.get(e)}toString(){return this.asn.map(e=>e.map(e=>{let t=this.getName(e.type)||e.type,r=e.value.anyValue?`#${iF.Convert.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,cH);return`${t}=${r}`}).join("+")).join(", ")}toJSON(){let e=[];for(let t of this.asn){let r={};for(let e of t){let t=this.getName(e.type)||e.type;null!=r[t]||(r[t]=[]),r[t].push(e.value.anyValue?`#${iF.Convert.ToHex(e.value.anyValue)}`:e.value.toString())}e.push(r)}return e}fromString(e){let t=new o$,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,i=null,n=",";for(;i=r.exec(`${e},`);){let[,e,r]=i,o=r[r.length-1];(","===o||"+"===o)&&(r=r.slice(0,r.length-1),i[3]=o);let s=i[3];e=this.getTypeOid(e);let a=this.createAttribute(e,r);"+"===n?t[t.length-1].push(a):t.push(new oM([a])),n=s}return t}fromJSON(e){let t=new o$;for(let r of e){let e=new oM;for(let t in r){let i=this.getTypeOid(t);for(let n of r[t]){let t=this.createAttribute(i,n);e.push(t)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){let r=new oL({type:e});if("object"==typeof t)for(let e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=iF.Convert.FromHex(t.slice(1));else{let i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:cD.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){let t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return oR.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||cU.get():(i=e[0]||i,r=e[1]||cU.get()),await r.subtle.digest(i,this.toArrayBuffer())}}let c_="Cannot initialize GeneralName from ASN.1 data.",cV=`${c_} Unsupported string format in use.`,cL=`${c_} Value doesn't match to GUID regular expression.`,cM=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,cF="1.3.6.1.4.1.311.25.1",c$="1.3.6.1.4.1.311.20.2.3",cz="email",cq="guid";class cK extends cI{constructor(...e){let t;if(2===e.length)switch(e[0]){case"dn":{const r=new cD(e[1]).toArrayBuffer(),i=oR.parse(r,o$);t=new oK({directoryName:i});break}case"dns":t=new oK({dNSName:e[1]});break;case cz:t=new oK({rfc822Name:e[1]});break;case cq:{const r=RegExp(cM,"i").exec(e[1]);if(!r)throw Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map((e,t)=>t<3?iF.Convert.ToHex(new Uint8Array(iF.Convert.FromHex(e)).reverse()):e).join("");t=new oK({otherName:new oz({typeId:cF,value:oR.serialize(new oe(iF.Convert.FromHex(i)))})});break}case"ip":t=new oK({iPAddress:e[1]});break;case"id":t=new oK({registeredID:e[1]});break;case"upn":t=new oK({otherName:new oz({typeId:c$,value:oR.serialize(oc.toASN(e[1]))})});break;case"url":t=new oK({uniformResourceIdentifier:e[1]});break;default:throw Error("Cannot create GeneralName. Unsupported type of the name")}else t=iF.BufferSourceConverter.isBufferSource(e[0])?oR.parse(e[0],oK):e[0];super(t)}onInit(e){if(void 0!=e.dNSName)this.type="dns",this.value=e.dNSName;else if(void 0!=e.rfc822Name)this.type=cz,this.value=e.rfc822Name;else if(void 0!=e.iPAddress)this.type="ip",this.value=e.iPAddress;else if(void 0!=e.uniformResourceIdentifier)this.type="url",this.value=e.uniformResourceIdentifier;else if(void 0!=e.registeredID)this.type="id",this.value=e.registeredID;else if(void 0!=e.directoryName)this.type="dn",this.value=new cD(e.directoryName).toString();else if(void 0!=e.otherName)if(e.otherName.typeId===cF){this.type=cq;let t=oR.parse(e.otherName.value,oe),r=RegExp(cM,"i").exec(iF.Convert.ToHex(t));if(!r)throw Error(cL);this.value=r.slice(1).map((e,t)=>t<3?iF.Convert.ToHex(new Uint8Array(iF.Convert.FromHex(e)).reverse()):e).join("-")}else if(e.otherName.typeId===c$)this.type="upn",this.value=oR.parse(e.otherName.value,o_).toString();else throw Error(cV);else throw Error(cV)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case"dn":case"dns":case cq:case"ip":case"id":case"upn":case"url":e=this.type.toUpperCase();break;case cz:e="Email";break;default:throw Error("Unsupported GeneralName type")}let t=this.value;return"id"===this.type&&(t=cC.toString(t)),new ck(e,void 0,t)}}class cW extends cI{constructor(e){let t;if(e instanceof se)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof oK)r.push(t);else{const e=oR.parse(new cK(t.type,t.value).rawData,oK);r.push(e)}t=new se(r)}else if(iF.BufferSourceConverter.isBufferSource(e))t=oR.parse(e,se);else throw Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){let t=[];for(let r of e){let e=null;try{e=new cK(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let t of this.items){let r=t.toTextObject(),i=e[r[ck.NAME]];Array.isArray(i)||(i=[],e[r[ck.NAME]]=i),i.push(r)}return e}}cW.NAME="GeneralNames";let cG="-{5}",cZ=`[^\\n]+`,cJ=`${cG}BEGIN (${cZ}(?=${cG}))${cG}`,cY=`${cG}END \\1${cG}`,cQ=`[^:\\n]+`,cX=`(?:[^\\n]+\\n(?: +[^\\n]+\\n)*)`,c0=`(?:[a-zA-Z0-9=+/]+\\n)+`,c1=`${cJ}\\n(?:((?:${cQ}: ${cX})+))?\\n?(${c0})${cY}`;class c2{static isPem(e){return"string"==typeof e&&RegExp(c1,"g").test(e)}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let t=RegExp(c1,"g"),r=[],i=null;for(;i=t.exec(e);){let e=i[3].replace(RegExp(`[\\n]+`,"g"),""),t={type:i[1],headers:[],rawData:iF.Convert.FromBase64(e)},n=i[2];if(n){let e=n.split(RegExp("\\n","g")),r=null;for(let i of e){let[e,n]=i.split(/:(.*)/);if(void 0===n){if(!r)throw Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:n.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map(e=>e.rawData)}static decodeFirst(e){let t=this.decode(e);if(!t.length)throw RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){let r=[];return t?e.forEach(e=>{if(!iF.BufferSourceConverter.isBufferSource(e))throw TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:iF.BufferSourceConverter.toArrayBuffer(e)}))}):e.forEach(e=>{if(!("type"in e))throw TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))}),r.join("\n")}if(!t)throw Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:iF.BufferSourceConverter.toArrayBuffer(e)})}static encodeStruct(e){var t;let r,i=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${i}-----`),null==(t=e.headers)?void 0:t.length){for(let t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}let o=iF.Convert.ToBase64(e.rawData),s=0,a=[];for(;s<o.length;)if(o.length-s<64?r=o.substring(s):(r=o.substring(s,s+64),s+=64),0!==r.length){if(a.push(r),r.length<64)break}else break;return n.push(...a),n.push(`-----END ${i}-----`),n.join("\n")}}c2.CertificateTag="CERTIFICATE",c2.CrlTag="CRL",c2.CertificateRequestTag="CERTIFICATE REQUEST",c2.PublicKeyTag="PUBLIC KEY",c2.PrivateKeyTag="PRIVATE KEY";class c8 extends cI{static isAsnEncoded(e){return iF.BufferSourceConverter.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e)if(c2.isPem(e))return c2.decode(e)[0];else if(iF.Convert.isHex(e))return iF.Convert.FromHex(e);else if(iF.Convert.isBase64(e))return iF.Convert.FromBase64(e);else if(iF.Convert.isBase64Url(e))return iF.Convert.FromBase64Url(e);else throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url");{let t=iF.Convert.ToBinary(e);if(c2.isPem(t))return c2.decode(t)[0];if(iF.Convert.isHex(t))return iF.Convert.FromHex(t);if(iF.Convert.isBase64(t))return iF.Convert.FromBase64(t);else if(iF.Convert.isBase64Url(t))return iF.Convert.FromBase64Url(t);return iF.BufferSourceConverter.toArrayBuffer(e)}}constructor(...e){c8.isAsnEncoded(e[0])?super(c8.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?c2.encode(this.rawData,this.tag):super.toString(e)}}class c3 extends c8{static async create(e,t=cU.get()){if(e instanceof c3)return e;if(cT.isCryptoKey(e)){if("public"!==e.type)throw TypeError("Public key is required");return new c3(await t.subtle.exportKey("spki",e))}if(e.publicKey)return e.publicKey;if(iF.BufferSourceConverter.isBufferSource(e))return new c3(e);throw TypeError("Unsupported PublicKeyType")}constructor(e){c8.isAsnEncoded(e)?super(e,sJ):super(e),this.tag=c2.PublicKeyTag}async export(...e){var t;let r,i=["verify"],n={hash:"SHA-256",...this.algorithm};e.length>1?(n=e[0]||n,i=e[1]||i,r=e[2]||cU.get()):r=e[0]||cU.get();let o=this.rawData,s=oR.parse(this.rawData,sJ);return s.algorithm.algorithm===lx&&(t=s,t.algorithm=new sZ({algorithm:lA,parameters:null}),o=oR.serialize(t)),r.subtle.importKey("spki",o,n,!0,i)}onInit(e){let t=ua.resolve(u2),r=this.algorithm=t.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===lA){let t=oR.parse(e.subjectPublicKey,lJ),i=iF.BufferSourceConverter.toUint8Array(t.modulus);r.publicExponent=iF.BufferSourceConverter.toUint8Array(t.publicExponent),r.modulusLength=(!i[0]?i.slice(1):i).byteLength<<3}}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||cU.get():(i=e[0]||i,r=e[1]||cU.get()),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=cU.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=cU.get();let i=oR.parse(this.rawData,sJ);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),t=oR.parse(this.rawData,sJ);return e.Algorithm=cO.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===le?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class c5 extends cN{static async create(e,t=!1,r=cU.get()){if("name"in e&&"serialNumber"in e)return new c5(e,t);let i=await c3.create(e,r),n=await i.getKeyIdentifier(r);return new c5(iF.Convert.ToHex(n),t)}constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new o4({keyIdentifier:new o6(iF.Convert.FromHex(e[0]))});super(o5,e[1],oR.serialize(t))}else{const t=e[0],r=new o4({authorityCertIssuer:t.name instanceof cW?oR.parse(t.name.rawData,se):t.name,authorityCertSerialNumber:iF.Convert.FromHex(t.serialNumber)});super(o5,e[1],oR.serialize(r))}}onInit(e){super.onInit(e);let t=oR.parse(e.extnValue,o4);t.keyIdentifier&&(this.keyId=iF.Convert.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?iF.Convert.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),t=oR.parse(this.value,o4);return t.authorityCertIssuer&&(e["Authority Issuer"]=new cW(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}c5.NAME="Authority Key Identifier";class c6 extends cN{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=oR.parse(this.value,o7);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new o7({cA:e[0],pathLenConstraint:e[1]});super(o9,e[2],oR.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}c6.NAME="Basic Constraints",(v=eA||(eA={})).serverAuth="1.3.6.1.5.5.7.3.1",v.clientAuth="1.3.6.1.5.5.7.3.2",v.codeSigning="1.3.6.1.5.5.7.3.3",v.emailProtection="1.3.6.1.5.5.7.3.4",v.timeStamping="1.3.6.1.5.5.7.3.8",v.ocspSigning="1.3.6.1.5.5.7.3.9";class c4 extends cN{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=oR.parse(this.value,sA);this.usages=t.map(e=>e)}else{const t=new sA(e[0]);super(sw,e[1],oR.serialize(t)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(e=>cC.toString(e)).join(", "),e}}c4.NAME="Extended Key Usages",(m=eS||(eS={}))[m.digitalSignature=1]="digitalSignature",m[m.nonRepudiation=2]="nonRepudiation",m[m.keyEncipherment=4]="keyEncipherment",m[m.dataEncipherment=8]="dataEncipherment",m[m.keyAgreement=16]="keyAgreement",m[m.keyCertSign=32]="keyCertSign",m[m.cRLSign=64]="cRLSign",m[m.encipherOnly=128]="encipherOnly",m[m.decipherOnly=256]="decipherOnly";class c9 extends cN{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=oR.parse(this.value,sU);this.usages=t.toNumber()}else{const t=new sU(e[0]);super(sT,e[1],oR.serialize(t)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=oR.parse(this.value,sU);return e[""]=t.toJSON().join(", "),e}}c9.NAME="Key Usages";class c7 extends cN{static async create(e,t=!1,r=cU.get()){let i=await c3.create(e,r),n=await i.getKeyIdentifier(r);return new c7(iF.Convert.ToHex(n),t)}constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=oR.parse(this.value,sz);this.keyId=iF.Convert.ToHex(t)}else{const t="string"==typeof e[0]?iF.Convert.FromHex(e[0]):e[0],r=new sz(t);super(s$,e[1],oR.serialize(r)),this.keyId=iF.Convert.ToHex(t)}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=oR.parse(this.value,sz);return e[""]=t,e}}c7.NAME="Subject Key Identifier";class fe extends cN{constructor(...e){iF.BufferSourceConverter.isBufferSource(e[0])?super(e[0]):super(sV,e[1],new cW(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=oR.parse(e.extnValue,sL);this.names=new cW(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}fe.NAME="Subject Alternative Name";class ft{static register(e,t){this.items.set(e,t)}static create(e){let t=new cN(e),r=this.items.get(t.type);return r?new r(e):t}}ft.items=new Map;class fr extends cN{constructor(...e){var t;if(iF.BufferSourceConverter.isBufferSource(e[0])){super(e[0]);const t=oR.parse(this.value,su);this.policies=t.map(e=>e.policyIdentifier)}else{const r=e[0],i=null!=(t=e[1])&&t,n=new su(r.map(e=>new sl({policyIdentifier:e})));super(sr,i,oR.serialize(n)),this.policies=r}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(e=>new ck("",{},cC.toString(e))),e}}fr.NAME="Certificate Policies",ft.register(sr,fr);class fi extends cN{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&"string"==typeof e[0][0]){const t=e[0].map(e=>new sy({distributionPoint:new sd({fullName:[new oK({uniformResourceIdentifier:e})]})})),r=new sg(t);super(sh,e[1],oR.serialize(r))}else{const t=new sg(e[0]);super(sh,e[1],oR.serialize(t))}null!=this.distributionPoints||(this.distributionPoints=[])}onInit(e){super.onInit(e);let t=oR.parse(e.extnValue,sg);this.distributionPoints=t}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(e=>{var t;let r={};return e.distributionPoint&&(r[""]=null==(t=e.distributionPoint.fullName)?void 0:t.map(e=>new cK(e).toString()).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map(e=>e.toString()).join(", ")),r}),e}}fi.NAME="CRL Distribution Points";class fn extends cN{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof o3){const t=new o3(e[0]);super(o2,e[1],oR.serialize(t))}else{const t=e[0],r=new o3;fs(r,t,oY,"ocsp"),fs(r,t,oQ,"caIssuers"),fs(r,t,oX,"timeStamping"),fs(r,t,o0,"caRepository"),super(o2,e[1],oR.serialize(r))}null!=this.ocsp||(this.ocsp=[]),null!=this.caIssuers||(this.caIssuers=[]),null!=this.timeStamping||(this.timeStamping=[]),null!=this.caRepository||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],oR.parse(e.extnValue,o3).forEach(e=>{switch(e.accessMethod){case oY:this.ocsp.push(new cK(e.accessLocation));break;case oQ:this.caIssuers.push(new cK(e.accessLocation));break;case oX:this.timeStamping.push(new cK(e.accessLocation));break;case o0:this.caRepository.push(new cK(e.accessLocation))}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&fo(e,"OCSP",this.ocsp),this.caIssuers.length&&fo(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&fo(e,"Time Stamping",this.timeStamping),this.caRepository.length&&fo(e,"CA Repository",this.caRepository),e}}function fo(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{let i=new ck("");r.forEach((e,t)=>{let r=e.toTextObject(),n=`${r[ck.NAME]} ${t+1}`,o=i[n];Array.isArray(o)||(o=[],i[n]=o),o.push(r)}),e[t]=i}}function fs(e,t,r,i){let n=t[i];n&&(Array.isArray(n)?n:[n]).forEach(t=>{"string"==typeof t&&(t=new cK("url",t)),e.push(new o8({accessMethod:r,accessLocation:oR.parse(t.rawData,oK)}))})}fn.NAME="Authority Info Access";class fa extends cI{constructor(...e){let t;if(iF.BufferSourceConverter.isBufferSource(e[0]))t=iF.BufferSourceConverter.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map(e=>iF.BufferSourceConverter.toArrayBuffer(e)):[];t=oR.serialize(new sM({type:r,values:i}))}super(t,sM)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(e=>new ck("",{"":e})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[ck.NAME]===fa.NAME&&(e[ck.NAME]=cC.toString(this.type)),e}}fa.NAME="Attribute";class fl extends fa{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{const t=new uK({printableString:e[0]});super(uC,[oR.serialize(t)])}null!=this.password||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let e=oR.parse(this.values[0],uK);this.password=e.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[ck.VALUE]=this.password,e}}fl.NAME="Challenge Password";class fu extends fa{constructor(...e){if(iF.BufferSourceConverter.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new s0;for(const e of t)r.push(oR.parse(e.rawData,sX));super(uO,[oR.serialize(r)])}null!=this.items||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let e=oR.parse(this.values[0],s0);this.items=e.map(e=>ft.create(oR.serialize(e)))}}toTextObject(){let e=this.toTextObjectWithoutValue();for(let t of this.items.map(e=>e.toTextObject()))e[t[ck.NAME]]=t;return e}}fu.NAME="Extensions";class fc{static register(e,t){this.items.set(e,t)}static create(e){let t=new fa(e),r=this.items.get(t.type);return r?new r(e):t}}fc.items=new Map;let ff="crypto.signatureFormatter",fh=eB=class{static createPssParams(e,t){let r=eB.getHashAlgorithm(e);return r?new lq({hashAlgorithm:r,maskGenAlgorithm:new sZ({algorithm:lV,parameters:oR.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){let t=ua.resolve(u2);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new sZ({algorithm:lA,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else if(e.hash&&"object"==typeof e.hash&&"name"in e.hash&&"string"==typeof e.hash.name)t=e.hash.name.toUpperCase();else throw Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new sZ({algorithm:lC,parameters:null});case"sha-256":return new sZ({algorithm:lI,parameters:null});case"sha-384":return new sZ({algorithm:lN,parameters:null});case"sha-512":return new sZ({algorithm:lT,parameters:null})}}break;case"rsa-pss":if(!("hash"in e))return new sZ({algorithm:lx,parameters:null});{if(!("saltLength"in e&&"number"==typeof e.saltLength))throw Error("Cannot get 'saltLength' from 'alg' argument");let t=eB.createPssParams(e.hash,e.saltLength);if(!t)throw Error("Cannot create PSS parameters");return new sZ({algorithm:lx,parameters:oR.serialize(t)})}}return null}toWebAlgorithm(e){switch(e.algorithm){case lA:return{name:"RSASSA-PKCS1-v1_5"};case lC:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case lI:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case lN:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case lT:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case lx:if(!e.parameters)return{name:"RSA-PSS"};{let t=oR.parse(e.parameters,lq);return{name:"RSA-PSS",hash:ua.resolve(u2).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}}return null}};fh=eB=oH([ul()],fh),ua.registerSingleton(u1,fh);let fp=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new sZ({algorithm:lP});case"sha-256":return new sZ({algorithm:lH});case"sha-384":return new sZ({algorithm:lD});case"sha-512":return new sZ({algorithm:l_})}return null}toWebAlgorithm(e){switch(e.algorithm){case lP:return{name:"SHA-1"};case lH:return{name:"SHA-256"};case lD:return{name:"SHA-384"};case l_:return{name:"SHA-512"}}return null}};fp=oH([ul()],fp),ua.registerSingleton(u1,fp);class fd{addPadding(e,t){let r=iF.BufferSourceConverter.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i}removePadding(e,t=!1){let r=iF.BufferSourceConverter.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){let e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){let r=e.namedCurve,i=fd.namedCurveSize.get(r)||fd.defaultNamedCurveSize,n=new lb,o=iF.BufferSourceConverter.toUint8Array(t);return n.r=this.removePadding(o.slice(0,i),!0),n.s=this.removePadding(o.slice(i,i+i),!0),oR.serialize(n)}return null}toWebSignature(e,t){if("ECDSA"===e.name){let r=oR.parse(t,lb),i=e.namedCurve,n=fd.namedCurveSize.get(i)||fd.defaultNamedCurveSize,o=this.addPadding(n,this.removePadding(r.r)),s=this.addPadding(n,this.removePadding(r.s));return(0,iF.combine)(o,s)}return null}}fd.namedCurveSize=new Map,fd.defaultNamedCurveSize=32;let fy="1.3.101.110",fg="1.3.101.111",fv="1.3.101.112",fm="1.3.101.113",fb=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=fv;break;case"x25519":t=fy;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=fv;break;case"ed448":t=fm}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=fy;break;case"x448":t=fg}}return t?new sZ({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case fv:return{name:"Ed25519"};case fm:return{name:"EdDSA",namedCurve:"Ed448"};case fy:return{name:"X25519"};case fg:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};fb=oH([ul()],fb),ua.registerSingleton(u1,fb);class fw extends c8{constructor(e){c8.isAsnEncoded(e)?super(e,s2):super(e),this.tag=c2.CertificateTag}onInit(e){let t=e.tbsCertificate;this.tbs=oR.serialize(t),this.serialNumber=iF.Convert.ToHex(t.serialNumber),this.subjectName=new cD(t.subject),this.subject=new cD(t.subject).toString(),this.issuerName=new cD(t.issuer),this.issuer=this.issuerName.toString();let r=ua.resolve(u2);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;let i=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!i)throw Error("Cannot get 'notBefore' value");this.notBefore=i;let n=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!n)throw Error("Cannot get 'notAfter' value");this.notAfter=n,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map(e=>ft.create(oR.serialize(e)))),this.publicKey=new c3(t.subjectPublicKeyInfo)}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e={},t=cU.get()){let r,i,n=e.publicKey;try{if(n)if("publicKey"in n)r={...n.publicKey.algorithm,...this.signatureAlgorithm},i=await n.publicKey.export(r,["verify"],t);else if(n instanceof c3)r={...n.algorithm,...this.signatureAlgorithm},i=await n.export(r,["verify"],t);else if(iF.BufferSourceConverter.isBufferSource(n)){let e=new c3(n);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...n.algorithm,...this.signatureAlgorithm},i=n;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}let o=ua.resolveAll(ff).reverse(),s=null;for(let e of o)if(s=e.toWebSignature(r,this.signature))break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let a=await t.subtle.verify(this.signatureAlgorithm,i,s,this.tbs);if(e.signatureOnly)return a;{let t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=cU.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=cU.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),t=oR.parse(this.rawData,s2),r=t.tbsCertificate,i=new ck("",{Version:`${K[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":cO.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new ck("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){let e=new ck("");for(let t of this.extensions){let r=t.toTextObject();e[r[ck.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new ck("",{Algorithm:cO.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}fw.NAME="Certificate";class fA extends Array{constructor(e){if(super(),c8.isAsnEncoded(e))this.import(e);else if(e instanceof fw)this.push(e);else if(Array.isArray(e))for(const t of e)this.push(t)}export(e){let t=new a7;t.version=1,t.encapContentInfo.eContentType="1.2.840.113549.1.7.1",t.encapContentInfo.eContent=new aR({single:new oe}),t.certificates=new aj(this.map(e=>new aU({certificate:oR.parse(e.rawData,s2)})));let r=new aP({contentType:a4,content:oR.serialize(t)}),i=oR.serialize(r);return"raw"===e?i:this.toString(e)}import(e){let t=c8.toArrayBuffer(e),r=oR.parse(t,aP);if(r.contentType!==a4)throw TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");let i=oR.parse(r.content,a7);for(let e of(this.clear(),i.certificates||[]))e.certificate&&this.push(new fw(e.certificate))}clear(){for(;this.pop(););}toString(e="pem"){let t=this.export("raw");switch(e){case"pem":return c2.encode(t,"CMS");case"pem-chain":return this.map(e=>e.toString("pem")).join("\n");case"asn":return oR.toString(t);case"hex":return iF.Convert.ToHex(t);case"base64":return iF.Convert.ToBase64(t);case"base64url":return iF.Convert.ToBase64Url(t);case"text":return cO.serialize(this.toTextObject());default:throw TypeError("Argument 'format' is unsupported value")}}toTextObject(){let e=oR.parse(this.export("raw"),aP),t=oR.parse(e.content,a7);return new ck("X509Certificates",{"Content Type":cC.toString(e.contentType),Content:new ck("",{Version:`${W[t.version]} (${t.version})`,Certificates:new ck("",{Certificate:this.map(e=>e.toTextObject())})})})}}class fS{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e,t=cU.get()){let r=new fA(e),i=e;for(;i=await this.findIssuer(i,t);){let e=await i.getThumbprint(t);for(let i of r){let r=await i.getThumbprint(t);if((0,iF.isEqual)(e,r))throw Error("Cannot build a certificate chain. Circular dependency.")}r.push(i)}return r}async findIssuer(e,t=cU.get()){if(!await e.isSelfSigned(t)){let r=e.getExtension(o5);for(let i of this.certificates)if(i.subject===e.issuer){if(r){if(r.keyId){let e=i.getExtension(s$);if(e&&e.keyId!==r.keyId)continue}else if(r.certId){let e=i.getExtension(sV);if(e&&!(r.certId.serialNumber===i.serialNumber&&(0,iF.isEqual)(oR.serialize(r.certId.name),oR.serialize(e))))continue}}try{let r={...i.publicKey.algorithm,...e.signatureAlgorithm},n=await i.publicKey.export(r,["verify"],t);if(!await e.verify({publicKey:n,signatureOnly:!0},t))continue}catch(e){continue}return i}}return null}}(b=ex||(ex={}))[b.unspecified=0]="unspecified",b[b.keyCompromise=1]="keyCompromise",b[b.cACompromise=2]="cACompromise",b[b.affiliationChanged=3]="affiliationChanged",b[b.superseded=4]="superseded",b[b.cessationOfOperation=5]="cessationOfOperation",b[b.certificateHold=6]="certificateHold",b[b.removeFromCRL=8]="removeFromCRL",b[b.privilegeWithdrawn=9]="privilegeWithdrawn",b[b.aACompromise=10]="aACompromise",ft.register(o9,c6),ft.register(sw,c4),ft.register(sT,c9),ft.register(s$,c7),ft.register(o5,c5),ft.register(sV,fe),ft.register(sh,fi),ft.register(o2,fn),fc.register(uC,fl),fc.register(uO,fu),ua.registerSingleton(ff,class{toAsnSignature(e,t){return iF.BufferSourceConverter.toArrayBuffer(t)}toWebSignature(e,t){return iF.BufferSourceConverter.toArrayBuffer(t)}}),ua.registerSingleton(ff,fd),fd.namedCurveSize.set("P-256",32),fd.namedCurveSize.set("K-256",32),fd.namedCurveSize.set("P-384",48),fd.namedCurveSize.set("P-521",66);let fB=async()=>{let e;if("u">typeof globalThis&&globalThis.crypto?.subtle)return e=globalThis.crypto,cU.set(e),e;throw Error("Web Crypto API is not available in this environment. You may need to polyfill it.")};async function fx(e){let t=await fB(),r=await t.subtle.digest("SHA-256",e);return(0,rj.uint8ArrayToHexString)(new Uint8Array(r)).toUpperCase()}async function fE(e){return(await fB()).subtle.importKey("spki",e,{name:"ECDSA",namedCurve:"P-384"},!1,["verify"])}async function fk(e,t){fC(e);let r=Uint8Array.from(atob(t.awsAttestationDocB64).split("").map(e=>e.charCodeAt(0))),i=iM.decode(r.buffer),[,,n]=i,o=iM.decode(new Uint8Array(n).buffer);await fI(i,o.certificate);let s=parseInt(JSON.parse(e.proofPayload).timestampMs);await fO(o.cabundle,rq,o.certificate,s);let a=Uint8Array.from(atob(t.qosManifestB64).split("").map(e=>e.charCodeAt(0))),l=(0,eE.sha256)(a);if(!function(e,t){let r=new Uint8Array(e),i=new Uint8Array(t);if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}(l,o.user_data))throw Error(`attestationDoc's user_data doesn't match the hash of the manifest. attestationDoc.user_data: ${o.user_data} , manifest digest: ${l}`);let u=new Uint8Array(o.public_key),c=(0,rj.uint8ArrayToHexString)(u);if(e.publicKey!==c||c!==t.ephemeralPublicKeyHex)throw Error(`Ephemeral pub keys from app proof: ${e.publicKey}, boot proof structure ${t.ephemeralPublicKeyHex}, and attestation doc ${c} should all match`)}function fC(e){let t,r;if("SIGNATURE_SCHEME_EPHEMERAL_KEY_P256"!==e.scheme)throw Error("Unsupported signature scheme");try{t=(0,rj.uint8ArrayFromHexString)(e.publicKey)}catch{throw Error("Failed to decode public key")}if(130!==t.length)throw Error(`Expected 130 bytes (encryption + signing pub keys), got ${t.length} bytes`);let i=t.slice(65);if(65!==i.length||4!==i[0])throw Error("Invalid signing key format: expected 65-byte uncompressed P-256 point (0x04||X||Y)");try{t_.ProjectivePoint.fromHex(i)}catch(e){throw Error(`Invalid P-256 public key: ${e}`)}try{r=(0,rj.uint8ArrayFromHexString)(e.signature)}catch{throw Error("Failed to decode signature")}if(64!==r.length)throw Error(`Expected 64 bytes signature (r||s), got ${r.length} bytes`);let n=new TextEncoder().encode(e.proofPayload),o=(0,eE.sha256)(n);if(!t_.verify(r,o,i))throw Error("Signature verification failed")}async function fO(e,t,r,i){try{let n=new fw(t),o=new Uint8Array(n.rawData),s=await fx(o);if(s!==rK)throw Error(`Pinned AWS root fingerprint mismatch: expected=${rK} actual=${s}`);let a=e.slice(1).map(e=>{if(!e)throw Error("Invalid certificate data in cabundle");return new fw(e)}),l=new fw(r),u=new fS({certificates:[n,...a]}),c=await u.build(l);if(c.length!==a.length+2)throw Error(`Incorrect number of certs in X509 Chain. Expected ${a.length+2}, got ${c.length}`);let f=new Date(i);for(let e=0;e<c.length;e++){let t=c[e];if(!t)throw Error("Invalid certificate in chain");if(e===c.length-1){if(!await t.verify({publicKey:t.publicKey,date:f}))throw Error("Pinned root failed self-signature verification")}else{let r=c[e+1];if(!r)throw Error("Issuer can't be null");if(!await t.verify({publicKey:r.publicKey,signatureOnly:!0,date:f}))throw Error(`Signature check failed: ${t.subject} not signed by ${r?.subject}`)}}}catch(e){throw Error(`Certificate chain verification failed: ${e instanceof Error?e.message:String(e)}`)}}async function fI(e,t){let[r,,i,n]=e,o=new Uint8Array(iM.encode(["Signature1",new Uint8Array(r),new Uint8Array(0),new Uint8Array(i)])),s=new fw(t),a=await fE(s.publicKey.rawData),l=await fB();if(!await l.subtle.verify({name:"ECDSA",hash:{name:"SHA-384"}},a,new Uint8Array(n),o))throw Error("COSE_Sign1 ES384 verification failed")}e.s(["getCryptoInstance",()=>fB,"verify",()=>fk,"verifyAppProofSignature",()=>fC,"verifyCertificateChain",()=>fO,"verifyCoseSign1Sig",()=>fI],64043),e.s([],284795)}]);

//# debugId=30f2bc1e-5180-b4fc-83c8-b6233eb929a3