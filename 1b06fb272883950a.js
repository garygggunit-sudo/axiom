;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="99085849-41b0-5fe1-5fbc-6bb9513b4701")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,391735,563150,203320,851388,e=>{"use strict";var t=e.i(672464),s=e.i(750214),r=e.i(271645);e.i(490156);var i=e.i(542119),o=e.i(846211),a=e.i(458768),n=e.i(247317),l=e.i(569692),d=e.i(60166),c=e.i(392335),h=e.i(639372),u=e.i(265172);(0,h.atom)(null);let f=(0,u.atomWithStorage)("userLobbySettings",{receiveLobbyToast:!0,toastDuration:1e4,showBalanceInUsd:!1,showBorderWhenFollowing:!0,showBorderWhenFollowed:!0,showLinksAsClickable:!1,showWarningsOnLinks:!0,disableFriendRequestToasts:!1},void 0,{getOnInit:!0});(0,u.atomWithStorage)("lobbyExpandWalletsOnMemberSettings",[],void 0,{getOnInit:!0});let p=(0,u.atomWithStorage)("blacklistLobbyUserLines",[],void 0,{getOnInit:!0}),y=(0,u.atomWithStorage)("lobbyShowAverageLines",{onlyActiveHolders:!1,showLastPositionOnly:!0,showLines:!0,sortBy:"holding"},void 0,{getOnInit:!0}),g=(0,u.atomWithStorage)("lobbyMembersExpanded",!0,void 0,{getOnInit:!0});e.s(["blacklistLobbyUserLinesAtom",0,p,"lobbyAverageLinesSettingsAtom",0,y,"lobbyMembersExpandedAtom",0,g,"userLobbySettingsAtom",0,f],563150);var m=e.i(800473);let b=e=>1===e[0],A=e=>b(e)?e[6]:e[5],x=e=>b(e)?e[14]:e[13],w=(e,t)=>{let s=A(e.transaction),r=A(t.transaction),i=x(e.transaction),o=x(t.transaction);return e.uid===t.uid&&s===r&&i===o},k=(e,t)=>{let s=b(e.transaction),r=(e.transactionCount||1)+(t.transactionCount||1);if(s){let s=e.transaction,i=t.transaction,o=[...s];return o[9]=String(Number.parseFloat(s[9])+Number.parseFloat(i[9])),o[10]=s[10]+i[10],o[11]=s[11]+i[11],o[12]=s[12]+i[12],{...e,transaction:o,transactionCount:r}}let i=e.transaction,o=t.transaction,a=[...i];return a[9]=i[9]+o[9],a[10]=i[10]+o[10],a[11]=i[11]+o[11],a[12]=i[12]+o[12],{...e,transaction:a,transactionCount:r}},v=e=>{if(0===e.length)return e;let t=[];for(let s of e){if("tx"!==s.t){t.push(s);continue}let e=t[t.length-1];e?.t==="tx"&&w(e,s)?t[t.length-1]=k(e,s):t.push(s)}return t};e.s(["coalesceNewTransaction",0,(e,t)=>{if(0===e.length)return[t];let s=e[e.length-1];return"tx"===s.t&&w(s,t)?[...e.slice(0,-1),k(s,t)]:[...e,t]},"coalesceTransactionsAll",0,v],203320);var S=e.i(626335);function I(e){let t=[];for(let r of e)if("feed"===r.t)try{let e=function(e){let t=atob(e),s=new Uint8Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return s}(r.messageMsgpack),s=(0,S.decode)(e);s&&"object"==typeof s&&"t"in s&&("call"===s.t&&(s.feedItemId=r.id),t.push(s))}catch(e){console.error("Failed to decode feed item messagepack:",e)}else if("tx"===r.t)try{var s;let e=(s=r.txJson,Array.isArray(s)&&2===s.length&&(0===s[0]||1===s[0])&&Array.isArray(s[1])?s[1]:s),i=new Date(r.recordedAt).getTime(),o={t:"tx",ts:i,uid:r.profileId,transaction:e,transactionCount:1};t.push(o)}catch(e){console.error("Failed to parse transaction JSON:",e)}return t.sort((e,t)=>e.ts-t.ts)}e.s(["convertFeedToMessages",()=>I],851388),e.s(["useLobbyApi",0,()=>{let e=(0,t.useSetAtom)(c.myLobbyInfoAtom),h=(0,t.useSetAtom)(c.lobbyUserMapAtom),u=(0,s.useAtomCallback)((0,r.useCallback)(e=>e(i.userIdAtom),[])),f=(0,s.useAtomCallback)((0,r.useCallback)(e=>e(l.userProfileIdAtom),[])),y=(0,s.useAtomCallback)((0,r.useCallback)(e=>e(i.usernameAtom),[])),g=(0,t.useSetAtom)(p),b=(0,s.useAtomCallback)((0,r.useCallback)(e=>e(p),[])),A=(0,t.useSetAtom)(c.sharedSolWalletsAtom),x=(0,t.useSetAtom)(d.lobbyChatMessagesAtom),w=(0,t.useSetAtom)(d.messageAuthorsAtom),k=(0,t.useSetAtom)(c.sharedBnbWalletsAtom),S=(0,t.useSetAtom)(m.lobbyAlertsAtom),C=(0,t.useSetAtom)(m.lobbyAlertsCurrentPriceAtom),L=(0,t.useSetAtom)(d.lastChatCursorAtom),M=(0,t.useSetAtom)(m.alertsMigratedAtom),E=(0,t.useSetAtom)(c.followerIdsAtom),U=(0,t.useSetAtom)(c.followedLobbyUserAtom),B=(0,t.useSetAtom)(m.lobbyWalletsAtomSol),P=(0,t.useSetAtom)(m.lobbyWalletsAtomBnb),F=(0,t.useSetAtom)(c.lobbyRequestsAtom),{socialApiGet:$,socialApiPost:R}=(0,o.useRateLimitedSocialApi)(o.socialApiRateLimitAtom),T=(0,r.useCallback)(async()=>{if(y())try{let t=await $("/lobby",void 0,u()??void 0);x([]),w(new Map),e(t),t.messageAuthors&&w(new Map(t.messageAuthors.map(e=>[e.userId,e]))),h(new Map(t.members.map(e=>[e.userProfile.userId,e])));let s=b(),r=new Set(t.members.map(e=>e.userProfile.userId)),i=s.filter(e=>r.has(e));g(i);let o=f(),a=t.members.find(e=>e.userProfile.userId===o);if(a){let e=Object.keys(a.sharedWallets.sol?.sharedWalletBalances||{}),t=Object.keys(a.sharedWallets.bnb?.sharedWalletBalances||{});A(e),k(t)}let n=new Map,l=new Map;for(let e of t.members){let t=Object.keys(e.sharedWallets.sol?.sharedWalletBalances||{}),s=Object.keys(e.sharedWallets.bnb?.sharedWalletBalances||{});for(let s of t)n.set(s,e.userProfile.userId);for(let t of s)l.set(t,e.userProfile.userId)}B(n),P(l);let d=new Map;if(t.activeAlerts){let e=t.activeAlerts.map((e,t)=>({alertId:t,pairAddress:e.pairAddress,tokenAddress:e.tokenAddress,tokenName:e.tokenName,tokenTicker:e.tokenTicker,tokenImage:e.tokenImage,protocol:e.proto,isMigrated:e.isMigrated,callPriceNative:e.priceNative,callMarketCap:e.mc,supply:e.supply,timestamp:e.createdAt,decimals:e.decimals,userId:e.createdByUserId,holderIds:e.boughtInUsers,chain:e.chain,feedItemId:e.feedItemId})).reverse();S(e);let s=new Map;for(let e of t.activeAlerts)s.set(e.tokenAddress,{isMigrated:e.isMigrated,pairAddress:e.pairAddress}),d.set(e.feedItemId,{isMigrated:e.isMigrated,protocol:e.proto,supply:e.supply,pairAddress:e.pairAddress});M(s);let r=new Map;for(let e of t.activeAlerts){let t=r.get(e.pairAddress);t||(t=new Map,r.set(e.pairAddress,t)),t.set(e.feedItemId,{price:e.currentPriceNative,ATH:e.allTimeHighPriceNative})}C(r)}if(t.feed?.items){L(t.feed.nextCursor??null);let e=I(t.feed.items);for(let t of e)if("call"===t.t&&t.feedItemId){let e=d.get(t.feedItemId);e&&(t.isMigrated=e.isMigrated,t.proto=e.protocol,t.tokenSupply=e.supply,t.pairAddress=e.pairAddress)}x(v(e))}let c=t.incomingRequests;c&&c.length>0?F(e=>{let s=new Map(e);return s.set(t.lobbyId,c),s}):F(e=>{let s=new Map(e);return s.delete(t.lobbyId),s})}catch(e){console.error("Failed to fetch lobby:",e),a.default.error(`Failed to load lobby: ${(0,n.getErrorMessage)(e)}`)}},[f,u,y,e,h,b,g,A,k,x,w,S,B,P,C,M,L,F,$]),D=(0,r.useCallback)(async({name:e,lobbyType:t})=>{if(void 0===e&&void 0===t)return void a.default.error("Please provide a name or lobby type to update");try{let s=await R("/lobby/update",{name:e,lobbyType:t},void 0,u()??void 0);"success"===s.status&&a.default.success("Lobby updated")}catch(e){console.error("Failed to update lobby:",e),a.default.error(`Failed to update lobby: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),_=(0,r.useCallback)(async()=>{try{let e=await R("/lobby/leave",{},void 0,u()??void 0);"success"===e.status&&(a.default.success("Left lobby"),E([]),U(null))}catch(e){console.error("Failed to leave lobby:",e),a.default.error(`Failed to leave lobby: ${(0,n.getErrorMessage)(e)}`)}},[u,R,E,U]),z=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/invite",{relationshipId:e},void 0,u()??void 0);"success"===t.status&&a.default.success("Invite sent")}catch(e){console.error("Failed to invite to lobby:",e),a.default.error(`Failed to send invite: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),W=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/accept-invite",{lobbyId:e},void 0,u()??void 0);"success"===t.status&&(E([]),U(null))}catch(e){console.error("Failed to accept lobby invite:",e),a.default.error(`Failed to join lobby: ${(0,n.getErrorMessage)(e)}`)}},[u,R,E,U]),N=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/request-join",{relationshipId:e},void 0,u()??void 0);"success"===t.status&&a.default.success("Request sent")}catch(e){console.error("Failed to request join lobby:",e),a.default.error(e?.response?.data?.message||"Failed to send request")}},[u,R]),q=(0,r.useCallback)(async e=>{try{(await R("/lobby/accept-request",{requesterUserId:e},void 0,u()??void 0)).status}catch(e){console.error("Failed to accept lobby request:",e),a.default.error(`Failed to accept request: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),O=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/promote-request",{relationshipId:e},void 0,u()??void 0);"success"===t.status&&a.default.success("Request promoted to owner")}catch(e){console.error("Failed to promote lobby request:",e),a.default.error(`Failed to promote request: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),H=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/decline-request",{requesterUserId:e},void 0,u()??void 0);"success"===t.status&&a.default.success("Request declined")}catch(e){console.error("Failed to decline lobby request:",e),a.default.error(`Failed to decline request: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),K=(0,r.useCallback)(async e=>{try{(await R("/lobby/transfer-ownership",{newOwnerUserId:e},void 0,u()??void 0)).status}catch(e){console.error("Failed to transfer ownership:",e),a.default.error(`Failed to transfer ownership: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),j=(0,r.useCallback)(async e=>{try{(await R("/lobby/kick",{targetUserId:e},void 0,u()??void 0)).status}catch(e){console.error("Failed to kick user:",e),a.default.error(`Failed to kick user: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),X=(0,r.useCallback)(async e=>{try{let t=await R("/lobby/send-token-pnl",{tokenPnl:e},void 0,u()??void 0);"success"===t.status&&a.default.success("Token PnL sent")}catch(e){console.error("Failed to send token PnL:",e),a.default.error(`Failed to send token PnL: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),J=(0,r.useCallback)(async()=>{try{await R("/lobby/reset-pnl",{},void 0,u()??void 0)}catch(e){console.error("Failed to reset PnL:",e),a.default.error(`Failed to reset PnL: ${(0,n.getErrorMessage)(e)}`)}},[u,R]),V=(0,r.useCallback)(async({chain:e,pairAddress:t,priceNative:s,mc:r})=>{try{await R("/lobby/create-alert",{chain:e,pairAddress:t,priceNative:s,mc:r},void 0,u()??void 0)}catch(e){throw console.error("Failed to create alert:",e),a.default.error(`Failed to create alert: ${(0,n.getErrorMessage)(e)}`),e}},[u,R]);return(0,r.useMemo)(()=>({initializeLobby:T,updateLobby:D,leaveLobby:_,inviteToLobby:z,acceptLobbyInvite:W,requestJoinLobby:N,acceptLobbyRequest:q,promoteLobbyRequest:O,declineLobbyRequest:H,transferOwnership:K,kickFromLobby:j,sendTokenPnl:X,resetPnl:J,createAlert:V}),[T,D,_,z,W,N,q,O,H,K,j,X,J,V])}],391735)},287052,e=>{"use strict";var t=e.i(672464),s=e.i(750214),r=e.i(271645),i=e.i(716689),o=e.i(569692),a=e.i(392335);e.s(["useRedirectToProfile",0,()=>{let e=(0,t.useSetAtom)(o.friendProfileDataAtom),n=(0,t.useSetAtom)(i.socialProfileOpenAtom),l=(0,s.useAtomCallback)((0,r.useCallback)((t,s,r)=>{let i=t(a.lobbyUserMapAtom),l=t(o.friendListAtom),d=i.get(r);if(!d)return void console.warn(`User ${r} not found in lobby`);let c=l.get(d.userProfile.username);e({userProfile:d.userProfile,relationshipId:c?.relationshipId??null,currentPage:d.currentPage,currentSubpage:d.currentSubpage,lastUpdatedTimestamp:d.lastUpdatedTimestamp,currentChain:d.currentChain,presence:d.presence,friendSinceTimestamp:c?.friendSinceTimestamp,lobbyInfo:c?.lobbyInfo}),n(!0)},[e]));return(0,r.useCallback)(e=>t=>{t.stopPropagation(),l(e)},[l])}])},923850,e=>{"use strict";function t(e){return{createdAt:e.created_at,type:e.type,totalNative:e.total_sol,totalUsd:e.total_usd,tokenAmount:e.token_amount,signature:e.signature,fees:e.f??0,makerAddress:e.maker_address,priceUsd:e.price_usd,priceNative:e.price_sol}}function s(e,t){return{createdAt:e.created_at,type:e.type,totalNative:e.total_bnb,totalUsd:e.total_usd,tokenAmount:Number(e.token_amount)/10**t,signature:e.signature,fees:e.f??0,makerAddress:e.maker_address,priceUsd:e.price_usd,priceNative:e.price_bnb}}function r(e){try{if(1===e[0])return e[5];return e[2]}catch(e){return console.error("Error getting transaction signature",e),""}}e.s(["getTransactionSignature",()=>r,"normalizeTransactionBnb",()=>s,"normalizeTransactionSol",()=>t])},379145,e=>{"use strict";let t=(0,e.i(271645).createContext)({});e.s(["LayoutGroupContext",()=>t])},747734,e=>{"use strict";var t=e.i(271645);function s(e){let s=(0,t.useRef)(null);return null===s.current&&(s.current=e()),s.current}e.s(["useConstant",()=>s])},794804,e=>{"use strict";let t=(0,e.i(271645).createContext)(null);e.s(["PresenceContext",()=>t])},709344,e=>{"use strict";let t=(0,e.i(271645).createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});e.s(["MotionConfigContext",()=>t])},292296,e=>{"use strict";var t=e.i(271645),s=e.i(794804);function r(e=!0){let i=(0,t.useContext)(s.PresenceContext);if(null===i)return[!0,null];let{isPresent:o,onExitComplete:a,register:n}=i,l=(0,t.useId)();(0,t.useEffect)(()=>{e&&n(l)},[e]);let d=(0,t.useCallback)(()=>e&&a&&a(l),[l,a,e]);return!o&&a?[!1,d]:[!0]}e.s(["usePresence",()=>r])},190160,836359,e=>{"use strict";var t=e.i(271645);let s="u">typeof window;e.s(["isBrowser",()=>s],836359);let r=s?t.useLayoutEffect:t.useEffect;e.s(["useIsomorphicLayoutEffect",()=>r],190160)},289768,e=>{"use strict";e.i(247167);var t=e.i(843476),s=e.i(271645),r=e.i(379145),i=e.i(747734),o=e.i(794804),a=s,n=e.i(709344);class l extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d({children:e,isPresent:s}){let r=(0,a.useId)(),i=(0,a.useRef)(null),o=(0,a.useRef)({width:0,height:0,top:0,left:0}),{nonce:d}=(0,a.useContext)(n.MotionConfigContext);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:n}=o.current;if(s||!i.current||!e||!t)return;i.current.dataset.motionPopId=r;let l=document.createElement("style");return d&&(l.nonce=d),document.head.appendChild(l),l.sheet&&l.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            top: ${a}px !important;
            left: ${n}px !important;
          }
        `),()=>{document.head.removeChild(l)}},[s]),(0,t.jsx)(l,{isPresent:s,childRef:i,sizeRef:o,children:a.cloneElement(e,{ref:i})})}let c=({children:e,initial:r,isPresent:a,onExitComplete:n,custom:l,presenceAffectsLayout:c,mode:u})=>{let f=(0,i.useConstant)(h),p=(0,s.useId)(),y=(0,s.useCallback)(e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;n&&n()},[f,n]),g=(0,s.useMemo)(()=>({id:p,initial:r,isPresent:a,custom:l,onExitComplete:y,register:e=>(f.set(e,!1),()=>f.delete(e))}),c?[Math.random(),y]:[a,y]);return(0,s.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[a]),s.useEffect(()=>{a||f.size||!n||n()},[a]),"popLayout"===u&&(e=(0,t.jsx)(d,{isPresent:a,children:e})),(0,t.jsx)(o.PresenceContext.Provider,{value:g,children:e})};function h(){return new Map}var u=e.i(292296);let f=e=>e.key||"";function p(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}var y=e.i(190160);let g=({children:e,custom:o,initial:a=!0,onExitComplete:n,presenceAffectsLayout:l=!0,mode:d="sync",propagate:h=!1})=>{let[g,m]=(0,u.usePresence)(h),b=(0,s.useMemo)(()=>p(e),[e]),A=h&&!g?[]:b.map(f),x=(0,s.useRef)(!0),w=(0,s.useRef)(b),k=(0,i.useConstant)(()=>new Map),[v,S]=(0,s.useState)(b),[I,C]=(0,s.useState)(b);(0,y.useIsomorphicLayoutEffect)(()=>{x.current=!1,w.current=b;for(let e=0;e<I.length;e++){let t=f(I[e]);A.includes(t)?k.delete(t):!0!==k.get(t)&&k.set(t,!1)}},[I,A.length,A.join("-")]);let L=[];if(b!==v){let e=[...b];for(let t=0;t<I.length;t++){let s=I[t],r=f(s);A.includes(r)||(e.splice(t,0,s),L.push(s))}"wait"===d&&L.length&&(e=L),C(p(e)),S(b);return}let{forceRender:M}=(0,s.useContext)(r.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:I.map(e=>{let s=f(e),r=(!h||!!g)&&(b===I||A.includes(s));return(0,t.jsx)(c,{isPresent:r,initial:(!x.current||!!a)&&void 0,custom:r?void 0:o,presenceAffectsLayout:l,mode:d,onExitComplete:r?void 0:()=>{if(!k.has(s))return;k.set(s,!0);let e=!0;k.forEach(t=>{t||(e=!1)}),e&&(null==M||M(),C(w.current),h&&(null==m||m()),n&&n())},children:e},s)})})};e.s(["AnimatePresence",()=>g],289768)},626335,e=>{"use strict";function t(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}var s=e.i(965389),r=e.i(658419),i=e.i(518201),o=e.i(210274),a=e.i(70026);let n="array",l="map_key",d="map_value",c=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new a.DecodeError("The type of key must be string or number but "+typeof e)};class h{stack=[];stackHeadPosition=-1;get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){let t=this.getUninitializedStateFromPool();t.type=n,t.position=0,t.size=e,t.array=Array(e)}pushMapState(e){let t=this.getUninitializedStateFromPool();t.type=l,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){return this.stackHeadPosition++,this.stackHeadPosition===this.stack.length&&this.stack.push({type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null}),this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw Error("Invalid stack state. Released state is not on top of the stack.");e.type===n&&(e.size=0,e.array=void 0,e.position=0,e.type=void 0),(e.type===l||e.type===d)&&(e.size=0,e.map=void 0,e.readCount=0,e.type=void 0),this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}let u=new DataView(new ArrayBuffer(0)),f=new Uint8Array(u.buffer);try{u.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}let p=RangeError("Insufficient data"),y=new class{hit=0;miss=0;caches;maxKeyLength;maxLengthPerKey;constructor(e=16,t=16){this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,s){let r=this.caches[s-1];e:for(let i of r){let r=i.bytes;for(let i=0;i<s;i++)if(r[i]!==e[t+i])continue e;return i.str}return null}store(e,t){let s=this.caches[e.length-1],r={bytes:e,str:t};s.length>=this.maxLengthPerKey?s[Math.random()*s.length|0]=r:s.push(r)}decode(e,t,s){let r=this.find(e,t,s);if(null!=r)return this.hit++,r;this.miss++;let o=(0,i.utf8DecodeJs)(e,t,s),a=Uint8Array.prototype.slice.call(e,t,t+s);return this.store(a,o),o}};class g{extensionCodec;context;useBigInt64;rawStrings;maxStrLength;maxBinLength;maxArrayLength;maxMapLength;maxExtLength;keyDecoder;mapKeyConverter;totalPos=0;pos=0;view=u;bytes=f;headByte=-1;stack=new h;entered=!1;constructor(e){this.extensionCodec=e?.extensionCodec??s.ExtensionCodec.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??r.UINT32_MAX,this.maxBinLength=e?.maxBinLength??r.UINT32_MAX,this.maxArrayLength=e?.maxArrayLength??r.UINT32_MAX,this.maxMapLength=e?.maxMapLength??r.UINT32_MAX,this.maxExtLength=e?.maxExtLength??r.UINT32_MAX,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:y,this.mapKeyConverter=e?.mapKeyConverter??c}clone(){return new g({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){let t=(0,o.ensureUint8Array)(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){let t=this.bytes.subarray(this.pos),s=(0,o.ensureUint8Array)(e),r=new Uint8Array(t.length+s.length);r.set(t),r.set(s,t.length),this.setBuffer(r)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){let{view:t,pos:s}=this;return RangeError(`Extra ${t.byteLength-s} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);let t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){let t=this.clone();yield*t.decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{let s;this.entered=!0;let r=!1;for await(let t of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(t);try{s=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return s}let{headByte:i,pos:o,totalPos:a}=this;throw RangeError(`Insufficient data in parsing ${t(i)} at ${a} (${o} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async *decodeMultiAsync(e,t){if(this.entered){let s=this.clone();yield*s.decodeMultiAsync(e,t);return}try{this.entered=!0;let s=t,r=-1;for await(let i of e){if(t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),s&&(r=this.readArraySize(),s=!1,this.complete());try{for(;yield this.doDecodeSync(),0!=--r;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){t:for(;;){let e,s=this.readHeadByte();if(s>=224)e=s-256;else if(s<192)if(s<128)e=s;else if(s<144){let t=s-128;if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(s<160){let t=s-144;if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else{let t=s-160;e=this.decodeString(t,0)}else if(192===s)e=null;else if(194===s)e=!1;else if(195===s)e=!0;else if(202===s)e=this.readF32();else if(203===s)e=this.readF64();else if(204===s)e=this.readU8();else if(205===s)e=this.readU16();else if(206===s)e=this.readU32();else if(207===s)e=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===s)e=this.readI8();else if(209===s)e=this.readI16();else if(210===s)e=this.readI32();else if(211===s)e=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===s){let t=this.lookU8();e=this.decodeString(t,1)}else if(218===s){let t=this.lookU16();e=this.decodeString(t,2)}else if(219===s){let t=this.lookU32();e=this.decodeString(t,4)}else if(220===s){let t=this.readU16();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(221===s){let t=this.readU32();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(222===s){let t=this.readU16();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(223===s){let t=this.readU32();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(196===s){let t=this.lookU8();e=this.decodeBinary(t,1)}else if(197===s){let t=this.lookU16();e=this.decodeBinary(t,2)}else if(198===s){let t=this.lookU32();e=this.decodeBinary(t,4)}else if(212===s)e=this.decodeExtension(1,0);else if(213===s)e=this.decodeExtension(2,0);else if(214===s)e=this.decodeExtension(4,0);else if(215===s)e=this.decodeExtension(8,0);else if(216===s)e=this.decodeExtension(16,0);else if(199===s){let t=this.lookU8();e=this.decodeExtension(t,1)}else if(200===s){let t=this.lookU16();e=this.decodeExtension(t,2)}else if(201===s){let t=this.lookU32();e=this.decodeExtension(t,4)}else throw new a.DecodeError(`Unrecognized type byte: ${t(s)}`);this.complete();let r=this.stack;for(;r.length>0;){let t=r.top();if(t.type===n)if(t.array[t.position]=e,t.position++,t.position===t.size)e=t.array,r.release(t);else continue t;else if(t.type===l){if("__proto__"===e)throw new a.DecodeError("The key __proto__ is not allowed");t.key=this.mapKeyConverter(e),t.type=d;continue t}else if(t.map[t.key]=e,t.readCount++,t.readCount===t.size)e=t.map,r.release(t);else{t.key=null,t.type=l;continue t}}return e}}readHeadByte(){return -1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){let e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new a.DecodeError(`Unrecognized array type byte: ${t(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new a.DecodeError(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new a.DecodeError(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){let s;if(e>this.maxStrLength)throw new a.DecodeError(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw p;let r=this.pos+t;return s=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):(0,i.utf8Decode)(this.bytes,r,e),this.pos+=t+e,s}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===l}decodeBinary(e,t){if(e>this.maxBinLength)throw new a.DecodeError(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw p;let s=this.pos+t,r=this.bytes.subarray(s,s+e);return this.pos+=t+e,r}decodeExtension(e,t){if(e>this.maxExtLength)throw new a.DecodeError(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);let s=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,s,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){let e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){let e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){let e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){let e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){let e=(0,r.getUint64)(this.view,this.pos);return this.pos+=8,e}readI64(){let e=(0,r.getInt64)(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){let e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){let e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){let e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){let e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function m(e,t){return new g(t).decode(e)}e.s(["decode",()=>m],626335)}]);

//# debugId=99085849-41b0-5fe1-5fbc-6bb9513b4701